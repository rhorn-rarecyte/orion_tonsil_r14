<!DOCTYPE html>
<html lang="en-US" class="h-100">

<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
  <link rel="stylesheet" href="/assets/css/style.css?v=4a086dcc28aad8d768d14f634aa7c729702ac4f6"> <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>CyCIF | A Simple Approach to Highly Multiplexed Cell and Tissue Imaging</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="CyCIF" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A Simple Approach to Highly Multiplexed Cell and Tissue Imaging" />
<meta property="og:description" content="A Simple Approach to Highly Multiplexed Cell and Tissue Imaging" />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="CyCIF" />
<script type="application/ld+json">
{"@type":"WebSite","url":"http://localhost:4000/","name":"CyCIF","headline":"CyCIF","description":"A Simple Approach to Highly Multiplexed Cell and Tissue Imaging","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/css/osd-exhibit.css">

</head>

<body class="d-flex flex-column h-100">
    <!-- style="position:relative" -->

  
  
  
  
  
  

    <div id="content" class="position-fixed w-100" style="top: 0;left: 0;">
        <div>
            <div id="openseadragon1" class="openseadragon"></div>
            <div id="legend" class="position-absolute"
                 style="pointer-events: none; top: 1rem; right: 8px">
                <div>
                    <div class="btn-group-vertical bg-trans p-2"
                         style="display:inline-block; vertical-align:top;">
                        <a id="toggle-legend" class="p-1" href="javascript;;">
                            <i class="open-legend fas fa-chevron-left" style="font-size: 25px;"></i>
                            <i class="close-legend fas fa-chevron-right" style="font-size: 25px;"></i>
                        </a>
                        <ul id="channel-legend" class="list-unstyled m-0"></ul>
                        <div class="p-1 only-3d">
                          Depth:
                        </div>
                        <div style="text-align: right;">
                          <span id="depth-legend"> </span>
                        </div>
                    </div> 
                    <div id="channel-groups-legend" class="nav flex-column nav-pills p-2 bg-trans"
                         style="display:inline-block; vertical-align:top;
                         pointer-events: all; overflow-y: scroll; max-height: 80vh;">
                    </div>
                    <div id="z-slider-legend" class="bg-trans"
                         style="pointer-events: all; display:inline-block; vertical-align:top;">
                        <input id="z-slider" type="range"/>
                    </div>
                </div>
            </div>
            <div id="sidebar-menu" class="container position-absolute">
                <div class="row">
                    <div class="col-11 bg-trans waypoint-content p-3" style="max-height: 80vh; overflow-y: scroll">
                        <div class="row">
                            <div class="col-10">
                                <h3 id="imageName" class="m-0"></h3>
                            </div>
                            <div class="col-2">
                                <a class="btn text-light d-none" id="home-button"
                                    href="/">
                                    <i class="fas fa-home"></i>
                                </a>
                                <a class="btn text-light d-none" id="toc-button">
                                    <i class="fas fa-list-ul"></i>
                                </a>
                            </div>
                        </div>
                        <hr class="my-1">
                        <div id="waypointControls" class="row align-items-center my-1">
                            <div class="col-2 text-center" id="leftArrow">
                                <i class="fas fa-arrow-left" style="font-size: 25px"></i>
                            </div>
                            <div class="col-8">
                              
                            </div>
                            <div class="col-2 text-center" id="rightArrow">
                                <i class="fas fa-arrow-right" style="font-size: 25px;"></i>
                            </div>
                        </div>
                        <!-- <hr> -->
                        <div class="row">
                            <div id="waypointName" class="col-10 h6 mt-0 mb-3">
                            </div>
                            <div id="waypointCount" class="col-2"></div>
                        </div>
                        <div id="viewer-waypoint">
                        </div>
                        <div>
                            <p id="channel-label" class="mb-1 font-weight-bold pt-2">Select a marker group:</p>
                            <select id="group-picker" class="editControls selectpicker" multiple>
                                
                                    <option>Tissue Architecture</option>
                                
                                    <option>Immune Checkpoint Biomarkers</option>
                                
                                    <option>T Cell Subsets</option>
                                
                                    <option>Cellular Proliferation</option>
                                
                                    <option>Myeloid and Stromal Cells</option>
                                
                            </select>
                            <div id="channel-groups" class="nav flex nav-pills"></div>
                            <p id="mask-label" class="mb-1 font-weight-bold pt-2">Add data layer:</p>
                            <select id="mask-picker" class="editControls selectpicker" multiple>
                                
                            </select>
                            <div id="mask-layers" class="nav flex nav-pills">
                            </div>
                        </div>
                        <div>
                            <div id="story-container"></div>
                        </div>
                    </div>
                    <div class="col-1 p-0">
                        <div class="btn-group-vertical bg-trans"> 
                            <a id="toggle-sidebar" class="btn" href="javascript;;">
                                <i class="close-sidebar fas fa-chevron-left" style="font-size: 25px;"></i>
                                <i class="open-sidebar fas fa-chevron-right" style="font-size: 25px;"></i>
                            </a>
                        </div> 
                        <div class="btn-group-vertical bg-trans">
                            <a class="btn text-light" id="zoom-out" href="#zoom-out">
                                <i class="fas fa-search-minus"></i>
                            </a>
                            <a class="btn text-light" id="zoom-in" href="#zoom-in">
                                <i class="fas fa-search-plus"></i>
                            </a>
                            <span id="arrow-switch" class="nav-item arrow-switch">
                            <a class="btn" href="javascript:;">
                                <span class=""><i class="fas fa-location-arrow"></i></span>
                            </a>
                            </span>
                            <span id="lasso-switch" class="nav-item lasso-switch">
                            <a class="btn" href="javascript:;">
                                <span class=""><i class="fas fa-bullseye"></i></span>
                            </a>
                            </span>
                            <span id="draw-switch" class="nav-item draw-switch">
                            <a class="btn" href="javascript:;">
                                <span class=""><i class="fas fa-crosshairs"></i></span>
                            </a>
                            </span>
                            <a class="btn" id='duplicate-view'>
                                <span class=""><i class="fas fa-clone"></i></span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div id="viewer-tool" class="position-absolute bg-trans" style="right:1.5%; top: 40vh;">
            </div>
        </div>
    </div>

    <div class="d-none">
        <input type="file" id="file-upload" class="d-none" />
        <ul>
            <li class="nav-item rounded-0" id="proto-story-index">
                <a class="nav-link list-group-item-action font-weight-bold"></a>
            </li>
        </ul>

        <div id="arrow-overlay" class="arrow-overlay">
          <div id="arrowhead-image">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="48"
   height="51.69223"
   viewBox="0 0 12.711991 13.676902"
   version="1.1"
   id="svg8"
   inkscape:version="0.92.2 5c3e80d, 2017-08-06"
   sodipodi:docname="arrowhead.svg">
  <defs
     id="defs2" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="2.8"
     inkscape:cx="215.21359"
     inkscape:cy="30.005484"
     inkscape:document-units="mm"
     inkscape:current-layer="layer1"
     showgrid="false"
     inkscape:window-width="1440"
     inkscape:window-height="855"
     inkscape:window-x="366"
     inkscape:window-y="127"
     inkscape:window-maximized="0"
     units="px"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0">
    <inkscape:grid
       type="xygrid"
       id="grid93"
       originx="-80.574495"
       originy="-156.63291" />
    <inkscape:grid
       type="xygrid"
       id="grid3784"
       originx="-80.574495"
       originy="-156.63291" />
  </sodipodi:namedview>
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-80.487169,-126.68424)">
    <path
       style="fill:#000000;stroke:#ffffff;stroke-width:0.65998453;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 90.862994,132.64086 1.759972,-5.27987 -11.439757,6.15985 11.439757,6.15987 -1.759972,-5.27988 c -0.185517,-0.55655 -0.185517,-1.20342 0,-1.75997 z"
       id="path91"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="scccss" />
  </g>
</svg>

          </div>
          <div id="arrow-image">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="122.79958"
   height="51.401581"
   viewBox="0 0 32.521399 13.600001"
   version="1.1"
   id="svg8"
   inkscape:version="0.92.2 5c3e80d, 2017-08-06"
   sodipodi:docname="arrow.svg">
  <defs
     id="defs2" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="3.959798"
     inkscape:cx="154.51108"
     inkscape:cy="29.572515"
     inkscape:document-units="mm"
     inkscape:current-layer="layer1"
     showgrid="false"
     inkscape:window-width="1440"
     inkscape:window-height="855"
     inkscape:window-x="0"
     inkscape:window-y="1"
     inkscape:window-maximized="1"
     units="px"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0">
    <inkscape:grid
       type="xygrid"
       id="grid93"
       originx="-80.574492"
       originy="-156.63309" />
    <inkscape:grid
       type="xygrid"
       id="grid3784"
       originx="-80.574492"
       originy="-156.63309" />
  </sodipodi:namedview>
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-80.487168,-126.76104)">
    <path
       style="fill:#000000;stroke:#ffffff;stroke-width:0.6562736;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 90.804653,132.6843 1.750076,-5.25019 -11.375434,6.12522 11.375434,6.12523 -1.750076,-5.25019 h 21.875777 v -1.75007 z"
       id="path91"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cccccccc" />
  </g>
</svg>

          </div>
          <div id="arrow-text">
            <div class="arrow-label p-3 bg-trans" style="max-width: 200px;">
            </div>
          </div>
        </div>

        <form class="form save_edits_form">
            <div class="input-group">
                <div style="width: 100%; margin-bottom: 5px">
                    <input class="form-control edit_name editable bg-dark text-white rounded-0 border-0" type="text">
                    </input>
                    <br>
                    <textarea class="form-control edit_text editable bg-dark text-white rounded-0 border-0" rows="9">
                    </textarea>
                    <br>
                    <div class="row">
                        <div id="edit_toggle_arrow" class="col-2 text-center">
                            <i class="fas fa-location-arrow"></i>
                        </div>
                        <div class="col-10">
                            <input class="form-control edit_arrow_text editable bg-dark text-white rounded-0 border-0" type="text">
                            </input>
                        </div>
                    </div>
                </div>
                <button class="btn btn-default edit_copy_button px-1  " data-placement="bottom">
                    <i class="fas fa-copy fa-lg"></i><br>
                    <span class="mt-2 d-block" style="font-size: 0.7rem">
                                    COPY
                    </span>
                </button>
            </div>
        </form>

        <div id="readme">
        </div>
    </div>


    <div id="password_modal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Minerva Password</h2>
                </div>
                <div class="modal-body">

                    <form class="form">
                        <div class="form-group">
                            <input type=password class="form-control" name="p">
                        </div>
                        <button type="submit" class="btn btn-primary">Enter</button>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <div id="edit_description_modal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content text-dark">
                <div class="modal-header">
                    <h2 class="modal-title m-0 h5">Region of Interest</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">

                    <form class="form">
                        <div class="form-group text-bold">
                            <label> Enter a description for the selected region. </label>
                            <textarea class="form-control" name="d" rows="4"></textarea>
                        </div>
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Make Shareable Link</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="welcome_modal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content text-dark">
                <div class="modal-header">
                    <h2 class="modal-title m-0 h5">Welcome</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    You're looking at an image layering
                    <span class="channel_count"></span>
                    CyCIF markers.
                    Use the <i class="fas fa-arrow-left"></i>
                    and <i class="fas fa-arrow-right"></i>
                    arrows to move between highlighted image regions.
                    Click <i class="fas fa-list-ul"></i>
                    to return here to an overview of the full image.
                    Use <i class="fas fa-search-minus"></i> to zoom out
                    and <i class="fas fa-search-plus"></i> to zoom in.
                    </br>
                    </br>
                    To share your own highlighted image regions,
                    click <i class="fas fa-location-arrow"></i> to
                    point an arrow at a small feature,
                    click <i class="fas fa-bullseye"></i> to select
                    a feature with a custom shape, and
                    click <i class="fas fa-crosshairs"></i> to share a
                    boundary around a rectangular region.
                    Click <i class="fas fa-clone"></i> to open a
                    new window with shared navigation.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <div id="copy_link_modal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content text-dark">
                <div class="modal-header">
                    <h2 class="modal-title m-0 h5">Region of Interest</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="form">
                        <div class="input-group">
                            <input type="text" class="form-control" id="copy_link" name="copy_content" placeholder="Some path">
                            <span class="input-group-btn">
                                <button class="btn btn-default modal_copy_button" type="submit" data-toggle="tooltip" data-placement="bottom">
                                    Copy
                                </button>
                            </span>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="all-overlays" class="d-none">
    </div>


    <script src="/node_modules/jquery/dist/jquery.min.js"></script>
<script src="/node_modules/popper.js/dist/umd/popper.min.js"></script>
<script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-41775478-2', 'auto');
    ga('send', 'pageview');
  </script> 
 
    <script defer src="https://use.fontawesome.com/releases/v5.2.0/js/all.js" integrity="sha384-4oV5EgaV02iISL2ban6c/RmotsABqE4yZxZLcYMAdG7FAPsyHYAPpywE9PJo+Khy" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/2.3.1/openseadragon.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <script src="https://api.html5media.info/1.2.2/html5media.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.551.0.min.js"></script>

    <script> 
       /* 
 * This software was developed at the National Institute of Standards and
 * Technology by employees of the Federal Government in the course of
 * their official duties. Pursuant to title 17 Section 105 of the United
 * States Code this software is not subject to copyright protection and is
 * in the public domain. This software is an experimental system. NIST assumes
 * no responsibility whatsoever for its use by other parties, and makes no
 * guarantees, expressed or implied, about its quality, reliability, or
 * any other characteristic. We would appreciate acknowledgement if the
 * software is used.
 */

/**
 *
 * @author Antoine Vandecreme <antoine.vandecreme@nist.gov>
 */
(function($) {

    if (!$.version || $.version.major < 2) {
        throw new Error('This version of OpenSeadragonScalebar requires ' +
                'OpenSeadragon version 2.0.0+');
    }

    $.Viewer.prototype.scalebar = function(options) {
        if (!this.scalebarInstance) {
            options = options || {};
            options.viewer = this;
            this.scalebarInstance = new $.Scalebar(options);
        } else {
            this.scalebarInstance.refresh(options);
        }
    };

    $.ScalebarType = {
        NONE: 0,
        MICROSCOPY: 1,
        MAP: 2
    };

    $.ScalebarLocation = {
        NONE: 0,
        TOP_LEFT: 1,
        TOP_RIGHT: 2,
        BOTTOM_RIGHT: 3,
        BOTTOM_LEFT: 4
    };

    /**
     * 
     * @class Scalebar
     * @param {Object} options
     * @param {OpenSeadragon.Viewer} options.viewer The viewer to attach this
     * Scalebar to.
     * @param {OpenSeadragon.ScalebarType} options.type The scale bar type.
     * Default: microscopy
     * @param {Integer} options.pixelsPerMeter The pixels per meter of the
     * zoomable image at the original image size. If null, the scale bar is not
     * displayed. default: null
     * @param {Integer} options.referenceItemIdx Specify the item from
     * viewer.world to which options.pixelsPerMeter is refering.
     * default: 0
     * @param (String} options.minWidth The minimal width of the scale bar as a
     * CSS string (ex: 100px, 1em, 1% etc...) default: 150px
     * @param {OpenSeadragon.ScalebarLocation} options.location The location
     * of the scale bar inside the viewer. default: bottom left
     * @param {Integer} options.xOffset Offset location of the scale bar along x.
     * default: 5
     * @param {Integer} options.yOffset Offset location of the scale bar along y.
     * default: 5
     * @param {Boolean} options.stayInsideImage When set to true, keep the 
     * scale bar inside the image when zooming out. default: true
     * @param {String} options.color The color of the scale bar using a color
     * name or the hexadecimal format (ex: black or #000000) default: black
     * @param {String} options.fontColor The font color. default: black
     * @param {String} options.backgroundColor The background color. default: none
     * @param {String} options.fontSize The font size. default: not set
     * @param {String} options.fontFamily The font-family. default: not set
     * @param {String} options.barThickness The thickness of the scale bar in px.
     * default: 2
     * @param {function} options.sizeAndTextRenderer A function which will be
     * called to determine the size of the scale bar and it's text content.
     * The function must have 2 parameters: the PPM at the current zoom level
     * and the minimum size of the scale bar. It must return an object containing
     * 2 attributes: size and text containing the size of the scale bar and the text.
     * default: $.ScalebarSizeAndTextRenderer.METRIC_LENGTH
     */
    $.Scalebar = function(options) {
        options = options || {};
        if (!options.viewer) {
            throw new Error("A viewer must be specified.");
        }
        this.viewer = options.viewer;

        this.divElt = document.createElement("div");
        this.viewer.container.appendChild(this.divElt);
        this.divElt.style.position = "relative";
        this.divElt.style.margin = "0";
        this.divElt.style.pointerEvents = "none";

        this.setMinWidth(options.minWidth || "150px");

        this.setDrawScalebarFunction(options.type || $.ScalebarType.MICROSCOPY);
        this.color = options.color || "black";
        this.fontColor = options.fontColor || "black";
        this.backgroundColor = options.backgroundColor || "none";
        this.fontSize = options.fontSize || "";
        this.fontFamily = options.fontFamily || "";
        this.barThickness = options.barThickness || 2;
        this.pixelsPerMeter = options.pixelsPerMeter || null;
        this.referenceItemIdx = options.referenceItemIdx || 0;
        this.location = options.location || $.ScalebarLocation.BOTTOM_LEFT;
        this.xOffset = options.xOffset || 5;
        this.yOffset = options.yOffset || 5;
        this.stayInsideImage = isDefined(options.stayInsideImage) ?
                options.stayInsideImage : true;
        this.sizeAndTextRenderer = options.sizeAndTextRenderer ||
                $.ScalebarSizeAndTextRenderer.METRIC_LENGTH;

        var self = this;
        this.viewer.addHandler("open", function() {
            self.refresh();
        });
        this.viewer.addHandler("animation", function() {
            self.refresh();
        });
        this.viewer.addHandler("resize", function() {
            self.refresh();
        });
    };

    $.Scalebar.prototype = {
        updateOptions: function(options) {
            if (!options) {
                return;
            }
            if (isDefined(options.type)) {
                this.setDrawScalebarFunction(options.type);
            }
            if (isDefined(options.minWidth)) {
                this.setMinWidth(options.minWidth);
            }
            if (isDefined(options.color)) {
                this.color = options.color;
            }
            if (isDefined(options.fontColor)) {
                this.fontColor = options.fontColor;
            }
            if (isDefined(options.backgroundColor)) {
                this.backgroundColor = options.backgroundColor;
            }
            if (isDefined(options.fontSize)) {
                this.fontSize = options.fontSize;
            }
            if (isDefined(options.fontFamily)) {
                this.fontFamily = options.fontFamily;
            }
            if (isDefined(options.barThickness)) {
                this.barThickness = options.barThickness;
            }
            if (isDefined(options.pixelsPerMeter)) {
                this.pixelsPerMeter = options.pixelsPerMeter;
            }
            if (isDefined(options.referenceItemIdx)) {
                this.referenceItemIdx = options.referenceItemIdx;
            }
            if (isDefined(options.location)) {
                this.location = options.location;
            }
            if (isDefined(options.xOffset)) {
                this.xOffset = options.xOffset;
            }
            if (isDefined(options.yOffset)) {
                this.yOffset = options.yOffset;
            }
            if (isDefined(options.stayInsideImage)) {
                this.stayInsideImage = options.stayInsideImage;
            }
            if (isDefined(options.sizeAndTextRenderer)) {
                this.sizeAndTextRenderer = options.sizeAndTextRenderer;
            }
        },
        setDrawScalebarFunction: function(type) {
            if (!type) {
                this.drawScalebar = null;
            }
            else if (type === $.ScalebarType.MAP) {
                this.drawScalebar = this.drawMapScalebar;
            } else {
                this.drawScalebar = this.drawMicroscopyScalebar;
            }
        },
        setMinWidth: function(minWidth) {
            this.divElt.style.width = minWidth;
            // Make sure to display the element before getting is width
            this.divElt.style.display = "";
            this.minWidth = this.divElt.offsetWidth;
        },
        /**
         * Refresh the scalebar with the options submitted.
         * @param {Object} options
         * @param {OpenSeadragon.ScalebarType} options.type The scale bar type.
         * Default: microscopy
         * @param {Integer} options.pixelsPerMeter The pixels per meter of the
         * zoomable image at the original image size. If null, the scale bar is not
         * displayed. default: null
         * @param {Integer} options.referenceItemIdx Specify the item from
         * viewer.world to which options.pixelsPerMeter is refering.
         * default: 0
         * @param (String} options.minWidth The minimal width of the scale bar as a
         * CSS string (ex: 100px, 1em, 1% etc...) default: 150px
         * @param {OpenSeadragon.ScalebarLocation} options.location The location
         * of the scale bar inside the viewer. default: bottom left
         * @param {Integer} options.xOffset Offset location of the scale bar along x.
         * default: 5
         * @param {Integer} options.yOffset Offset location of the scale bar along y.
         * default: 5
         * @param {Boolean} options.stayInsideImage When set to true, keep the 
         * scale bar inside the image when zooming out. default: true
         * @param {String} options.color The color of the scale bar using a color
         * name or the hexadecimal format (ex: black or #000000) default: black
         * @param {String} options.fontColor The font color. default: black
         * @param {String} options.backgroundColor The background color. default: none
         * @param {String} options.fontSize The font size. default: not set
         * @param {String} options.barThickness The thickness of the scale bar in px.
         * default: 2
         * @param {function} options.sizeAndTextRenderer A function which will be
         * called to determine the size of the scale bar and it's text content.
         * The function must have 2 parameters: the PPM at the current zoom level
         * and the minimum size of the scale bar. It must return an object containing
         * 2 attributes: size and text containing the size of the scale bar and the text.
         * default: $.ScalebarSizeAndTextRenderer.METRIC_LENGTH
         */
        refresh: function(options) {
            this.updateOptions(options);

            if (!this.viewer.isOpen() ||
                    !this.drawScalebar ||
                    !this.pixelsPerMeter ||
                    !this.location) {
                this.divElt.style.display = "none";
                return;
            }
            this.divElt.style.display = "";

            var viewport = this.viewer.viewport;
            var tiledImage = this.viewer.world.getItemAt(this.referenceItemIdx);
            var zoom = tiledImageViewportToImageZoom(tiledImage,
                    viewport.getZoom(true));
            var currentPPM = zoom * this.pixelsPerMeter;
            var props = this.sizeAndTextRenderer(currentPPM, this.minWidth);

            this.drawScalebar(props.size, props.text);
            var location = this.getScalebarLocation();
            this.divElt.style.left = location.x + "px";
            this.divElt.style.top = location.y + "px";
        },
        drawMicroscopyScalebar: function(size, text) {
            this.divElt.style.fontSize = this.fontSize;
            this.divElt.style.fontFamily = this.fontFamily;
            this.divElt.style.textAlign = "center";
            this.divElt.style.color = this.fontColor;
            this.divElt.style.border = "none";
            this.divElt.style.borderBottom = this.barThickness + "px solid " + this.color;
            this.divElt.style.backgroundColor = this.backgroundColor;
            this.divElt.innerHTML = text;
            this.divElt.style.width = size + "px";
        },
        drawMapScalebar: function(size, text) {
            this.divElt.style.fontSize = this.fontSize;
            this.divElt.style.fontFamily = this.fontFamily;
            this.divElt.style.textAlign = "center";
            this.divElt.style.color = this.fontColor;
            this.divElt.style.border = this.barThickness + "px solid " + this.color;
            this.divElt.style.borderTop = "none";
            this.divElt.style.backgroundColor = this.backgroundColor;
            this.divElt.innerHTML = text;
            this.divElt.style.width = size + "px";
        },
        /**
         * Compute the location of the scale bar.
         * @returns {OpenSeadragon.Point}
         */
        getScalebarLocation: function() {
            if (this.location === $.ScalebarLocation.TOP_LEFT) {
                var x = 0;
                var y = 0;
                if (this.stayInsideImage) {
                    var pixel = this.viewer.viewport.pixelFromPoint(
                            new $.Point(0, 0), true);
                    if (!this.viewer.wrapHorizontal) {
                        x = Math.max(pixel.x, 0);
                    }
                    if (!this.viewer.wrapVertical) {
                        y = Math.max(pixel.y, 0);
                    }
                }
                return new $.Point(x + this.xOffset, y + this.yOffset);
            }
            if (this.location === $.ScalebarLocation.TOP_RIGHT) {
                var barWidth = this.divElt.offsetWidth;
                var container = this.viewer.container;
                var x = container.offsetWidth - barWidth;
                var y = 0;
                if (this.stayInsideImage) {
                    var pixel = this.viewer.viewport.pixelFromPoint(
                            new $.Point(1, 0), true);
                    if (!this.viewer.wrapHorizontal) {
                        x = Math.min(x, pixel.x - barWidth);
                    }
                    if (!this.viewer.wrapVertical) {
                        y = Math.max(y, pixel.y);
                    }
                }
                return new $.Point(x - this.xOffset, y + this.yOffset);
            }
            if (this.location === $.ScalebarLocation.BOTTOM_RIGHT) {
                var barWidth = this.divElt.offsetWidth;
                var barHeight = this.divElt.offsetHeight;
                var container = this.viewer.container;
                var x = container.offsetWidth - barWidth;
                var y = container.offsetHeight - barHeight;
                if (this.stayInsideImage) {
                    var pixel = this.viewer.viewport.pixelFromPoint(
                            new $.Point(1, 1 / this.viewer.source.aspectRatio),
                            true);
                    if (!this.viewer.wrapHorizontal) {
                        x = Math.min(x, pixel.x - barWidth);
                    }
                    if (!this.viewer.wrapVertical) {
                        y = Math.min(y, pixel.y - barHeight);
                    }
                }
                return new $.Point(x - this.xOffset, y - this.yOffset);
            }
            if (this.location === $.ScalebarLocation.BOTTOM_LEFT) {
                var barHeight = this.divElt.offsetHeight;
                var container = this.viewer.container;
                var x = 0;
                var y = container.offsetHeight - barHeight;
                if (this.stayInsideImage) {
                    var pixel = this.viewer.viewport.pixelFromPoint(
                            new $.Point(0, 1 / this.viewer.source.aspectRatio),
                            true);
                    if (!this.viewer.wrapHorizontal) {
                        x = Math.max(x, pixel.x);
                    }
                    if (!this.viewer.wrapVertical) {
                        y = Math.min(y, pixel.y - barHeight);
                    }
                }
                return new $.Point(x + this.xOffset, y - this.yOffset);
            }
        },
        /**
         * Get the rendered scalebar in a canvas.
         * @returns {Element} A canvas containing the scalebar representation
         */
        getAsCanvas: function() {
            var canvas = document.createElement("canvas");
            canvas.width = this.divElt.offsetWidth;
            canvas.height = this.divElt.offsetHeight;
            var context = canvas.getContext("2d");
            context.fillStyle = this.backgroundColor;
            context.fillRect(0, 0, canvas.width, canvas.height);
            context.fillStyle = this.color;
            context.fillRect(0, canvas.height - this.barThickness,
                    canvas.width, canvas.height);
            if (this.drawScalebar === this.drawMapScalebar) {
                context.fillRect(0, 0, this.barThickness, canvas.height);
                context.fillRect(canvas.width - this.barThickness, 0,
                        this.barThickness, canvas.height);
            }
            context.font = window.getComputedStyle(this.divElt).font;
            context.textAlign = "center";
            context.textBaseline = "middle";
            context.fillStyle = this.fontColor;
            var hCenter = canvas.width / 2;
            var vCenter = canvas.height / 2;
            context.fillText(this.divElt.textContent, hCenter, vCenter);
            return canvas;
        },
        /**
         * Get a copy of the current OpenSeadragon canvas with the scalebar.
         * @returns {Element} A canvas containing a copy of the current OpenSeadragon canvas with the scalebar
         */
        getImageWithScalebarAsCanvas: function() {
            var imgCanvas = this.viewer.drawer.canvas;
            var newCanvas = document.createElement("canvas");
            newCanvas.width = imgCanvas.width;
            newCanvas.height = imgCanvas.height;
            var newCtx = newCanvas.getContext("2d");
            newCtx.drawImage(imgCanvas, 0, 0);
            var scalebarCanvas = this.getAsCanvas();
            var location = this.getScalebarLocation();
            newCtx.drawImage(scalebarCanvas, location.x, location.y);
            return newCanvas;
        }
    };

    $.ScalebarSizeAndTextRenderer = {
        /**
         * Metric length. From nano meters to kilometers.
         */
        METRIC_LENGTH: function(ppm, minSize) {
            return getScalebarSizeAndTextForMetric(ppm, minSize, "m");
        },
        /**
         * Imperial length. Choosing the best unit from thou, inch, foot and mile.
         */
        IMPERIAL_LENGTH: function(ppm, minSize) {
            var maxSize = minSize * 2;
            var ppi = ppm * 0.0254;
            if (maxSize < ppi * 12) {
                if (maxSize < ppi) {
                    var ppt = ppi / 1000;
                    return getScalebarSizeAndText(ppt, minSize, "th");
                }
                return getScalebarSizeAndText(ppi, minSize, "in");
            }
            var ppf = ppi * 12;
            if (maxSize < ppf * 2000) {
                return getScalebarSizeAndText(ppf, minSize, "ft");
            }
            var ppmi = ppf * 5280;
            return getScalebarSizeAndText(ppmi, minSize, "mi");
        },
        /**
         * Astronomy units. Choosing the best unit from arcsec, arcminute, and degree
         */
        ASTRONOMY: function(ppa, minSize) {
	    var maxSize = minSize * 2;
            if (maxSize < ppa * 60) {
                return getScalebarSizeAndText(ppa, minSize, "\"", false, '');
            }
            var ppminutes = ppa * 60;
            if (maxSize < ppminutes * 60) {
                return getScalebarSizeAndText(ppminutes, minSize, "\'", false, '');
            }
            var ppd = ppminutes * 60;
            return getScalebarSizeAndText(ppd, minSize, "&#176", false, '');
	},
        /**
         * Standard time. Choosing the best unit from second (and metric divisions),
         * minute, hour, day and year.
         */
        STANDARD_TIME: function(pps, minSize) {
            var maxSize = minSize * 2;
            if (maxSize < pps * 60) {
                return getScalebarSizeAndTextForMetric(pps, minSize, "s", false);
            }
            var ppminutes = pps * 60;
            if (maxSize < ppminutes * 60) {
                return getScalebarSizeAndText(ppminutes, minSize, "minute", true);
            }
            var pph = ppminutes * 60;
            if (maxSize < pph * 24) {
                return getScalebarSizeAndText(pph, minSize, "hour", true);
            }
            var ppd = pph * 24;
            if (maxSize < ppd * 365.25) {
                return getScalebarSizeAndText(ppd, minSize, "day", true);
            }
            var ppy = ppd * 365.25;
            return getScalebarSizeAndText(ppy, minSize, "year", true);
        },
        /**
         * Generic metric unit. One can use this function to create a new metric
         * scale. For example, here is an implementation of energy levels:
         * function(ppeV, minSize) {
         *   return OpenSeadragon.ScalebarSizeAndTextRenderer.METRIC_GENERIC(
         *           ppeV, minSize, "eV");
         * }
         */
        METRIC_GENERIC: getScalebarSizeAndTextForMetric
    };

    // Missing TiledImage.viewportToImageZoom function in OSD 2.0.0
    function tiledImageViewportToImageZoom(tiledImage, viewportZoom) {
        var ratio = tiledImage._scaleSpring.current.value *
                tiledImage.viewport._containerInnerSize.x /
                tiledImage.source.dimensions.x;
        return ratio * viewportZoom;
    }

    function getScalebarSizeAndText(ppm, minSize, unitSuffix, handlePlural, spacer) {
	spacer = spacer === undefined ? ' ' : spacer;
        var value = normalize(ppm, minSize);
        var factor = roundSignificand(value / ppm * minSize, 3);
        var size = value * minSize;
        var plural = handlePlural && factor > 1 ? "s" : "";
        return {
            size: size,
            text: factor + spacer + unitSuffix + plural
        };
    }

    function getScalebarSizeAndTextForMetric(ppm, minSize, unitSuffix) {
        var value = normalize(ppm, minSize);
        var factor = roundSignificand(value / ppm * minSize, 3);
        var size = value * minSize;
        var valueWithUnit = getWithUnit(factor, unitSuffix);
        return {
            size: size,
            text: valueWithUnit
        };
    }

    function normalize(value, minSize) {
        var significand = getSignificand(value);
        var minSizeSign = getSignificand(minSize);
        var result = getSignificand(significand / minSizeSign);
        if (result >= 5) {
            result /= 5;
        }
        if (result >= 4) {
            result /= 4;
        }
        if (result >= 2) {
            result /= 2;
        }
        return result;
    }

    function getSignificand(x) {
        return x * Math.pow(10, Math.ceil(-log10(x)));
    }

    function roundSignificand(x, decimalPlaces) {
        var exponent = -Math.ceil(-log10(x));
        var power = decimalPlaces - exponent;
        var significand = x * Math.pow(10, power);
        // To avoid rounding problems, always work with integers
        if (power < 0) {
            return Math.round(significand) * Math.pow(10, -power);
        }
        return Math.round(significand) / Math.pow(10, power);
    }

    function log10(x) {
        return Math.log(x) / Math.log(10);
    }

    function getWithUnit(value, unitSuffix) {
        if (value < 0.000001) {
            return value * 1000000000 + " n" + unitSuffix;
        }
        if (value < 0.001) {
            return value * 1000000 + " μ" + unitSuffix;
        }
        if (value < 1) {
            return value * 1000 + " m" + unitSuffix;
        }
        if (value >= 1000) {
            return value / 1000 + " k" + unitSuffix;
        }
        return value + " " + unitSuffix;
    }

    function isDefined(variable) {
        return typeof (variable) !== "undefined";
    }
}(OpenSeadragon));

    </script>
    <script> 
       // OpenSeadragon SVG Overlay plugin 0.0.5

(function() {

    var $ = window.OpenSeadragon;
    
    if (!$) {
        $ = require('openseadragon');
        if (!$) {
            throw new Error('OpenSeadragon is missing.');
        }
    }

    var svgNS = 'http://www.w3.org/2000/svg';

    // ----------
    $.Viewer.prototype.svgOverlay = function() {
        if (this._svgOverlayInfo) {
            return this._svgOverlayInfo;
        }

        this._svgOverlayInfo = new Overlay(this);
        return this._svgOverlayInfo;
    };

    // ----------
    var Overlay = function(viewer) {
        var self = this;

        this._viewer = viewer;
        this._containerWidth = 0;
        this._containerHeight = 0;

        this._svg = document.createElementNS(svgNS, 'svg');
        this._svg.style.position = 'absolute';
        this._svg.style.left = 0;
        this._svg.style.top = 0;
        this._svg.style.width = '100%';
        this._svg.style.height = '100%';
        this._viewer.canvas.appendChild(this._svg);

        this._node = document.createElementNS(svgNS, 'g');
        this._svg.appendChild(this._node);

        this._viewer.addHandler('animation', function() {
            self.resize();
        });

        this._viewer.addHandler('open', function() {
            self.resize();
        });

        this._viewer.addHandler('rotate', function(evt) {
            self.resize();
        });

        this._viewer.addHandler('resize', function() {
            self.resize();
        });

        this.resize();
    };

    // ----------
    Overlay.prototype = {
        // ----------
        node: function() {
            return this._node;
        },

        // ----------
        resize: function() {
            if (this._containerWidth !== this._viewer.container.clientWidth) {
                this._containerWidth = this._viewer.container.clientWidth;
                this._svg.setAttribute('width', this._containerWidth);
            }

            if (this._containerHeight !== this._viewer.container.clientHeight) {
                this._containerHeight = this._viewer.container.clientHeight;
                this._svg.setAttribute('height', this._containerHeight);
            }

            var p = this._viewer.viewport.pixelFromPoint(new $.Point(0, 0), true);
            var zoom = this._viewer.viewport.getZoom(true);
            var rotation = this._viewer.viewport.getRotation();
            // TODO: Expose an accessor for _containerInnerSize in the OSD API so we don't have to use the private variable.
            var scale = this._viewer.viewport._containerInnerSize.x * zoom;
            this._node.setAttribute('transform',
                'translate(' + p.x + ',' + p.y + ') scale(' + scale + ') rotate(' + rotation + ')');
        },

        // ----------
        onClick: function(node, handler) {
            // TODO: Fast click for mobile browsers

            new $.MouseTracker({
                element: node,
                clickHandler: handler
            }).setTracking(true);
        }
    };

})();

    </script>
    <script> 
       var MinervaStory=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=31)}([function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(26),i=n(27),a=n(28);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|d(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):h(t,e);if("Buffer"===e.type&&a(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(f(e),t=s(t,e<0?0:0|d(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|d(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(t).length;default:if(r)return V(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return M(this,e,n);case"latin1":case"binary":return E(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){var a,o=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,c/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var f=-1;for(a=n;a<s;a++)if(u(t,a)===u(e,-1===f?0:a-f)){if(-1===f&&(f=a),a-f+1===c)return f*o}else-1!==f&&(a-=a-f),f=-1}else for(n+c>s&&(n=s-c),a=n;a>=0;a--){for(var l=!0,h=0;h<c;h++)if(u(t,a+h)!==u(e,h)){l=!1;break}if(l)return a}return-1}function y(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function w(t,e,n,r){return z(V(e,t.length-n),t,n,r)}function _(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return _(t,e,n,r)}function C(t,e,n,r){return z(H(e),t,n,r)}function A(t,e,n,r){return z(function(t,e){for(var n,r,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,o,s,c,u=t[i],f=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=n)switch(l){case 1:u<128&&(f=u);break;case 2:128==(192&(a=t[i+1]))&&(c=(31&u)<<6|63&a)>127&&(f=c);break;case 3:a=t[i+1],o=t[i+2],128==(192&a)&&128==(192&o)&&(c=(15&u)<<12|(63&a)<<6|63&o)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:a=t[i+1],o=t[i+2],s=t[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(c=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return f(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return l(null,t)},c.allocUnsafeSlow=function(t){return l(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):g.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),s=Math.min(a,o),u=this.slice(r,i),f=t.slice(e,n),l=0;l<s;++l)if(u[l]!==f[l]){a=u[l],o=f[l];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function k(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=L(t[a]);return i}function U(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,n,r,i,a){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function I(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-n,2);i<a;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function R(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-n,4);i<a;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function N(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,a){return a||N(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,a){return a||N(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},c.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<n&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,a=r-n;if(this===t&&n<e&&e<r)for(i=a-1;i>=0;--i)t[i+e]=this[i+n];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var o=c.isBuffer(t)?t:V(new c(t,r).toString()),s=o.length;for(a=0;a<n-e;++a)this[a+e]=o[a%s]}return this};var O=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(O,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(25))},function(t,e,n){var r;t.exports=(r=r||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),r={},i=r.lib={},a=i.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var a=0;a<i;a++){var o=n[a>>>2]>>>24-a%4*8&255;e[r+a>>>2]|=o<<24-(r+a)%4*8}else for(a=0;a<i;a+=4)e[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,r=[],i=function(e){e=e;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(e=18e3*(65535&e)+(e>>16)&r)&r;return i/=4294967296,(i+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var s=i(4294967296*(n||t.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new o.init(r,e)}}),s=r.enc={},c=s.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var a=e[i>>>2]>>>24-i%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new o.init(n,e/2)}},u=s.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var a=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(a))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new o.init(n,e)}},f=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},l=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,u=t.min(4*c,i);if(c){for(var f=0;f<c;f+=a)this._doProcessBlock(r,f);var l=r.splice(0,c);n.sigBytes-=u}return new o.init(l,u)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(i.Hasher=l.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),r.algo={});return r}(Math),r)},,function(t,e,n){var r,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(a){if(void 0===(i="function"==typeof(r=a)?r.call(e,n,e,t):r)||(t.exports=i),!0,t.exports=a(),!!0){var o=window.Cookies,s=window.Cookies=a();s.noConflict=function(){return window.Cookies=o,s}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function i(){}function a(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=t({path:"/"},i.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var o=JSON.stringify(n);/^[\{\[]/.test(o)&&(n=o)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in a)a[c]&&(s+="; "+c,!0!==a[c]&&(s+="="+a[c].split(";")[0]));return document.cookie=e+"="+n+s}}function o(t,n){if("undefined"!=typeof document){for(var i={},a=document.cookie?document.cookie.split("; "):[],o=0;o<a.length;o++){var s=a[o].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(s[0]);if(c=(r.read||r)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(i[u]=c,t===u)break}catch(t){}}return t?i[t]:i}}return i.set=a,i.get=function(t){return o(t,!1)},i.getJSON=function(t){return o(t,!0)},i.remove=function(e,n){a(e,"",t(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},,function(t,e,n){var r;t.exports=(r=n(1),n(10),n(29),r.HmacSHA256)},,,,,function(t,e,n){var r;t.exports=(r=n(1),function(t){var e=r,n=e.lib,i=n.WordArray,a=n.Hasher,o=e.algo,s=[],c=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(s[i]=n(t.pow(r,.5))),c[i]=n(t.pow(r,1/3)),i++),r++}();var u=[],f=o.SHA256=a.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],f=n[5],l=n[6],h=n[7],d=0;d<64;d++){if(d<16)u[d]=0|t[e+d];else{var p=u[d-15],g=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,m=u[d-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;u[d]=g+u[d-7]+v+u[d-16]}var b=r&i^r&a^i&a,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=h+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&f^~s&l)+c[d]+u[d];h=l,l=f,f=s,s=o+w|0,o=a,a=i,i=r,r=w+(y+b)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+f|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=a._createHelper(f),e.HmacSHA256=a._createHmacHelper(f)}(Math),r.SHA256)},function(t,e,n){var r,i,a;t.exports=(a=n(1),i=(r=a).lib.WordArray,r.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp();for(var i=[],a=0;a<n;a+=3)for(var o=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<n;s++)i.push(r.charAt(o>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var o=n.charAt(64);if(o){var s=t.indexOf(o);-1!==s&&(e=s)}return function(t,e,n){for(var r=[],a=0,o=0;o<e;o++)if(o%4){var s=n[t.charCodeAt(o-1)]<<o%4*2,c=n[t.charCodeAt(o)]>>>6-o%4*2;r[a>>>2]|=(s|c)<<24-a%4*8,a++}return i.create(r,a)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},a.enc.Base64)},function(t,e,n){var r,i;void 0===(i="function"==typeof(r={schemeGroups:{sequential:["BuGn","BuPu","GnBu","OrRd","PuBu","PuBuGn","PuRd","RdPu","YlGn","YlGnBu","YlOrBr","YlOrRd"],singlehue:["Blues","Greens","Greys","Oranges","Purples","Reds"],diverging:["BrBG","PiYG","PRGn","PuOr","RdBu","RdGy","RdYlBu","RdYlGn","Spectral"],qualitative:["Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3"]},YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}})?r.call(e,n,e,t):r)||(t.exports=i)},function(t,e,n){var r,i=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(t,e){if(!r[t]){r[t]={};for(var n=0;n<t.length;n++)r[t][t.charAt(n)]=n}return r[t][e]}var a={compressToBase64:function(t){if(null==t)return"";var n=a._compress(t,6,(function(t){return e.charAt(t)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,(function(n){return i(e,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":a._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:a._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=a.compress(t),n=new Uint8Array(2*e.length),r=0,i=e.length;r<i;r++){var o=e.charCodeAt(r);n[2*r]=o>>>8,n[2*r+1]=o%256}return n},decompressFromUint8Array:function(e){if(null==e)return a.decompress(e);for(var n=new Array(e.length/2),r=0,i=n.length;r<i;r++)n[r]=256*e[2*r]+e[2*r+1];var o=[];return n.forEach((function(e){o.push(t(e))})),a.decompress(o.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":a._compress(t,6,(function(t){return n.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,(function(e){return i(n,t.charAt(e))})))},compress:function(e){return a._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,n){if(null==t)return"";var r,i,a,o={},s={},c="",u="",f="",l=2,h=3,d=2,p=[],g=0,m=0;for(a=0;a<t.length;a+=1)if(c=t.charAt(a),Object.prototype.hasOwnProperty.call(o,c)||(o[c]=h++,s[c]=!0),u=f+c,Object.prototype.hasOwnProperty.call(o,u))f=u;else{if(Object.prototype.hasOwnProperty.call(s,f)){if(f.charCodeAt(0)<256){for(r=0;r<d;r++)g<<=1,m==e-1?(m=0,p.push(n(g)),g=0):m++;for(i=f.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1}else{for(i=1,r=0;r<d;r++)g=g<<1|i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i=0;for(i=f.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1}0==--l&&(l=Math.pow(2,d),d++),delete s[f]}else for(i=o[f],r=0;r<d;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1;0==--l&&(l=Math.pow(2,d),d++),o[u]=h++,f=String(c)}if(""!==f){if(Object.prototype.hasOwnProperty.call(s,f)){if(f.charCodeAt(0)<256){for(r=0;r<d;r++)g<<=1,m==e-1?(m=0,p.push(n(g)),g=0):m++;for(i=f.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1}else{for(i=1,r=0;r<d;r++)g=g<<1|i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i=0;for(i=f.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1}0==--l&&(l=Math.pow(2,d),d++),delete s[f]}else for(i=o[f],r=0;r<d;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1;0==--l&&(l=Math.pow(2,d),d++)}for(i=2,r=0;r<d;r++)g=g<<1|1&i,m==e-1?(m=0,p.push(n(g)),g=0):m++,i>>=1;for(;;){if(g<<=1,m==e-1){p.push(n(g));break}m++}return p.join("")},decompress:function(t){return null==t?"":""==t?null:a._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,n,r){var i,a,o,s,c,u,f,l=[],h=4,d=4,p=3,g="",m=[],v={val:r(0),position:n,index:1};for(i=0;i<3;i+=1)l[i]=i;for(o=0,c=Math.pow(2,2),u=1;u!=c;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*u,u<<=1;switch(o){case 0:for(o=0,c=Math.pow(2,8),u=1;u!=c;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*u,u<<=1;f=t(o);break;case 1:for(o=0,c=Math.pow(2,16),u=1;u!=c;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*u,u<<=1;f=t(o);break;case 2:return""}for(l[3]=f,a=f,m.push(f);;){if(v.index>e)return"";for(o=0,c=Math.pow(2,p),u=1;u!=c;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*u,u<<=1;switch(f=o){case 0:for(o=0,c=Math.pow(2,8),u=1;u!=c;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*u,u<<=1;l[d++]=t(o),f=d-1,h--;break;case 1:for(o=0,c=Math.pow(2,16),u=1;u!=c;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*u,u<<=1;l[d++]=t(o),f=d-1,h--;break;case 2:return m.join("")}if(0==h&&(h=Math.pow(2,p),p++),l[f])g=l[f];else{if(f!==d)return null;g=a+a.charAt(0)}m.push(g),l[d++]=a+g.charAt(0),a=g,0==--h&&(h=Math.pow(2,p),p++)}}};return a}();void 0===(r=function(){return i}.call(e,n,e,t))||(t.exports=r)},,,,function(t,e,n){var r;t.exports=(r=n(1),function(){if("function"==typeof ArrayBuffer){var t=r.lib.WordArray,e=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var n=t.byteLength,r=[],i=0;i<n;i++)r[i>>>2]|=t[i]<<24-i%4*8;e.call(this,r,n)}else e.apply(this,arguments)}).prototype=t}}(),r.lib.WordArray)},function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},function(t,e,n){(function(e){var r,i,a,o;r=n(30),i=n(18).utf8,a=n(18).bin,(o=function(t,n){var o=r.wordsToBytes(function(t){t.constructor==String?t=i.stringToBytes(t):void 0!==e&&"function"==typeof e.isBuffer&&e.isBuffer(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());var n=r.bytesToWords(t),a=8*t.length,o=[],s=1732584193,c=-271733879,u=-1732584194,f=271733878,l=-1009589776;n[a>>5]|=128<<24-a%32,n[15+(a+64>>>9<<4)]=a;for(var h=0;h<n.length;h+=16){for(var d=s,p=c,g=u,m=f,v=l,b=0;b<80;b++){if(b<16)o[b]=n[h+b];else{var y=o[b-3]^o[b-8]^o[b-14]^o[b-16];o[b]=y<<1|y>>>31}var w=(s<<5|s>>>27)+l+(o[b]>>>0)+(b<20?1518500249+(c&u|~c&f):b<40?1859775393+(c^u^f):b<60?(c&u|c&f|u&f)-1894007588:(c^u^f)-899497514);l=f,f=u,u=c<<30|c>>>2,c=s,s=w}s+=d,c+=p,u+=g,f+=m,l+=v}return[s,c,u,f,l]}(t));return n&&n.asBytes?o:n&&n.asString?a.bytesToString(o):r.bytesToHex(o)})._blocksize=16,o._digestsize=20,t.exports=o}).call(this,n(0).Buffer)},,,,,,function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),o=r[0],s=r[1],c=new a(function(t,e,n){return 3*(e+n)/4-n}(0,o,s)),f=0,l=s>0?o-4:o;for(n=0;n<l;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],c[f++]=e>>16&255,c[f++]=e>>8&255,c[f++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,c[f++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,c[f++]=e>>8&255,c[f++]=255&e);return c},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(f(t,o,o+16383>s?s:o+16383));1===i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t,e,n){for(var i,a,o=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var a,o,s=8*i-r-1,c=(1<<s)-1,u=c>>1,f=-7,l=n?i-1:0,h=n?-1:1,d=t[e+l];for(l+=h,a=d&(1<<-f)-1,d>>=-f,f+=s;f>0;a=256*a+t[e+l],l+=h,f-=8);for(o=a&(1<<-f)-1,a>>=-f,f+=r;f>0;o=256*o+t[e+l],l+=h,f-=8);if(0===a)a=1-u;else{if(a===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=u}return(d?-1:1)*o*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var o,s,c,u=8*a-i-1,f=(1<<u)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(o++,c/=2),o+l>=f?(s=0,o=f):o+l>=1?(s=(e*c-1)*Math.pow(2,i),o+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*g}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){var r,i,a,o;t.exports=(r=n(1),a=(i=r).lib.Base,o=i.enc.Utf8,void(i.algo.HMAC=a.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=o.parse(e));var n=t.blockSize,r=4*n;e.sigBytes>r&&(e=t.finalize(e)),e.clamp();for(var i=this._oKey=e.clone(),a=this._iKey=e.clone(),s=i.words,c=a.words,u=0;u<n;u++)s[u]^=1549556828,c[u]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})))},function(t,e){var n,r;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],a=0;a<4;a++)8*r+6*a<=8*t.length?e.push(n.charAt(i>>>6*(3-a)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&e.push((n.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|n.indexOf(t.charAt(r))>>>6-2*i);return e}},t.exports=r},function(t,e,n){"use strict";n.r(e);const r=function(t){return t.replace(/^\s+|\s+$/g,"")};class i{constructor(t){this.subject=t,this.eventListeners=[],this.events={testEvent:"testEvent",osdClickEvent:"osdClickEvent"}}bind(t,e){for(const n of t.split(" ")){this.eventListeners.push({eventName:n,eventFunction:e});const t=t=>e(t.detail,t);this.subject.addEventListener(n,t,!1)}}getListeners(){return this.eventListeners}trigger(t,e){this.subject.dispatchEvent(new CustomEvent(t,{detail:e}))}}
/*!
 * Copyright 2016 Amazon.com,
 * Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the
 * License. A copy of the License is located at
 *
 *     http://aws.amazon.com/asl/
 *
 * or in the "license" file accompanying this file. This file is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, express or implied. See the License
 * for the specific language governing permissions and
 * limitations under the License.
 */var a,o=function(){function t(t){var e=t||{},n=e.ValidationData,r=e.Username,i=e.Password,a=e.AuthParameters,o=e.ClientMetadata;this.validationData=n||{},this.authParameters=a||{},this.clientMetadata=o||{},this.username=r,this.password=i}var e=t.prototype;return e.getUsername=function(){return this.username},e.getPassword=function(){return this.password},e.getValidationData=function(){return this.validationData},e.getAuthParameters=function(){return this.authParameters},e.getClientMetadata=function(){return this.clientMetadata},t}(),s=n(0),c=n(1),u=n.n(c),f=(n(17),n(10)),l=n.n(f),h=n(5),d=n.n(h),p=g;function g(t,e){null!=t&&this.fromString(t,e)}function m(){return new g(null)}var v="undefined"!=typeof navigator;v&&"Microsoft Internet Explorer"==navigator.appName?(g.prototype.am=function(t,e,n,r,i,a){for(var o=32767&e,s=e>>15;--a>=0;){var c=32767&this[t],u=this[t++]>>15,f=s*c+u*o;i=((c=o*c+((32767&f)<<15)+n[r]+(1073741823&i))>>>30)+(f>>>15)+s*u+(i>>>30),n[r++]=1073741823&c}return i},a=30):v&&"Netscape"!=navigator.appName?(g.prototype.am=function(t,e,n,r,i,a){for(;--a>=0;){var o=e*this[t++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=67108863&o}return i},a=26):(g.prototype.am=function(t,e,n,r,i,a){for(var o=16383&e,s=e>>14;--a>=0;){var c=16383&this[t],u=this[t++]>>14,f=s*c+u*o;i=((c=o*c+((16383&f)<<14)+n[r]+i)>>28)+(f>>14)+s*u,n[r++]=268435455&c}return i},a=28),g.prototype.DB=a,g.prototype.DM=(1<<a)-1,g.prototype.DV=1<<a;g.prototype.FV=Math.pow(2,52),g.prototype.F1=52-a,g.prototype.F2=2*a-52;var b,y,w=new Array;for(b="0".charCodeAt(0),y=0;y<=9;++y)w[b++]=y;for(b="a".charCodeAt(0),y=10;y<36;++y)w[b++]=y;for(b="A".charCodeAt(0),y=10;y<36;++y)w[b++]=y;function x(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function C(t,e){var n=w[t.charCodeAt(e)];return null==n?-1:n}function A(t){var e=m();return e.fromInt(t),e}function S(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function T(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}T.prototype.convert=function(t){var e=m();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(g.ZERO)>0&&this.m.subTo(e,e),e},T.prototype.revert=function(t){var e=m();return t.copyTo(e),this.reduce(e),e},T.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},T.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},T.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},g.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},g.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},g.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)throw new Error("Only radix 2, 4, 8, 16, 32 are supported");n=2}this.t=0,this.s=0;for(var r=t.length,i=!1,a=0;--r>=0;){var o=C(t,r);o<0?"-"==t.charAt(r)&&(i=!0):(i=!1,0==a?this[this.t++]=o:a+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this[this.t++]=o>>this.DB-a):this[this.t-1]|=o<<a,(a+=n)>=this.DB&&(a-=this.DB))}this.clamp(),i&&g.ZERO.subTo(this,this)},g.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},g.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},g.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},g.prototype.lShiftTo=function(t,e){var n,r=t%this.DB,i=this.DB-r,a=(1<<i)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)e[n+o+1]=this[n]>>i|s,s=(this[n]&a)<<r;for(n=o-1;n>=0;--n)e[n]=0;e[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()},g.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,a=(1<<r)-1;e[0]=this[n]>>r;for(var o=n+1;o<this.t;++o)e[o-n-1]|=(this[o]&a)<<i,e[o-n]=this[o]>>r;r>0&&(e[this.t-n-1]|=(this.s&a)<<i),e.t=this.t-n,e.clamp()}},g.prototype.subTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]-t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r-=t[n],e[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[n++]=this.DV+r:r>0&&(e[n++]=r),e.t=n,e.clamp()},g.prototype.multiplyTo=function(t,e){var n=this.abs(),r=t.abs(),i=n.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+n.t]=n.am(0,r[i],e,i,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&g.ZERO.subTo(e,e)},g.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},g.prototype.divRemTo=function(t,e,n){var r=t.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=m());var a=m(),o=this.s,s=t.s,c=this.DB-S(r[r.t-1]);c>0?(r.lShiftTo(c,a),i.lShiftTo(c,n)):(r.copyTo(a),i.copyTo(n));var u=a.t,f=a[u-1];if(0!=f){var l=f*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0),h=this.FV/l,d=(1<<this.F1)/l,p=1<<this.F2,v=n.t,b=v-u,y=null==e?m():e;for(a.dlShiftTo(b,y),n.compareTo(y)>=0&&(n[n.t++]=1,n.subTo(y,n)),g.ONE.dlShiftTo(u,y),y.subTo(a,a);a.t<u;)a[a.t++]=0;for(;--b>=0;){var w=n[--v]==f?this.DM:Math.floor(n[v]*h+(n[v-1]+p)*d);if((n[v]+=a.am(0,w,n,b,0,u))<w)for(a.dlShiftTo(b,y),n.subTo(y,n);n[v]<--w;)n.subTo(y,n)}null!=e&&(n.drShiftTo(u,e),o!=s&&g.ZERO.subTo(e,e)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),o<0&&g.ZERO.subTo(n,n)}}},g.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},g.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]+t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t[n],e[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[n++]=r:r<-1&&(e[n++]=this.DV+r),e.t=n,e.clamp()},g.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)throw new Error("Only radix 2, 4, 8, 16, 32 are supported");e=2}var n,r=(1<<e)-1,i=!1,a="",o=this.t,s=this.DB-o*this.DB%e;if(o-- >0)for(s<this.DB&&(n=this[o]>>s)>0&&(i=!0,a=x(n));o>=0;)s<e?(n=(this[o]&(1<<s)-1)<<e-s,n|=this[--o]>>(s+=this.DB-e)):(n=this[o]>>(s-=e)&r,s<=0&&(s+=this.DB,--o)),n>0&&(i=!0),i&&(a+=x(n));return i?a:"0"},g.prototype.negate=function(){var t=m();return g.ZERO.subTo(this,t),t},g.prototype.abs=function(){return this.s<0?this.negate():this},g.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},g.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+S(this[this.t-1]^this.s&this.DM)},g.prototype.mod=function(t){var e=m();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(g.ZERO)>0&&t.subTo(e,e),e},g.prototype.equals=function(t){return 0==this.compareTo(t)},g.prototype.add=function(t){var e=m();return this.addTo(t,e),e},g.prototype.subtract=function(t){var e=m();return this.subTo(t,e),e},g.prototype.multiply=function(t){var e=m();return this.multiplyTo(t,e),e},g.prototype.divide=function(t){var e=m();return this.divRemTo(t,e,null),e},g.prototype.modPow=function(t,e,n){var r,i=t.bitLength(),a=A(1),o=new T(e);if(i<=0)return a;r=i<18?1:i<48?3:i<144?4:i<768?5:6;var s=new Array,c=3,u=r-1,f=(1<<r)-1;if(s[1]=o.convert(this),r>1){var l=m();for(o.sqrTo(s[1],l);c<=f;)s[c]=m(),o.mulTo(l,s[c-2],s[c]),c+=2}var h,d,p=t.t-1,g=!0,v=m();for(i=S(t[p])-1;p>=0;){for(i>=u?h=t[p]>>i-u&f:(h=(t[p]&(1<<i+1)-1)<<u-i,p>0&&(h|=t[p-1]>>this.DB+i-u)),c=r;0==(1&h);)h>>=1,--c;if((i-=c)<0&&(i+=this.DB,--p),g)s[h].copyTo(a),g=!1;else{for(;c>1;)o.sqrTo(a,v),o.sqrTo(v,a),c-=2;c>0?o.sqrTo(a,v):(d=a,a=v,v=d),o.mulTo(v,s[h],a)}for(;p>=0&&0==(t[p]&1<<i);)o.sqrTo(a,v),d=a,a=v,v=d,--i<0&&(i=this.DB-1,--p)}var b=o.revert(a);return n(null,b),b},g.ZERO=A(0),g.ONE=A(1);
/*!
 * Copyright 2016 Amazon.com,
 * Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the
 * License. A copy of the License is located at
 *
 *     http://aws.amazon.com/asl/
 *
 * or in the "license" file accompanying this file. This file is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, express or implied. See the License
 * for the specific language governing permissions and
 * limitations under the License.
 */
var M=function(t){return s.Buffer.from(u.a.lib.WordArray.random(t).toString(),"hex")},E=function(){function t(t){this.N=new p("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",16),this.g=new p("2",16),this.k=new p(this.hexHash("00"+this.N.toString(16)+"0"+this.g.toString(16)),16),this.smallAValue=this.generateRandomSmallA(),this.getLargeAValue((function(){})),this.infoBits=s.Buffer.from("Caldera Derived Key","utf8"),this.poolName=t}var e=t.prototype;return e.getSmallAValue=function(){return this.smallAValue},e.getLargeAValue=function(t){var e=this;this.largeAValue?t(null,this.largeAValue):this.calculateA(this.smallAValue,(function(n,r){n&&t(n,null),e.largeAValue=r,t(null,e.largeAValue)}))},e.generateRandomSmallA=function(){var t=M(128).toString("hex");return new p(t,16).mod(this.N)},e.generateRandomString=function(){return M(40).toString("base64")},e.getRandomPassword=function(){return this.randomPassword},e.getSaltDevices=function(){return this.SaltToHashDevices},e.getVerifierDevices=function(){return this.verifierDevices},e.generateHashDevice=function(t,e,n){var r=this;this.randomPassword=this.generateRandomString();var i=""+t+e+":"+this.randomPassword,a=this.hash(i),o=M(16).toString("hex");this.SaltToHashDevices=this.padHex(new p(o,16)),this.g.modPow(new p(this.hexHash(this.SaltToHashDevices+a),16),this.N,(function(t,e){t&&n(t,null),r.verifierDevices=r.padHex(e),n(null,null)}))},e.calculateA=function(t,e){var n=this;this.g.modPow(t,this.N,(function(t,r){t&&e(t,null),r.mod(n.N).equals(p.ZERO)&&e(new Error("Illegal paramater. A mod N cannot be 0."),null),e(null,r)}))},e.calculateU=function(t,e){return this.UHexHash=this.hexHash(this.padHex(t)+this.padHex(e)),new p(this.UHexHash,16)},e.hash=function(t){var e=t instanceof s.Buffer?u.a.lib.WordArray.create(t):t,n=l()(e).toString();return new Array(64-n.length).join("0")+n},e.hexHash=function(t){return this.hash(s.Buffer.from(t,"hex"))},e.computehkdf=function(t,e){var n=u.a.lib.WordArray.create(s.Buffer.concat([this.infoBits,s.Buffer.from(String.fromCharCode(1),"utf8")])),r=t instanceof s.Buffer?u.a.lib.WordArray.create(t):t,i=e instanceof s.Buffer?u.a.lib.WordArray.create(e):e,a=d()(r,i),o=d()(n,a);return s.Buffer.from(o.toString(),"hex").slice(0,16)},e.getPasswordAuthenticationKey=function(t,e,n,r,i){var a=this;if(n.mod(this.N).equals(p.ZERO))throw new Error("B cannot be zero.");if(this.UValue=this.calculateU(this.largeAValue,n),this.UValue.equals(p.ZERO))throw new Error("U cannot be zero.");var o=""+this.poolName+t+":"+e,c=this.hash(o),u=new p(this.hexHash(this.padHex(r)+c),16);this.calculateS(u,n,(function(t,e){t&&i(t,null);var n=a.computehkdf(s.Buffer.from(a.padHex(e),"hex"),s.Buffer.from(a.padHex(a.UValue.toString(16)),"hex"));i(null,n)}))},e.calculateS=function(t,e,n){var r=this;this.g.modPow(t,this.N,(function(i,a){i&&n(i,null),e.subtract(r.k.multiply(a)).modPow(r.smallAValue.add(r.UValue.multiply(t)),r.N,(function(t,e){t&&n(t,null),n(null,e.mod(r.N))}))}))},e.getNewPasswordRequiredChallengeUserAttributePrefix=function(){return"userAttributes."},e.padHex=function(t){var e=t.toString(16);return e.length%2==1?e="0"+e:-1!=="89ABCDEFabcdef".indexOf(e[0])&&(e="00"+e),e},t}(),k=function(){function t(t){this.jwtToken=t||"",this.payload=this.decodePayload()}var e=t.prototype;return e.getJwtToken=function(){return this.jwtToken},e.getExpiration=function(){return this.payload.exp},e.getIssuedAt=function(){return this.payload.iat},e.decodePayload=function(){var t=this.jwtToken.split(".")[1];try{return JSON.parse(s.Buffer.from(t,"base64").toString("utf8"))}catch(t){return{}}},t}();var U=function(t){var e,n;function r(e){var n=(void 0===e?{}:e).AccessToken;return t.call(this,n||"")||this}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r}(k);
/*!
 * Copyright 2016 Amazon.com,
 * Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the
 * License. A copy of the License is located at
 *
 *     http://aws.amazon.com/asl/
 *
 * or in the "license" file accompanying this file. This file is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, express or implied. See the License
 * for the specific language governing permissions and
 * limitations under the License.
 */
var D=function(t){var e,n;function r(e){var n=(void 0===e?{}:e).IdToken;return t.call(this,n||"")||this}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r}(k),P=function(){function t(t){var e=(void 0===t?{}:t).RefreshToken;this.token=e||""}return t.prototype.getToken=function(){return this.token},t}(),I=n(11),R=n.n(I),N=function(){function t(t){var e=void 0===t?{}:t,n=e.IdToken,r=e.RefreshToken,i=e.AccessToken,a=e.ClockDrift;if(null==i||null==n)throw new Error("Id token and Access Token must be present.");this.idToken=n,this.refreshToken=r,this.accessToken=i,this.clockDrift=void 0===a?this.calculateClockDrift():a}var e=t.prototype;return e.getIdToken=function(){return this.idToken},e.getRefreshToken=function(){return this.refreshToken},e.getAccessToken=function(){return this.accessToken},e.getClockDrift=function(){return this.clockDrift},e.calculateClockDrift=function(){return Math.floor(new Date/1e3)-Math.min(this.accessToken.getIssuedAt(),this.idToken.getIssuedAt())},e.isValid=function(){var t=Math.floor(new Date/1e3)-this.clockDrift;return t<this.accessToken.getExpiration()&&t<this.idToken.getExpiration()},t}(),B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],F=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],O=function(){function t(){}return t.prototype.getNowString=function(){var t=new Date,e=F[t.getUTCDay()],n=B[t.getUTCMonth()],r=t.getUTCDate(),i=t.getUTCHours();i<10&&(i="0"+i);var a=t.getUTCMinutes();a<10&&(a="0"+a);var o=t.getUTCSeconds();return o<10&&(o="0"+o),e+" "+n+" "+r+" "+i+":"+a+":"+o+" UTC "+t.getUTCFullYear()},t}(),L=function(){function t(t){var e=void 0===t?{}:t,n=e.Name,r=e.Value;this.Name=n||"",this.Value=r||""}var e=t.prototype;return e.getValue=function(){return this.Value},e.setValue=function(t){return this.Value=t,this},e.getName=function(){return this.Name},e.setName=function(t){return this.Name=t,this},e.toString=function(){return JSON.stringify(this)},e.toJSON=function(){return{Name:this.Name,Value:this.Value}},t}(),V={},H=function(){function t(){}return t.setItem=function(t,e){return V[t]=e,V[t]},t.getItem=function(t){return Object.prototype.hasOwnProperty.call(V,t)?V[t]:void 0},t.removeItem=function(t){return delete V[t]},t.clear=function(){return V={}},t}(),z=function(){function t(){try{this.storageWindow=window.localStorage,this.storageWindow.setItem("aws.cognito.test-ls",1),this.storageWindow.removeItem("aws.cognito.test-ls")}catch(t){this.storageWindow=H}}return t.prototype.getStorage=function(){return this.storageWindow},t}(),Y="undefined"!=typeof navigator?navigator.userAgent:"nodejs",q=function(){function t(t){if(null==t||null==t.Username||null==t.Pool)throw new Error("Username and pool information are required.");this.username=t.Username||"",this.pool=t.Pool,this.Session=null,this.client=t.Pool.client,this.signInUserSession=null,this.authenticationFlowType="USER_SRP_AUTH",this.storage=t.Storage||(new z).getStorage(),this.keyPrefix="CognitoIdentityServiceProvider."+this.pool.getClientId(),this.userDataKey=this.keyPrefix+"."+this.username+".userData"}var e=t.prototype;return e.setSignInUserSession=function(t){this.clearCachedUserData(),this.signInUserSession=t,this.cacheTokens()},e.getSignInUserSession=function(){return this.signInUserSession},e.getUsername=function(){return this.username},e.getAuthenticationFlowType=function(){return this.authenticationFlowType},e.setAuthenticationFlowType=function(t){this.authenticationFlowType=t},e.initiateAuth=function(t,e){var n=this,r=t.getAuthParameters();r.USERNAME=this.username;var i=0!==Object.keys(t.getValidationData()).length?t.getValidationData():t.getClientMetadata(),a={AuthFlow:"CUSTOM_AUTH",ClientId:this.pool.getClientId(),AuthParameters:r,ClientMetadata:i};this.getUserContextData()&&(a.UserContextData=this.getUserContextData()),this.client.request("InitiateAuth",a,(function(t,r){if(t)return e.onFailure(t);var i=r.ChallengeName,a=r.ChallengeParameters;return"CUSTOM_CHALLENGE"===i?(n.Session=r.Session,e.customChallenge(a)):(n.signInUserSession=n.getCognitoUserSession(r.AuthenticationResult),n.cacheTokens(),e.onSuccess(n.signInUserSession))}))},e.authenticateUser=function(t,e){return"USER_PASSWORD_AUTH"===this.authenticationFlowType?this.authenticateUserPlainUsernamePassword(t,e):"USER_SRP_AUTH"===this.authenticationFlowType||"CUSTOM_AUTH"===this.authenticationFlowType?this.authenticateUserDefaultAuth(t,e):e.onFailure(new Error("Authentication flow type is invalid."))},e.authenticateUserDefaultAuth=function(t,e){var n,r,i=this,a=new E(this.pool.getUserPoolId().split("_")[1]),o=new O,c={};null!=this.deviceKey&&(c.DEVICE_KEY=this.deviceKey),c.USERNAME=this.username,a.getLargeAValue((function(f,l){f&&e.onFailure(f),c.SRP_A=l.toString(16),"CUSTOM_AUTH"===i.authenticationFlowType&&(c.CHALLENGE_NAME="SRP_A");var h=0!==Object.keys(t.getValidationData()).length?t.getValidationData():t.getClientMetadata(),g={AuthFlow:i.authenticationFlowType,ClientId:i.pool.getClientId(),AuthParameters:c,ClientMetadata:h};i.getUserContextData(i.username)&&(g.UserContextData=i.getUserContextData(i.username)),i.client.request("InitiateAuth",g,(function(c,f){if(c)return e.onFailure(c);var l=f.ChallengeParameters;i.username=l.USER_ID_FOR_SRP,n=new p(l.SRP_B,16),r=new p(l.SALT,16),i.getCachedDeviceKeyAndPassword(),a.getPasswordAuthenticationKey(i.username,t.getPassword(),n,r,(function(t,n){t&&e.onFailure(t);var r=o.getNowString(),c=u.a.lib.WordArray.create(s.Buffer.concat([s.Buffer.from(i.pool.getUserPoolId().split("_")[1],"utf8"),s.Buffer.from(i.username,"utf8"),s.Buffer.from(l.SECRET_BLOCK,"base64"),s.Buffer.from(r,"utf8")])),p=u.a.lib.WordArray.create(n),g=R.a.stringify(d()(c,p)),m={};m.USERNAME=i.username,m.PASSWORD_CLAIM_SECRET_BLOCK=l.SECRET_BLOCK,m.TIMESTAMP=r,m.PASSWORD_CLAIM_SIGNATURE=g,null!=i.deviceKey&&(m.DEVICE_KEY=i.deviceKey);var v={ChallengeName:"PASSWORD_VERIFIER",ClientId:i.pool.getClientId(),ChallengeResponses:m,Session:f.Session,ClientMetadata:h};i.getUserContextData()&&(v.UserContextData=i.getUserContextData()),function t(e,n){return i.client.request("RespondToAuthChallenge",e,(function(r,a){return r&&"ResourceNotFoundException"===r.code&&-1!==r.message.toLowerCase().indexOf("device")?(m.DEVICE_KEY=null,i.deviceKey=null,i.randomPassword=null,i.deviceGroupKey=null,i.clearCachedDeviceKeyAndPassword(),t(e,n)):n(r,a)}))}(v,(function(t,n){return t?e.onFailure(t):i.authenticateUserInternal(n,a,e)}))}))}))}))},e.authenticateUserPlainUsernamePassword=function(t,e){var n=this,r={};if(r.USERNAME=this.username,r.PASSWORD=t.getPassword(),r.PASSWORD){var i=new E(this.pool.getUserPoolId().split("_")[1]);this.getCachedDeviceKeyAndPassword(),null!=this.deviceKey&&(r.DEVICE_KEY=this.deviceKey);var a=0!==Object.keys(t.getValidationData()).length?t.getValidationData():t.getClientMetadata(),o={AuthFlow:"USER_PASSWORD_AUTH",ClientId:this.pool.getClientId(),AuthParameters:r,ClientMetadata:a};this.getUserContextData(this.username)&&(o.UserContextData=this.getUserContextData(this.username)),this.client.request("InitiateAuth",o,(function(t,r){return t?e.onFailure(t):n.authenticateUserInternal(r,i,e)}))}else e.onFailure(new Error("PASSWORD parameter is required"))},e.authenticateUserInternal=function(t,e,n){var r=this,i=t.ChallengeName,a=t.ChallengeParameters;if("SMS_MFA"===i)return this.Session=t.Session,n.mfaRequired(i,a);if("SELECT_MFA_TYPE"===i)return this.Session=t.Session,n.selectMFAType(i,a);if("MFA_SETUP"===i)return this.Session=t.Session,n.mfaSetup(i,a);if("SOFTWARE_TOKEN_MFA"===i)return this.Session=t.Session,n.totpRequired(i,a);if("CUSTOM_CHALLENGE"===i)return this.Session=t.Session,n.customChallenge(a);if("NEW_PASSWORD_REQUIRED"===i){this.Session=t.Session;var o=null,c=null,u=[],f=e.getNewPasswordRequiredChallengeUserAttributePrefix();if(a&&(o=JSON.parse(t.ChallengeParameters.userAttributes),c=JSON.parse(t.ChallengeParameters.requiredAttributes)),c)for(var l=0;l<c.length;l++)u[l]=c[l].substr(f.length);return n.newPasswordRequired(o,u)}if("DEVICE_SRP_AUTH"!==i){this.signInUserSession=this.getCognitoUserSession(t.AuthenticationResult),this.challengeName=i,this.cacheTokens();var h=t.AuthenticationResult.NewDeviceMetadata;if(null==h)return n.onSuccess(this.signInUserSession);e.generateHashDevice(t.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,t.AuthenticationResult.NewDeviceMetadata.DeviceKey,(function(i){if(i)return n.onFailure(i);var a={Salt:s.Buffer.from(e.getSaltDevices(),"hex").toString("base64"),PasswordVerifier:s.Buffer.from(e.getVerifierDevices(),"hex").toString("base64")};r.verifierDevices=a.PasswordVerifier,r.deviceGroupKey=h.DeviceGroupKey,r.randomPassword=e.getRandomPassword(),r.client.request("ConfirmDevice",{DeviceKey:h.DeviceKey,AccessToken:r.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:a,DeviceName:Y},(function(e,i){return e?n.onFailure(e):(r.deviceKey=t.AuthenticationResult.NewDeviceMetadata.DeviceKey,r.cacheDeviceKeyAndPassword(),!0===i.UserConfirmationNecessary?n.onSuccess(r.signInUserSession,i.UserConfirmationNecessary):n.onSuccess(r.signInUserSession))}))}))}else this.getDeviceResponse(n)},e.completeNewPasswordChallenge=function(t,e,n,r){var i=this;if(!t)return n.onFailure(new Error("New password is required."));var a=new E(this.pool.getUserPoolId().split("_")[1]),o=a.getNewPasswordRequiredChallengeUserAttributePrefix(),s={};e&&Object.keys(e).forEach((function(t){s[o+t]=e[t]})),s.NEW_PASSWORD=t,s.USERNAME=this.username;var c={ChallengeName:"NEW_PASSWORD_REQUIRED",ClientId:this.pool.getClientId(),ChallengeResponses:s,Session:this.Session,ClientMetadata:r};this.getUserContextData()&&(c.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",c,(function(t,e){return t?n.onFailure(t):i.authenticateUserInternal(e,a,n)}))},e.getDeviceResponse=function(t,e){var n=this,r=new E(this.deviceGroupKey),i=new O,a={};a.USERNAME=this.username,a.DEVICE_KEY=this.deviceKey,r.getLargeAValue((function(o,c){o&&t.onFailure(o),a.SRP_A=c.toString(16);var f={ChallengeName:"DEVICE_SRP_AUTH",ClientId:n.pool.getClientId(),ChallengeResponses:a,ClientMetadata:e};n.getUserContextData()&&(f.UserContextData=n.getUserContextData()),n.client.request("RespondToAuthChallenge",f,(function(e,a){if(e)return t.onFailure(e);var o=a.ChallengeParameters,c=new p(o.SRP_B,16),f=new p(o.SALT,16);r.getPasswordAuthenticationKey(n.deviceKey,n.randomPassword,c,f,(function(e,r){if(e)return t.onFailure(e);var c=i.getNowString(),f=u.a.lib.WordArray.create(s.Buffer.concat([s.Buffer.from(n.deviceGroupKey,"utf8"),s.Buffer.from(n.deviceKey,"utf8"),s.Buffer.from(o.SECRET_BLOCK,"base64"),s.Buffer.from(c,"utf8")])),l=u.a.lib.WordArray.create(r),h=R.a.stringify(d()(f,l)),p={};p.USERNAME=n.username,p.PASSWORD_CLAIM_SECRET_BLOCK=o.SECRET_BLOCK,p.TIMESTAMP=c,p.PASSWORD_CLAIM_SIGNATURE=h,p.DEVICE_KEY=n.deviceKey;var g={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:n.pool.getClientId(),ChallengeResponses:p,Session:a.Session};n.getUserContextData()&&(g.UserContextData=n.getUserContextData()),n.client.request("RespondToAuthChallenge",g,(function(e,r){return e?t.onFailure(e):(n.signInUserSession=n.getCognitoUserSession(r.AuthenticationResult),n.cacheTokens(),t.onSuccess(n.signInUserSession))}))}))}))}))},e.confirmRegistration=function(t,e,n,r){var i={ClientId:this.pool.getClientId(),ConfirmationCode:t,Username:this.username,ForceAliasCreation:e,ClientMetadata:r};this.getUserContextData()&&(i.UserContextData=this.getUserContextData()),this.client.request("ConfirmSignUp",i,(function(t){return t?n(t,null):n(null,"SUCCESS")}))},e.sendCustomChallengeAnswer=function(t,e,n){var r=this,i={};i.USERNAME=this.username,i.ANSWER=t;var a=new E(this.pool.getUserPoolId().split("_")[1]);this.getCachedDeviceKeyAndPassword(),null!=this.deviceKey&&(i.DEVICE_KEY=this.deviceKey);var o={ChallengeName:"CUSTOM_CHALLENGE",ChallengeResponses:i,ClientId:this.pool.getClientId(),Session:this.Session,ClientMetadata:n};this.getUserContextData()&&(o.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",o,(function(t,n){return t?e.onFailure(t):r.authenticateUserInternal(n,a,e)}))},e.sendMFACode=function(t,e,n,r){var i=this,a={};a.USERNAME=this.username,a.SMS_MFA_CODE=t;var o=n||"SMS_MFA";"SOFTWARE_TOKEN_MFA"===o&&(a.SOFTWARE_TOKEN_MFA_CODE=t),null!=this.deviceKey&&(a.DEVICE_KEY=this.deviceKey);var c={ChallengeName:o,ChallengeResponses:a,ClientId:this.pool.getClientId(),Session:this.Session,ClientMetadata:r};this.getUserContextData()&&(c.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",c,(function(t,n){if(t)return e.onFailure(t);if("DEVICE_SRP_AUTH"!==n.ChallengeName){if(i.signInUserSession=i.getCognitoUserSession(n.AuthenticationResult),i.cacheTokens(),null==n.AuthenticationResult.NewDeviceMetadata)return e.onSuccess(i.signInUserSession);var r=new E(i.pool.getUserPoolId().split("_")[1]);r.generateHashDevice(n.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,n.AuthenticationResult.NewDeviceMetadata.DeviceKey,(function(t){if(t)return e.onFailure(t);var a={Salt:s.Buffer.from(r.getSaltDevices(),"hex").toString("base64"),PasswordVerifier:s.Buffer.from(r.getVerifierDevices(),"hex").toString("base64")};i.verifierDevices=a.PasswordVerifier,i.deviceGroupKey=n.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,i.randomPassword=r.getRandomPassword(),i.client.request("ConfirmDevice",{DeviceKey:n.AuthenticationResult.NewDeviceMetadata.DeviceKey,AccessToken:i.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:a,DeviceName:Y},(function(t,r){return t?e.onFailure(t):(i.deviceKey=n.AuthenticationResult.NewDeviceMetadata.DeviceKey,i.cacheDeviceKeyAndPassword(),!0===r.UserConfirmationNecessary?e.onSuccess(i.signInUserSession,r.UserConfirmationNecessary):e.onSuccess(i.signInUserSession))}))}))}else i.getDeviceResponse(e)}))},e.changePassword=function(t,e,n,r){if(null==this.signInUserSession||!this.signInUserSession.isValid())return n(new Error("User is not authenticated"),null);this.client.request("ChangePassword",{PreviousPassword:t,ProposedPassword:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:r},(function(t){return t?n(t,null):n(null,"SUCCESS")}))},e.enableMFA=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t(new Error("User is not authenticated"),null);var e=[];e.push({DeliveryMedium:"SMS",AttributeName:"phone_number"}),this.client.request("SetUserSettings",{MFAOptions:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(e){return e?t(e,null):t(null,"SUCCESS")}))},e.setUserMfaPreference=function(t,e,n){if(null==this.signInUserSession||!this.signInUserSession.isValid())return n(new Error("User is not authenticated"),null);this.client.request("SetUserMFAPreference",{SMSMfaSettings:t,SoftwareTokenMfaSettings:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(t){return t?n(t,null):n(null,"SUCCESS")}))},e.disableMFA=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t(new Error("User is not authenticated"),null);this.client.request("SetUserSettings",{MFAOptions:[],AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(e){return e?t(e,null):t(null,"SUCCESS")}))},e.deleteUser=function(t,e){var n=this;if(null==this.signInUserSession||!this.signInUserSession.isValid())return t(new Error("User is not authenticated"),null);this.client.request("DeleteUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:e},(function(e){return e?t(e,null):(n.clearCachedUser(),t(null,"SUCCESS"))}))},e.updateAttributes=function(t,e,n){if(null==this.signInUserSession||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);this.client.request("UpdateUserAttributes",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserAttributes:t,ClientMetadata:n},(function(t){return t?e(t,null):e(null,"SUCCESS")}))},e.getUserAttributes=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t(new Error("User is not authenticated"),null);this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(e,n){if(e)return t(e,null);for(var r=[],i=0;i<n.UserAttributes.length;i++){var a={Name:n.UserAttributes[i].Name,Value:n.UserAttributes[i].Value},o=new L(a);r.push(o)}return t(null,r)}))},e.getMFAOptions=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t(new Error("User is not authenticated"),null);this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(e,n){return e?t(e,null):t(null,n.MFAOptions)}))},e.getUserData=function(t,e){var n=this;if(null==this.signInUserSession||!this.signInUserSession.isValid())return this.clearCachedUserData(),t(new Error("User is not authenticated"),null);var r=!!e&&e.bypassCache,i=this.storage.getItem(this.userDataKey);if(!i||r)this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(e,r){if(e)return t(e,null);n.cacheUserData(r);var i=n.signInUserSession.getRefreshToken();if(!i||!i.getToken())return t(null,r);n.refreshSession(i,(function(e,n){return e?t(e,null):t(null,r)}))}));else try{return t(null,JSON.parse(i))}catch(e){return this.clearCachedUserData(),t(e,null)}},e.deleteAttributes=function(t,e){if(null==this.signInUserSession||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);this.client.request("DeleteUserAttributes",{UserAttributeNames:t,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(t){return t?e(t,null):e(null,"SUCCESS")}))},e.resendConfirmationCode=function(t,e){var n={ClientId:this.pool.getClientId(),Username:this.username,ClientMetadata:e};this.client.request("ResendConfirmationCode",n,(function(e,n){return e?t(e,null):t(null,n)}))},e.getSession=function(t){if(null==this.username)return t(new Error("Username is null. Cannot retrieve a new session"),null);if(null!=this.signInUserSession&&this.signInUserSession.isValid())return t(null,this.signInUserSession);var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,n=e+".idToken",r=e+".accessToken",i=e+".refreshToken",a=e+".clockDrift";if(this.storage.getItem(n)){var o=new D({IdToken:this.storage.getItem(n)}),s=new U({AccessToken:this.storage.getItem(r)}),c=new P({RefreshToken:this.storage.getItem(i)}),u=parseInt(this.storage.getItem(a),0)||0,f=new N({IdToken:o,AccessToken:s,RefreshToken:c,ClockDrift:u});if(f.isValid())return this.signInUserSession=f,t(null,this.signInUserSession);if(!c.getToken())return t(new Error("Cannot retrieve a new session. Please authenticate."),null);this.refreshSession(c,t)}else t(new Error("Local storage is missing an ID Token, Please authenticate"),null)},e.refreshSession=function(t,e,n){var r=this,i={};i.REFRESH_TOKEN=t.getToken();var a="CognitoIdentityServiceProvider."+this.pool.getClientId(),o=a+".LastAuthUser";if(this.storage.getItem(o)){this.username=this.storage.getItem(o);var s=a+"."+this.username+".deviceKey";this.deviceKey=this.storage.getItem(s),i.DEVICE_KEY=this.deviceKey}var c={ClientId:this.pool.getClientId(),AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:i,ClientMetadata:n};this.getUserContextData()&&(c.UserContextData=this.getUserContextData()),this.client.request("InitiateAuth",c,(function(n,i){if(n)return"NotAuthorizedException"===n.code&&r.clearCachedUser(),e(n,null);if(i){var a=i.AuthenticationResult;return Object.prototype.hasOwnProperty.call(a,"RefreshToken")||(a.RefreshToken=t.getToken()),r.signInUserSession=r.getCognitoUserSession(a),r.cacheTokens(),e(null,r.signInUserSession)}}))},e.cacheTokens=function(){var t="CognitoIdentityServiceProvider."+this.pool.getClientId(),e=t+"."+this.username+".idToken",n=t+"."+this.username+".accessToken",r=t+"."+this.username+".refreshToken",i=t+"."+this.username+".clockDrift",a=t+".LastAuthUser";this.storage.setItem(e,this.signInUserSession.getIdToken().getJwtToken()),this.storage.setItem(n,this.signInUserSession.getAccessToken().getJwtToken()),this.storage.setItem(r,this.signInUserSession.getRefreshToken().getToken()),this.storage.setItem(i,""+this.signInUserSession.getClockDrift()),this.storage.setItem(a,this.username)},e.cacheUserData=function(t){this.storage.setItem(this.userDataKey,JSON.stringify(t))},e.clearCachedUserData=function(){this.storage.removeItem(this.userDataKey)},e.clearCachedUser=function(){this.clearCachedTokens(),this.clearCachedUserData()},e.cacheDeviceKeyAndPassword=function(){var t="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,e=t+".deviceKey",n=t+".randomPasswordKey",r=t+".deviceGroupKey";this.storage.setItem(e,this.deviceKey),this.storage.setItem(n,this.randomPassword),this.storage.setItem(r,this.deviceGroupKey)},e.getCachedDeviceKeyAndPassword=function(){var t="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,e=t+".deviceKey",n=t+".randomPasswordKey",r=t+".deviceGroupKey";this.storage.getItem(e)&&(this.deviceKey=this.storage.getItem(e),this.randomPassword=this.storage.getItem(n),this.deviceGroupKey=this.storage.getItem(r))},e.clearCachedDeviceKeyAndPassword=function(){var t="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,e=t+".deviceKey",n=t+".randomPasswordKey",r=t+".deviceGroupKey";this.storage.removeItem(e),this.storage.removeItem(n),this.storage.removeItem(r)},e.clearCachedTokens=function(){var t="CognitoIdentityServiceProvider."+this.pool.getClientId(),e=t+"."+this.username+".idToken",n=t+"."+this.username+".accessToken",r=t+"."+this.username+".refreshToken",i=t+".LastAuthUser",a=t+"."+this.username+".clockDrift";this.storage.removeItem(e),this.storage.removeItem(n),this.storage.removeItem(r),this.storage.removeItem(i),this.storage.removeItem(a)},e.getCognitoUserSession=function(t){var e=new D(t),n=new U(t),r=new P(t);return new N({IdToken:e,AccessToken:n,RefreshToken:r})},e.forgotPassword=function(t,e){var n={ClientId:this.pool.getClientId(),Username:this.username,ClientMetadata:e};this.getUserContextData()&&(n.UserContextData=this.getUserContextData()),this.client.request("ForgotPassword",n,(function(e,n){return e?t.onFailure(e):"function"==typeof t.inputVerificationCode?t.inputVerificationCode(n):t.onSuccess(n)}))},e.confirmPassword=function(t,e,n,r){var i={ClientId:this.pool.getClientId(),Username:this.username,ConfirmationCode:t,Password:e,ClientMetadata:r};this.getUserContextData()&&(i.UserContextData=this.getUserContextData()),this.client.request("ConfirmForgotPassword",i,(function(t){return t?n.onFailure(t):n.onSuccess()}))},e.getAttributeVerificationCode=function(t,e,n){if(null==this.signInUserSession||!this.signInUserSession.isValid())return e.onFailure(new Error("User is not authenticated"));this.client.request("GetUserAttributeVerificationCode",{AttributeName:t,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:n},(function(t,n){return t?e.onFailure(t):"function"==typeof e.inputVerificationCode?e.inputVerificationCode(n):e.onSuccess()}))},e.verifyAttribute=function(t,e,n){if(null==this.signInUserSession||!this.signInUserSession.isValid())return n.onFailure(new Error("User is not authenticated"));this.client.request("VerifyUserAttribute",{AttributeName:t,Code:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(t){return t?n.onFailure(t):n.onSuccess("SUCCESS")}))},e.getDevice=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t.onFailure(new Error("User is not authenticated"));this.client.request("GetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey},(function(e,n){return e?t.onFailure(e):t.onSuccess(n)}))},e.forgetSpecificDevice=function(t,e){if(null==this.signInUserSession||!this.signInUserSession.isValid())return e.onFailure(new Error("User is not authenticated"));this.client.request("ForgetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:t},(function(t){return t?e.onFailure(t):e.onSuccess("SUCCESS")}))},e.forgetDevice=function(t){var e=this;this.forgetSpecificDevice(this.deviceKey,{onFailure:t.onFailure,onSuccess:function(n){return e.deviceKey=null,e.deviceGroupKey=null,e.randomPassword=null,e.clearCachedDeviceKeyAndPassword(),t.onSuccess(n)}})},e.setDeviceStatusRemembered=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t.onFailure(new Error("User is not authenticated"));this.client.request("UpdateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"remembered"},(function(e){return e?t.onFailure(e):t.onSuccess("SUCCESS")}))},e.setDeviceStatusNotRemembered=function(t){if(null==this.signInUserSession||!this.signInUserSession.isValid())return t.onFailure(new Error("User is not authenticated"));this.client.request("UpdateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"not_remembered"},(function(e){return e?t.onFailure(e):t.onSuccess("SUCCESS")}))},e.listDevices=function(t,e,n){if(null==this.signInUserSession||!this.signInUserSession.isValid())return n.onFailure(new Error("User is not authenticated"));this.client.request("ListDevices",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),Limit:t,PaginationToken:e},(function(t,e){return t?n.onFailure(t):n.onSuccess(e)}))},e.globalSignOut=function(t){var e=this;if(null==this.signInUserSession||!this.signInUserSession.isValid())return t.onFailure(new Error("User is not authenticated"));this.client.request("GlobalSignOut",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(n){return n?t.onFailure(n):(e.clearCachedUser(),t.onSuccess("SUCCESS"))}))},e.signOut=function(){this.signInUserSession=null,this.clearCachedUser()},e.sendMFASelectionAnswer=function(t,e){var n=this,r={};r.USERNAME=this.username,r.ANSWER=t;var i={ChallengeName:"SELECT_MFA_TYPE",ChallengeResponses:r,ClientId:this.pool.getClientId(),Session:this.Session};this.getUserContextData()&&(i.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",i,(function(r,i){return r?e.onFailure(r):(n.Session=i.Session,"SMS_MFA"===t?e.mfaRequired(i.challengeName,i.challengeParameters):"SOFTWARE_TOKEN_MFA"===t?e.totpRequired(i.challengeName,i.challengeParameters):void 0)}))},e.getUserContextData=function(){return this.pool.getUserContextData(this.username)},e.associateSoftwareToken=function(t){var e=this;null!=this.signInUserSession&&this.signInUserSession.isValid()?this.client.request("AssociateSoftwareToken",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},(function(e,n){return e?t.onFailure(e):t.associateSecretCode(n.SecretCode)})):this.client.request("AssociateSoftwareToken",{Session:this.Session},(function(n,r){return n?t.onFailure(n):(e.Session=r.Session,t.associateSecretCode(r.SecretCode))}))},e.verifySoftwareToken=function(t,e,n){var r=this;null!=this.signInUserSession&&this.signInUserSession.isValid()?this.client.request("VerifySoftwareToken",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserCode:t,FriendlyDeviceName:e},(function(t,e){return t?n.onFailure(t):n.onSuccess(e)})):this.client.request("VerifySoftwareToken",{Session:this.Session,UserCode:t,FriendlyDeviceName:e},(function(t,e){if(t)return n.onFailure(t);r.Session=e.Session;var i={};i.USERNAME=r.username;var a={ChallengeName:"MFA_SETUP",ClientId:r.pool.getClientId(),ChallengeResponses:i,Session:r.Session};r.getUserContextData()&&(a.UserContextData=r.getUserContextData()),r.client.request("RespondToAuthChallenge",a,(function(t,e){return t?n.onFailure(t):(r.signInUserSession=r.getCognitoUserSession(e.AuthenticationResult),r.cacheTokens(),n.onSuccess(r.signInUserSession))}))}))},t}(),j=W;
/*!
 * Copyright 2016 Amazon.com,
 * Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the
 * License. A copy of the License is located at
 *
 *     http://aws.amazon.com/asl/
 *
 * or in the "license" file accompanying this file. This file is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, express or implied. See the License
 * for the specific language governing permissions and
 * limitations under the License.
 */function W(){}W.prototype.userAgent="aws-amplify/0.1.x js";var K=function(){function t(t,e){this.endpoint=e||"https://cognito-idp."+t+".amazonaws.com/",this.userAgent=j.prototype.userAgent||"aws-amplify/0.1.x js"}return t.prototype.request=function(t,e,n){var r,i={headers:{"Content-Type":"application/x-amz-json-1.1","X-Amz-Target":"AWSCognitoIdentityProviderService."+t,"X-Amz-User-Agent":this.userAgent},method:"POST",mode:"cors",cache:"no-cache",body:JSON.stringify(e)};fetch(this.endpoint,i).then((function(t){return r=t,t}),(function(t){if(t instanceof TypeError)throw new Error("Network error");throw t})).then((function(t){return t.json().catch((function(){return{}}))})).then((function(t){if(r.ok)return n(null,t);t;var e=(t.__type||t.code).split("#").pop(),i={code:e,name:e,message:t.message||t.Message||null};return n(i)})).catch((function(t){if(!(r&&r.headers&&r.headers.get("x-amzn-errortype"))){if(t instanceof Error&&"Network error"===t.message){var e={code:"NetworkError",name:t.name,message:t.message};return n(e)}return n(t)}try{var i=r.headers.get("x-amzn-errortype").split(":")[0],a={code:i,name:i,statusCode:r.status,message:r.status?r.status.toString():null};return n(a)}catch(e){return n(t)}}))},t}(),G=function(){function t(t){var e=t||{},n=e.UserPoolId,r=e.ClientId,i=e.endpoint,a=e.AdvancedSecurityDataCollectionFlag;if(!n||!r)throw new Error("Both UserPoolId and ClientId are required.");if(!/^[\w-]+_.+$/.test(n))throw new Error("Invalid UserPoolId format.");var o=n.split("_")[0];this.userPoolId=n,this.clientId=r,this.client=new K(o,i),this.advancedSecurityDataCollectionFlag=!1!==a,this.storage=t.Storage||(new z).getStorage()}var e=t.prototype;return e.getUserPoolId=function(){return this.userPoolId},e.getClientId=function(){return this.clientId},e.signUp=function(t,e,n,r,i,a){var o=this,s={ClientId:this.clientId,Username:t,Password:e,UserAttributes:n,ValidationData:r,ClientMetadata:a};this.getUserContextData(t)&&(s.UserContextData=this.getUserContextData(t)),this.client.request("SignUp",s,(function(e,n){if(e)return i(e,null);var r={Username:t,Pool:o,Storage:o.storage},a={user:new q(r),userConfirmed:n.UserConfirmed,userSub:n.UserSub,codeDeliveryDetails:n.CodeDeliveryDetails};return i(null,a)}))},e.getCurrentUser=function(){var t="CognitoIdentityServiceProvider."+this.clientId+".LastAuthUser",e=this.storage.getItem(t);if(e){var n={Username:e,Pool:this,Storage:this.storage};return new q(n)}return null},e.getUserContextData=function(t){if("undefined"!=typeof AmazonCognitoAdvancedSecurityData){var e=AmazonCognitoAdvancedSecurityData;if(this.advancedSecurityDataCollectionFlag){var n=e.getData(t,this.userPoolId,this.clientId);if(n)return{EncodedData:n}}return{}}},t}(),X=(n(3),n(19)),J=n.n(X);
/*!
 * Copyright 2016 Amazon.com,
 * Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the
 * License. A copy of the License is located at
 *
 *     http://aws.amazon.com/asl/
 *
 * or in the "license" file accompanying this file. This file is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, express or implied. See the License
 * for the specific language governing permissions and
 * limitations under the License.
 */const Z=function(t,e,n){var r;function i(){var i,a;n.userAgent.match(/ipad|iphone/i)?((i=e.createRange()).selectNodeContents(r),(a=t.getSelection()).removeAllRanges(),a.addRange(i),r.setSelectionRange(0,999999)):r.select()}return{copy:function(t){!function(t){(r=e.createElement("textArea")).value=t,e.body.appendChild(r)}(t),i(),e.execCommand("copy"),e.body.removeChild(r)}}}(window,document,navigator);var Q=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},tt=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Q(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}};var et=tt(Q),nt=et.right,rt=(et.left,nt),it=function(t,e){var n,r,i,a=-1,o=t.length;if(null==e){for(;++a<o;)if(null!=(r=t[a])&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=t[a])&&(n>r&&(n=r),i<r&&(i=r))}else{for(;++a<o;)if(null!=(r=e(t[a],a,t))&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=e(t[a],a,t))&&(n>r&&(n=r),i<r&&(i=r))}return[n,i]},at=Array.prototype,ot=(at.slice,at.map,function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}),st=Math.sqrt(50),ct=Math.sqrt(10),ut=Math.sqrt(2),ft=function(t,e,n){var r=lt(t,e,n);return ot(Math.ceil(t/r)*r,Math.floor(e/r)*r+r/2,r)};function lt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=st?i*=10:a>=ct?i*=5:a>=ut&&(i*=2),e<t?-i:i}var ht=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&r>n&&(n=r)}return n},dt=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&n>r&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&n>r&&(n=r)}return n},pt=function(t,e){var n,r=0,i=t.length,a=-1;if(null==e)for(;++a<i;)(n=+t[a])&&(r+=n);else for(;++a<i;)(n=+e(t[a],a,t))&&(r+=n);return r};var gt=Array.prototype.slice,mt=function(t){return t};function vt(t){return"translate("+(t+.5)+",0)"}function bt(t){return"translate(0,"+(t+.5)+")"}function yt(t){return function(e){return+t(e)}}function wt(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function _t(){return!this.__axis}function xt(t,e){var n=[],r=null,i=null,a=6,o=6,s=3,c=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",f=1===t||3===t?vt:bt;function l(l){var h=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,d=null==i?e.tickFormat?e.tickFormat.apply(e,n):mt:i,p=Math.max(a,0)+s,g=e.range(),m=+g[0]+.5,v=+g[g.length-1]+.5,b=(e.bandwidth?wt:yt)(e.copy()),y=l.selection?l.selection():l,w=y.selectAll(".domain").data([null]),_=y.selectAll(".tick").data(h,e).order(),x=_.exit(),C=_.enter().append("g").attr("class","tick"),A=_.select("line"),S=_.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(C),A=A.merge(C.append("line").attr("stroke","currentColor").attr(u+"2",c*a)),S=S.merge(C.append("text").attr("fill","currentColor").attr(u,c*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),l!==y&&(w=w.transition(l),_=_.transition(l),A=A.transition(l),S=S.transition(l),x=x.transition(l).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=b(t))?f(t):this.getAttribute("transform")})),C.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return f(e&&isFinite(e=e(t))?e:b(t))}))),x.remove(),w.attr("d",4===t||2==t?o?"M"+c*o+","+m+"H0.5V"+v+"H"+c*o:"M0.5,"+m+"V"+v:o?"M"+m+","+c*o+"V0.5H"+v+"V"+c*o:"M"+m+",0.5H"+v),_.attr("opacity",1).attr("transform",(function(t){return f(b(t))})),A.attr(u+"2",c*a),S.attr(u,c*p).text(d),y.filter(_t).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),y.each((function(){this.__axis=b}))}return l.scale=function(t){return arguments.length?(e=t,l):e},l.ticks=function(){return n=gt.call(arguments),l},l.tickArguments=function(t){return arguments.length?(n=null==t?[]:gt.call(t),l):n.slice()},l.tickValues=function(t){return arguments.length?(r=null==t?null:gt.call(t),l):r&&r.slice()},l.tickFormat=function(t){return arguments.length?(i=t,l):i},l.tickSize=function(t){return arguments.length?(a=o=+t,l):a},l.tickSizeInner=function(t){return arguments.length?(a=+t,l):a},l.tickSizeOuter=function(t){return arguments.length?(o=+t,l):o},l.tickPadding=function(t){return arguments.length?(s=+t,l):s},l}function Ct(t){return xt(3,t)}function At(t){return xt(4,t)}var St={value:function(){}};function Tt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new Mt(r)}function Mt(t){this._=t}function Et(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function kt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Ut(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=St,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Mt.prototype=Tt.prototype={constructor:Mt,on:function(t,e){var n,r=this._,i=Et(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=Ut(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ut(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=kt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Mt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var Dt=Tt,Pt="http://www.w3.org/1999/xhtml",It={svg:"http://www.w3.org/2000/svg",xhtml:Pt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Rt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),It.hasOwnProperty(e)?{space:It[e],local:t}:t};function Nt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Pt&&e.documentElement.namespaceURI===Pt?e.createElement(t):e.createElementNS(n,t)}}function Bt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var Ft=function(t){var e=Rt(t);return(e.local?Bt:Nt)(e)},Ot=0;function Lt(){this._="@"+(++Ot).toString(36)}Lt.prototype=function(){return new Lt}.prototype={constructor:Lt,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var Vt=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var Ht=document.documentElement;if(!Ht.matches){var zt=Ht.webkitMatchesSelector||Ht.msMatchesSelector||Ht.mozMatchesSelector||Ht.oMatchesSelector;Vt=function(t){return function(){return zt.call(this,t)}}}}var $t=Vt,Yt={},qt=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Yt={mouseenter:"mouseover",mouseleave:"mouseout"}));function jt(t,e,n){return t=Wt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Wt(t,e,n){return function(r){var i=qt;qt=r;try{t.call(this,this.__data__,e,n)}finally{qt=i}}}function Kt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Gt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function Xt(t,e,n){var r=Yt.hasOwnProperty(t.type)?jt:Wt;return function(i,a,o){var s,c=this.__on,u=r(e,a,o);if(c)for(var f=0,l=c.length;f<l;++f)if((s=c[f]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},c?c.push(s):this.__on=[s]}}function Jt(t,e,n,r){var i=qt;t.sourceEvent=qt,qt=t;try{return e.apply(n,r)}finally{qt=i}}var Zt=function(){for(var t,e=qt;t=e.sourceEvent;)e=t;return e},Qt=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},te=function(t){var e=Zt();return e.changedTouches&&(e=e.changedTouches[0]),Qt(t,e)};function ee(){}var ne=function(t){return null==t?ee:function(){return this.querySelector(t)}};function re(){return[]}var ie=function(t){return null==t?re:function(){return this.querySelectorAll(t)}},ae=function(t){return new Array(t.length)};function oe(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}oe.prototype={constructor:oe,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function se(t,e,n,r,i,a){for(var o,s=0,c=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new oe(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function ce(t,e,n,r,i,a,o){var s,c,u,f={},l=e.length,h=a.length,d=new Array(l);for(s=0;s<l;++s)(c=e[s])&&(d[s]=u="$"+o.call(c,c.__data__,s,e),u in f?i[s]=c:f[u]=c);for(s=0;s<h;++s)(c=f[u="$"+o.call(t,a[s],s,a)])?(r[s]=c,c.__data__=a[s],f[u]=null):n[s]=new oe(t,a[s]);for(s=0;s<l;++s)(c=e[s])&&f[d[s]]===c&&(i[s]=c)}function ue(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function fe(t){return function(){this.removeAttribute(t)}}function le(t){return function(){this.removeAttributeNS(t.space,t.local)}}function he(t,e){return function(){this.setAttribute(t,e)}}function de(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function pe(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function ge(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var me=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function ve(t){return function(){this.style.removeProperty(t)}}function be(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ye(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function we(t){return function(){delete this[t]}}function _e(t,e){return function(){this[t]=e}}function xe(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Ce(t){return t.trim().split(/^|\s+/)}function Ae(t){return t.classList||new Se(t)}function Se(t){this._node=t,this._names=Ce(t.getAttribute("class")||"")}function Te(t,e){for(var n=Ae(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Me(t,e){for(var n=Ae(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Ee(t){return function(){Te(this,t)}}function ke(t){return function(){Me(this,t)}}function Ue(t,e){return function(){(e.apply(this,arguments)?Te:Me)(this,t)}}Se.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function De(){this.textContent=""}function Pe(t){return function(){this.textContent=t}}function Ie(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Re(){this.innerHTML=""}function Ne(t){return function(){this.innerHTML=t}}function Be(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Fe(){this.nextSibling&&this.parentNode.appendChild(this)}function Oe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Le(){return null}function Ve(){var t=this.parentNode;t&&t.removeChild(this)}function He(t,e,n){var r=me(t),i=r.CustomEvent;i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ze(t,e){return function(){return He(this,t,e)}}function $e(t,e){return function(){return He(this,t,e.apply(this,arguments))}}var Ye=[null];function qe(t,e){this._groups=t,this._parents=e}function je(){return new qe([[document.documentElement]],Ye)}qe.prototype=je.prototype={constructor:qe,select:function(t){"function"!=typeof t&&(t=ne(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],c=s.length,u=r[i]=new Array(c),f=0;f<c;++f)(a=s[f])&&(o=t.call(a,a.__data__,f,s))&&("__data__"in a&&(o.__data__=a.__data__),u[f]=o);return new qe(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=ie(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],c=s.length,u=0;u<c;++u)(o=s[u])&&(r.push(t.call(o,o.__data__,u,s)),i.push(o));return new qe(r,i)},filter:function(t){"function"!=typeof t&&(t=$t(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new qe(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),f=-1,this.each((function(t){p[++f]=t})),p;var n,r=e?ce:se,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),c=new Array(o),u=new Array(o),f=0;f<o;++f){var l=i[f],h=a[f],d=h.length,p=t.call(l,l&&l.__data__,f,i),g=p.length,m=c[f]=new Array(g),v=s[f]=new Array(g);r(l,h,m,v,u[f]=new Array(d),p,e);for(var b,y,w=0,_=0;w<g;++w)if(b=m[w]){for(w>=_&&(_=w+1);!(y=v[_])&&++_<g;);b._next=y||null}}return(s=new qe(s,i))._enter=c,s._exit=u,s},enter:function(){return new qe(this._enter||this._groups.map(ae),this._parents)},exit:function(){return new qe(this._exit||this._groups.map(ae),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,u=e[s],f=n[s],l=u.length,h=o[s]=new Array(l),d=0;d<l;++d)(c=u[d]||f[d])&&(h[d]=c);for(;s<r;++s)o[s]=e[s];return new qe(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=ue);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],c=s.length,u=i[a]=new Array(c),f=0;f<c;++f)(o=s[f])&&(u[f]=o);u.sort(e)}return new qe(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=Rt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?le:fe:"function"==typeof e?n.local?ge:pe:n.local?de:he)(n,e))},style:function(t,e,n){var r;return arguments.length>1?this.each((null==e?ve:"function"==typeof e?ye:be)(t,e,null==n?"":n)):me(r=this.node()).getComputedStyle(r,null).getPropertyValue(t)},property:function(t,e){return arguments.length>1?this.each((null==e?we:"function"==typeof e?xe:_e)(t,e)):this.node()[t]},classed:function(t,e){var n=Ce(t+"");if(arguments.length<2){for(var r=Ae(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Ue:e?Ee:ke)(n,e))},text:function(t){return arguments.length?this.each(null==t?De:("function"==typeof t?Ie:Pe)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Re:("function"==typeof t?Be:Ne)(t)):this.node().innerHTML},raise:function(){return this.each(Fe)},lower:function(){return this.each(Oe)},append:function(t){var e="function"==typeof t?t:Ft(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Ft(t),r=null==e?Le:"function"==typeof e?e:ne(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ve)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=Kt(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?Xt:Gt,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var c,u=0,f=s.length;u<f;++u)for(r=0,c=s[u];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?$e:ze)(t,e))}};var We=je,Ke=function(t){return"string"==typeof t?new qe([[document.querySelector(t)]],[document.documentElement]):new qe([[t]],Ye)},Ge=function(t,e,n){arguments.length<3&&(n=e,e=Zt().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return Qt(t,r);return null};var Xe=function(){qt.preventDefault(),qt.stopImmediatePropagation()},Je=function(t){var e=t.document.documentElement,n=Ke(t).on("dragstart.drag",Xe,!0);"onselectstart"in e?n.on("selectstart.drag",Xe,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function Ze(t,e){var n=t.document.documentElement,r=Ke(t).on("dragstart.drag",null);e&&(r.on("click.drag",Xe,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Qe=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function tn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function en(){}var nn="\\s*([+-]?\\d+)\\s*",rn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",an="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",on=/^#([0-9a-f]{3,8})$/,sn=new RegExp("^rgb\\("+[nn,nn,nn]+"\\)$"),cn=new RegExp("^rgb\\("+[an,an,an]+"\\)$"),un=new RegExp("^rgba\\("+[nn,nn,nn,rn]+"\\)$"),fn=new RegExp("^rgba\\("+[an,an,an,rn]+"\\)$"),ln=new RegExp("^hsl\\("+[rn,an,an]+"\\)$"),hn=new RegExp("^hsla\\("+[rn,an,an,rn]+"\\)$"),dn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function pn(){return this.rgb().formatHex()}function gn(){return this.rgb().formatRgb()}function mn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=on.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?vn(e):3===n?new _n(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new _n(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new _n(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=sn.exec(t))?new _n(e[1],e[2],e[3],1):(e=cn.exec(t))?new _n(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=un.exec(t))?bn(e[1],e[2],e[3],e[4]):(e=fn.exec(t))?bn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ln.exec(t))?Sn(e[1],e[2]/100,e[3]/100,1):(e=hn.exec(t))?Sn(e[1],e[2]/100,e[3]/100,e[4]):dn.hasOwnProperty(t)?vn(dn[t]):"transparent"===t?new _n(NaN,NaN,NaN,0):null}function vn(t){return new _n(t>>16&255,t>>8&255,255&t,1)}function bn(t,e,n,r){return r<=0&&(t=e=n=NaN),new _n(t,e,n,r)}function yn(t){return t instanceof en||(t=mn(t)),t?new _n((t=t.rgb()).r,t.g,t.b,t.opacity):new _n}function wn(t,e,n,r){return 1===arguments.length?yn(t):new _n(t,e,n,null==r?1:r)}function _n(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function xn(){return"#"+An(this.r)+An(this.g)+An(this.b)}function Cn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function An(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Sn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mn(t,e,n,r)}function Tn(t){if(t instanceof Mn)return new Mn(t.h,t.s,t.l,t.opacity);if(t instanceof en||(t=mn(t)),!t)return new Mn;if(t instanceof Mn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Mn(o,s,c,t.opacity)}function Mn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function En(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function kn(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}Qe(en,mn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:pn,formatHex:pn,formatHsl:function(){return Tn(this).formatHsl()},formatRgb:gn,toString:gn}),Qe(_n,wn,tn(en,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new _n(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new _n(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xn,formatHex:xn,formatRgb:Cn,toString:Cn})),Qe(Mn,(function(t,e,n,r){return 1===arguments.length?Tn(t):new Mn(t,e,n,null==r?1:r)}),tn(en,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Mn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Mn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new _n(En(t>=240?t-240:t+120,i,r),En(t,i,r),En(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Un=function(t){return function(){return t}};function Dn(t,e){return function(n){return t+n*e}}function Pn(t){return 1==(t=+t)?In:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Un(isNaN(e)?n:e)}}function In(t,e){var n=e-t;return n?Dn(t,n):Un(isNaN(t)?e:t)}var Rn=function t(e){var n=Pn(e);function r(t,e){var r=n((t=wn(t)).r,(e=wn(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=In(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Nn(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=wn(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}Nn((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return kn((n-r/e)*e,o,i,a,s)}})),Nn((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return kn((n-r/e)*e,i,a,o,s)}}));var Bn=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}};function Fn(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function On(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Wn(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}var Ln=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},Vn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Hn=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Wn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},zn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$n=new RegExp(zn.source,"g");var Yn,qn,jn=function(t,e){var n,r,i,a=zn.lastIndex=$n.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=zn.exec(t))&&(r=$n.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Vn(n,r)})),a=$n.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})},Wn=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Un(e):("number"===r?Vn:"string"===r?(n=mn(e))?(e=n,Rn):jn:e instanceof mn?Rn:e instanceof Date?Ln:Fn(e)?Bn:Array.isArray(e)?On:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Hn:Vn)(t,e)},Kn=0,Gn=0,Xn=0,Jn=0,Zn=0,Qn=0,tr="object"==typeof performance&&performance.now?performance:Date,er="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function nr(){return Zn||(er(rr),Zn=tr.now()+Qn)}function rr(){Zn=0}function ir(){this._call=this._time=this._next=null}function ar(t,e,n){var r=new ir;return r.restart(t,e,n),r}function or(){Zn=(Jn=tr.now())+Qn,Kn=Gn=0;try{!function(){nr(),++Kn;for(var t,e=Yn;e;)(t=Zn-e._time)>=0&&e._call.call(null,t),e=e._next;--Kn}()}finally{Kn=0,function(){var t,e,n=Yn,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Yn=e);qn=t,cr(r)}(),Zn=0}}function sr(){var t=tr.now(),e=t-Jn;e>1e3&&(Qn-=e,Jn=t)}function cr(t){Kn||(Gn&&(Gn=clearTimeout(Gn)),t-Zn>24?(t<1/0&&(Gn=setTimeout(or,t-tr.now()-Qn)),Xn&&(Xn=clearInterval(Xn))):(Xn||(Jn=tr.now(),Xn=setInterval(sr,1e3)),Kn=1,er(or)))}ir.prototype=ar.prototype={constructor:ir,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?nr():+n)+(null==e?0:+e),this._next||qn===this||(qn?qn._next=this:Yn=this,qn=this),this._call=t,this._time=n,cr()},stop:function(){this._call&&(this._call=null,this._time=1/0,cr())}};var ur=function(t,e,n){var r=new ir;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},fr=Dt("start","end","interrupt"),lr=[],hr=function(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(c){var u,f,l,h;if(1!==n.state)return s();for(u in i)if((h=i[u]).name===n.name){if(3===h.state)return ur(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[u]):+u<e&&(h.state=6,h.timer.stop(),delete i[u])}if(ur((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(c))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(l=n.tween.length),u=0,f=-1;u<l;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=h);r.length=f+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(null,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=ar((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:fr,tween:lr,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})};function dr(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>0)throw new Error("too late");return n}function pr(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>2)throw new Error("too late");return n}function gr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("too late");return n}var mr,vr,br,yr,wr=function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}},_r=180/Math.PI,xr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Cr=function(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*_r,skewX:Math.atan(c)*_r,scaleX:o,scaleY:s}};function Ar(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:Vn(t,i)},{i:c-2,x:Vn(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Vn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Vn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Vn(t,n)},{i:s-2,x:Vn(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var Sr=Ar((function(t){return"none"===t?xr:(mr||(mr=document.createElement("DIV"),vr=document.documentElement,br=document.defaultView),mr.style.transform=t,t=br.getComputedStyle(vr.appendChild(mr),null).getPropertyValue("transform"),vr.removeChild(mr),t=t.slice(7,-1).split(","),Cr(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),Tr=Ar((function(t){return null==t?xr:(yr||(yr=document.createElementNS("http://www.w3.org/2000/svg","g")),yr.setAttribute("transform",t),(t=yr.transform.baseVal.consolidate())?(t=t.matrix,Cr(t.a,t.b,t.c,t.d,t.e,t.f)):xr)}),", ",")",")");function Mr(t,e){var n,r;return function(){var i=pr(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function Er(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=pr(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===e){i[c]=s;break}c===u&&i.push(s)}a.tween=i}}function kr(t,e,n){var r=t._id;return t.each((function(){var t=pr(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return gr(t,r).value[e]}}var Ur=function(t,e){var n;return("number"==typeof e?Vn:e instanceof mn?Rn:(n=mn(e))?(e=n,Rn):jn)(t,e)};function Dr(t){return function(){this.removeAttribute(t)}}function Pr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ir(t,e,n){var r,i;return function(){var a=this.getAttribute(t);return a===n?null:a===r?i:i=e(r=a,n)}}function Rr(t,e,n){var r,i;return function(){var a=this.getAttributeNS(t.space,t.local);return a===n?null:a===r?i:i=e(r=a,n)}}function Nr(t,e,n){var r,i,a;return function(){var o,s=n(this);if(null!=s)return(o=this.getAttribute(t))===s?null:o===r&&s===i?a:a=e(r=o,i=s);this.removeAttribute(t)}}function Br(t,e,n){var r,i,a;return function(){var o,s=n(this);if(null!=s)return(o=this.getAttributeNS(t.space,t.local))===s?null:o===r&&s===i?a:a=e(r=o,i=s);this.removeAttributeNS(t.space,t.local)}}function Fr(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}function Or(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n}function Lr(t,e){return function(){dr(this,t).delay=+e.apply(this,arguments)}}function Vr(t,e){return e=+e,function(){dr(this,t).delay=e}}function Hr(t,e){return function(){pr(this,t).duration=+e.apply(this,arguments)}}function zr(t,e){return e=+e,function(){pr(this,t).duration=e}}function $r(t,e){if("function"!=typeof e)throw new Error;return function(){pr(this,t).ease=e}}function Yr(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?dr:pr;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}var qr=We.prototype.constructor;function jr(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}var Wr=0;function Kr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Gr(){return++Wr}var Xr=We.prototype;Kr.prototype=function(t){return We().transition(t)}.prototype={constructor:Kr,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ne(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,c,u=r[o],f=u.length,l=a[o]=new Array(f),h=0;h<f;++h)(s=u[h])&&(c=t.call(s,s.__data__,h,u))&&("__data__"in s&&(c.__data__=s.__data__),l[h]=c,hr(l[h],e,n,h,l,gr(s,n)));return new Kr(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ie(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c,u=r[s],f=u.length,l=0;l<f;++l)if(c=u[l]){for(var h,d=t.call(c,c.__data__,l,u),p=gr(c,n),g=0,m=d.length;g<m;++g)(h=d[g])&&hr(h,e,n,g,d,p);a.push(d),o.push(c)}return new Kr(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=$t(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new Kr(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,u=e[s],f=n[s],l=u.length,h=o[s]=new Array(l),d=0;d<l;++d)(c=u[d]||f[d])&&(h[d]=c);for(;s<r;++s)o[s]=e[s];return new Kr(o,this._parents,this._name,this._id)},selection:function(){return new qr(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Gr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,u=0;u<c;++u)if(o=s[u]){var f=gr(o,e);hr(o,t,n,u,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Kr(r,this._parents,t,n)},call:Xr.call,nodes:Xr.nodes,node:Xr.node,size:Xr.size,empty:Xr.empty,each:Xr.each,on:function(t,e){var n=this._id;return arguments.length<2?gr(this.node(),n).on.on(t):this.each(Yr(n,t,e))},attr:function(t,e){var n=Rt(t),r="transform"===n?Tr:Ur;return this.attrTween(t,"function"==typeof e?(n.local?Br:Nr)(n,r,kr(this,"attr."+t,e)):null==e?(n.local?Pr:Dr)(n):(n.local?Rr:Ir)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Rt(t);return this.tween(n,(r.local?Fr:Or)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Sr:Ur;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=me(this).getComputedStyle(this,null),o=a.getPropertyValue(t),s=(this.style.removeProperty(t),a.getPropertyValue(t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}(t,r)).on("end.style."+t,function(t){return function(){this.style.removeProperty(t)}}(t)):this.styleTween(t,"function"==typeof e?function(t,e,n){var r,i,a;return function(){var o=me(this).getComputedStyle(this,null),s=o.getPropertyValue(t),c=n(this);return null==c&&(this.style.removeProperty(t),c=o.getPropertyValue(t)),s===c?null:s===r&&c===i?a:a=e(r=s,i=c)}}(t,r,kr(this,"style."+t,e)):function(t,e,n){var r,i;return function(){var a=me(this).getComputedStyle(this,null).getPropertyValue(t);return a===n?null:a===r?i:i=e(r=a,n)}}(t,r,e),n)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,jr(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(kr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=gr(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?Mr:Er)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Lr:Vr)(e,t)):gr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Hr:zr)(e,t)):gr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each($r(e,t)):gr(this.node(),e).ease}};var Jr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Zr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Jr.time=nr(),Jr;return n}We.prototype.interrupt=function(t){return this.each((function(){wr(this,t)}))},We.prototype.transition=function(t){var e,n;t instanceof Kr?(e=t._id,t=t._name):(e=Gr(),(n=Jr).time=nr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,u=0;u<c;++u)(o=s[u])&&hr(o,t,e,u,s,n||Zr(o,e));return new Kr(r,this._parents,t,e)};function Qr(t){return[+t[0],+t[1]]}function ti(t){return[Qr(t[0]),Qr(t[1])]}["w","e"].map(ei),["n","s"].map(ei),["n","w","e","s","nw","ne","sw","se"].map(ei);function ei(t){return{type:t}}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var ni=Math.PI,ri=2*ni,ii=ri-1e-6;function ai(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function oi(){return new ai}ai.prototype=oi.prototype={constructor:ai,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,c=r-e,u=a-t,f=o-e,l=u*u+f*f;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(l>1e-6)if(Math.abs(f*s-c*u)>1e-6&&i){var h=n-a,d=r-o,p=s*s+c*c,g=h*h+d*d,m=Math.sqrt(p),v=Math.sqrt(l),b=i*Math.tan((ni-Math.acos((p+l-g)/(2*m*v)))/2),y=b/v,w=b/m;Math.abs(y-1)>1e-6&&(this._+="L"+(t+y*u)+","+(e+y*f)),this._+="A"+i+","+i+",0,0,"+ +(f*h>u*d)+","+(this._x1=t+w*s)+","+(this._y1=e+w*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=t+o,u=e+s,f=1^a,l=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+c+","+u),n&&(l<0&&(l=l%ri+ri),l>ii?this._+="A"+n+","+n+",0,1,"+f+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+f+","+(this._x1=c)+","+(this._y1=u):l>1e-6&&(this._+="A"+n+","+n+",0,"+ +(l>=ni)+","+f+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function si(){}function ci(t,e){var n=new si;if(t instanceof si)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}si.prototype=ci.prototype={constructor:si,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var ui=ci;function fi(){}var li=ui.prototype;function hi(t,e){var n=new fi;if(t instanceof fi)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}fi.prototype=hi.prototype={constructor:fi,has:li.has,add:function(t){return this["$"+(t+="")]=t,this},remove:li.remove,clear:li.clear,values:li.keys,size:li.size,empty:li.empty,each:li.each};var di=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};var pi,gi;1===(pi=di).length&&(gi=pi,pi=function(t,e){return di(gi(t),e)});var mi=Array.prototype;mi.slice,mi.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Array.prototype.slice;var vi={},bi={};function yi(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function wi(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function _i(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function xi(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+_i(-e,6):e>9999?"+"+_i(e,6):_i(e,4))+"-"+_i(t.getUTCMonth()+1,2)+"-"+_i(t.getUTCDate(),2)+(a?"T"+_i(n,2)+":"+_i(r,2)+":"+_i(i,2)+"."+_i(a,3)+"Z":i?"T"+_i(n,2)+":"+_i(r,2)+":"+_i(i,2)+"Z":r||n?"T"+_i(n,2)+":"+_i(r,2)+"Z":"")}var Ci=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,c=a<=0,u=!1;function f(){if(c)return bi;if(u)return u=!1,vi;var e,r,i=o;if(34===t.charCodeAt(i)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?c=!0:10===(r=t.charCodeAt(o++))?u=!0:13===r&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(r=t.charCodeAt(e=o++)))u=!0;else if(13===r)u=!0,10===t.charCodeAt(o)&&++o;else if(r!==n)continue;return t.slice(i,e)}return c=!0,t.slice(i,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(r=f())!==bi;){for(var l=[];r!==vi&&r!==bi;)l.push(r),r=f();e&&null==(l=e(l,s++))||i.push(l)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?xi(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=yi(t);return function(r,i){return e(n(r),i,t)}}(t,e):yi(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=wi(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=wi(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}},Ai=Ci(","),Si=Ai.parse,Ti=(Ai.parseRows,Ai.format,Ai.formatBody,Ai.formatRows,Ai.formatRow,Ai.formatValue,Ci("\t")),Mi=Ti.parse;Ti.parseRows,Ti.format,Ti.formatBody,Ti.formatRows,Ti.formatRow,Ti.formatValue;function Ei(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var ki=function(t,e){return fetch(t,e).then(Ei)};function Ui(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),ki(e,n).then((function(e){return t(e,r)}))}}var Di=Ui(Si);Ui(Mi);function Pi(t){return function(e,n){return ki(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}Pi("application/xml"),Pi("text/html"),Pi("image/svg+xml");function Ii(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,c,u,f,l,h,d=t._root,p={data:r},g=t._x0,m=t._y0,v=t._x1,b=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((u=e>=(a=(g+v)/2))?g=a:v=a,(f=n>=(o=(m+b)/2))?m=o:b=o,i=d,!(d=d[l=f<<1|u]))return i[l]=p,t;if(s=+t._x.call(null,d.data),c=+t._y.call(null,d.data),e===s&&n===c)return p.next=d,i?i[l]=p:t._root=p,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(u=e>=(a=(g+v)/2))?g=a:v=a,(f=n>=(o=(m+b)/2))?m=o:b=o}while((l=f<<1|u)==(h=(c>=o)<<1|s>=a));return i[h]=d,i[l]=p,t}var Ri=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function Ni(t){return t[0]}function Bi(t){return t[1]}function Fi(t,e,n){var r=new Oi(null==e?Ni:e,null==n?Bi:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Oi(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Li(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Vi=Fi.prototype=Oi.prototype;Vi.copy=function(){var t,e,n=new Oi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Li(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Li(e));return n},Vi.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Ii(this.cover(e,n),e,n,t)},Vi.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),c=1/0,u=1/0,f=-1/0,l=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<c&&(c=r),r>f&&(f=r),i<u&&(u=i),i>l&&(l=i));if(c>f||u>l)return this;for(this.cover(c,u).cover(f,l),n=0;n<a;++n)Ii(this,o[n],s[n],t[n]);return this},Vi.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,c=i-n,u=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=u,u=o,c*=2,s){case 0:i=n+c,a=r+c;break;case 1:n=i-c,a=r+c;break;case 2:i=n+c,r=a-c;break;case 3:n=i-c,r=a-c}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},Vi.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Vi.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Vi.find=function(t,e,n){var r,i,a,o,s,c,u,f=this._x0,l=this._y0,h=this._x1,d=this._y1,p=[],g=this._root;for(g&&p.push(new Ri(g,f,l,h,d)),null==n?n=1/0:(f=t-n,l=e-n,h=t+n,d=e+n,n*=n);c=p.pop();)if(!(!(g=c.node)||(i=c.x0)>h||(a=c.y0)>d||(o=c.x1)<f||(s=c.y1)<l))if(g.length){var m=(i+o)/2,v=(a+s)/2;p.push(new Ri(g[3],m,v,o,s),new Ri(g[2],i,v,m,s),new Ri(g[1],m,a,o,v),new Ri(g[0],i,a,m,v)),(u=(e>=v)<<1|t>=m)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=c)}else{var b=t-+this._x.call(null,g.data),y=e-+this._y.call(null,g.data),w=b*b+y*y;if(w<n){var _=Math.sqrt(n=w);f=t-_,l=e-_,h=t+_,d=e+_,r=g.data}}return r},Vi.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,c,u,f,l,h,d=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((u=a>=(s=(p+m)/2))?p=s:m=s,(f=o>=(c=(g+v)/2))?g=c:v=c,e=d,!(d=d[l=f<<1|u]))return this;if(!d.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(n=e,h=l)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[l]=i:delete e[l],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[h]=d:this._root=d),this):(this._root=i,this)},Vi.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Vi.root=function(){return this._root},Vi.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Vi.visit=function(t){var e,n,r,i,a,o,s=[],c=this._root;for(c&&s.push(new Ri(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&c.length){var u=(r+a)/2,f=(i+o)/2;(n=c[3])&&s.push(new Ri(n,u,f,a,o)),(n=c[2])&&s.push(new Ri(n,r,f,u,o)),(n=c[1])&&s.push(new Ri(n,u,i,a,f)),(n=c[0])&&s.push(new Ri(n,r,i,u,f))}return this},Vi.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Ri(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,c=e.x1,u=e.y1,f=(o+c)/2,l=(s+u)/2;(a=i[0])&&n.push(new Ri(a,o,s,f,l)),(a=i[1])&&n.push(new Ri(a,f,s,c,l)),(a=i[2])&&n.push(new Ri(a,o,l,f,u)),(a=i[3])&&n.push(new Ri(a,f,l,c,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Vi.x=function(t){return arguments.length?(this._x=t,this):this._x},Vi.y=function(t){return arguments.length?(this._y=t,this):this._y};Math.PI,Math.sqrt(5);var Hi,zi=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},$i=function(t){return(t=zi(Math.abs(t)))?t[1]:NaN},Yi=function(t,e){var n=zi(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},qi={"":function(t,e){t:for(var n,r=(t=t.toPrecision(e)).length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Yi(100*t,e)},r:Yi,s:function(t,e){var n=zi(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Hi=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+zi(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},ji=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,Wi=function(t){return new Ki(t)};function Ki(t){if(!(e=ji.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",o=!!e[5],s=e[6]&&+e[6],c=!!e[7],u=e[8]&&+e[8].slice(1),f=e[9]||"";"n"===f?(c=!0,f="g"):qi[f]||(f=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=o,this.width=s,this.comma=c,this.precision=u,this.type=f}Ki.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Gi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Xi(t){return t}var Ji,Zi,Qi,ta=function(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}):Xi,i=t.currency,a=t.decimal;function o(t){var e=(t=Wi(t)).fill,n=t.align,o=t.sign,s=t.symbol,c=t.zero,u=t.width,f=t.comma,l=t.precision,h=t.type,d="$"===s?i[0]:"#"===s&&/[boxX]/.test(h)?"0"+h.toLowerCase():"",p="$"===s?i[1]:/[%p]/.test(h)?"%":"",g=qi[h],m=!h||/[defgprs%]/.test(h);function v(t){var i,s,v,b=d,y=p;if("c"===h)y=g(t)+y,t="";else{var w=((t=+t)<0||1/t<0)&&(t*=-1,!0);if(t=g(t,l),w)for(i=-1,s=t.length,w=!1;++i<s;)if(48<(v=t.charCodeAt(i))&&v<58||"x"===h&&96<v&&v<103||"X"===h&&64<v&&v<71){w=!0;break}if(b=(w?"("===o?o:"-":"-"===o||"("===o?"":o)+b,y=y+("s"===h?Gi[8+Hi/3]:"")+(w&&"("===o?")":""),m)for(i=-1,s=t.length;++i<s;)if(48>(v=t.charCodeAt(i))||v>57){y=(46===v?a+t.slice(i+1):t.slice(i))+y,t=t.slice(0,i);break}}f&&!c&&(t=r(t,1/0));var _=b.length+t.length+y.length,x=_<u?new Array(u-_+1).join(e):"";switch(f&&c&&(t=r(x+t,x.length?u-y.length:1/0),x=""),n){case"<":return b+t+y+x;case"=":return b+x+t+y;case"^":return x.slice(0,_=x.length>>1)+b+t+y+x.slice(_)}return x+b+t+y}return l=null==l?h?6:12:/[gprs]/.test(h)?Math.max(1,Math.min(21,l)):Math.max(0,Math.min(20,l)),v.toString=function(){return t+""},v}return{format:o,formatPrefix:function(t,e){var n=o(((t=Wi(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor($i(e)/3))),i=Math.pow(10,-r),a=Gi[8+r/3];return function(t){return n(i*t)+a}}}};Ji=ta({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Zi=Ji.format,Qi=Ji.formatPrefix;var ea=function(t){return Math.max(0,-$i(Math.abs(t)))},na=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor($i(e)/3)))-$i(Math.abs(t)))},ra=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,$i(e)-$i(t))+1},ia=function(){return Math.random()},aa=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(ia),function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var a;if(null!=r)a=r,r=null;else do{r=2*e()-1,a=2*e()-1,i=r*r+a*a}while(!i||i>1);return t+n*a*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(ia)),oa=(function t(e){function n(){var t=aa.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(ia),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(ia)),sa=(function t(e){function n(t){var n=oa.source(e)(t);return function(){return n()/t}}return n.source=t,n}(ia),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(ia),function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}),ca=function(t){return 1===t.length&&(t=function(t){return function(e,n){return sa(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}};var ua=ca(sa),fa=ua.right,la=(ua.left,fa);var ha=Array.prototype,da=(ha.slice,ha.map,function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}),pa=Math.sqrt(50),ga=Math.sqrt(10),ma=Math.sqrt(2),va=function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=ba(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(t-s)/o;return r&&a.reverse(),a};function ba(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=pa?10:a>=ga?5:a>=ma?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=pa?10:a>=ga?5:a>=ma?2:1)}function ya(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=pa?i*=10:a>=ga?i*=5:a>=ma&&(i*=2),e<t?-i:i}function wa(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var _a=Array.prototype,xa=_a.map,Ca=_a.slice,Aa={name:"implicit"};function Sa(){var t=ui(),e=[],n=[],r=Aa;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==Aa)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=ui();for(var r,a,o=-1,s=n.length;++o<s;)t.has(a=(r=n[o])+"")||t.set(a,e.push(r));return i},i.range=function(t){return arguments.length?(n=Ca.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Sa(e,n).unknown(r)},wa.apply(i,arguments),i}function Ta(){var t,e,n=Sa().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,c=0,u=.5;function f(){var n=r().length,f=a[1]<a[0],l=a[f-0],h=a[1-f];t=(h-l)/Math.max(1,n-s+2*c),o&&(t=Math.floor(t)),l+=(h-l-t*(n-s))*u,e=t*(1-s),o&&(l=Math.round(l),e=Math.round(e));var d=da(n).map((function(e){return l+t*e}));return i(f?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),f()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],f()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,f()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,f()):o},n.padding=function(t){return arguments.length?(s=Math.min(1,c=+t),f()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),f()):s},n.paddingOuter=function(t){return arguments.length?(c=+t,f()):c},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),f()):u},n.copy=function(){return Ta(r(),a).round(o).paddingInner(s).paddingOuter(c).align(u)},wa.apply(f(),arguments)}var Ma=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},Ea=function(t){return+t},ka=[0,1];function Ua(t){return t}function Da(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Pa(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function Ia(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=Da(i,r),a=n(o,a)):(r=Da(r,i),a=n(a,o)),function(t){return a(r(t))}}function Ra(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Da(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=la(t,e,1,r)-1;return a[n](i[n](e))}}function Na(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ba(){var t,e,n,r,i,a,o=ka,s=ka,c=Wn,u=Ua;function f(){return r=Math.min(o.length,s.length)>2?Ra:Ia,i=a=null,l}function l(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),s,c)))(t(u(e)))}return l.invert=function(n){return u(e((a||(a=r(s,o.map(t),Vn)))(n)))},l.domain=function(t){return arguments.length?(o=xa.call(t,Ea),u===Ua||(u=Pa(o)),f()):o.slice()},l.range=function(t){return arguments.length?(s=Ca.call(t),f()):s.slice()},l.rangeRound=function(t){return s=Ca.call(t),c=Ma,f()},l.clamp=function(t){return arguments.length?(u=t?Pa(o):Ua,l):u!==Ua},l.interpolate=function(t){return arguments.length?(c=t,f()):c},l.unknown=function(t){return arguments.length?(n=t,l):n},function(n,r){return t=n,e=r,f()}}function Fa(t,e){return Ba()(t,e)}function Oa(t){var e=t.domain;return t.ticks=function(t){var n=e();return va(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var i,a=ya(t,e,n);switch((r=Wi(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=na(a,o))||(r.precision=i),Qi(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=ra(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=ea(a))||(r.precision=i-2*("%"===r.type))}return Zi(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,s=i[a],c=i[o];return c<s&&(r=s,s=c,c=r,r=a,a=o,o=r),(r=ba(s,c,n))>0?r=ba(s=Math.floor(s/r)*r,c=Math.ceil(c/r)*r,n):r<0&&(r=ba(s=Math.ceil(s*r)/r,c=Math.floor(c*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(c/r)*r,e(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(c*r)/r,e(i)),t},t}function La(){var t=Fa(Ua,Ua);return t.copy=function(){return Na(t,La())},wa.apply(t,arguments),Oa(t)}function Va(){var t,e=0,n=1,r=1,i=[.5],a=[0,1];function o(e){return e<=e?a[la(i,e,0,r)]:t}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return o}return o.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],s()):[e,n]},o.range=function(t){return arguments.length?(r=(a=Ca.call(t)).length-1,s()):a.slice()},o.invertExtent=function(t){var o=a.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return Va().domain([e,n]).range(a).unknown(t)},wa.apply(Oa(o),arguments)}var Ha=new Date,za=new Date;function $a(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return $a((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Ha.setTime(+e),za.setTime(+r),t(Ha),t(za),Math.floor(n(Ha,za))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Ya=$a((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Ya.every=function(t){return isFinite(t=Math.floor(t))&&t>0?$a((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var qa=Ya,ja=(Ya.range,$a((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));ja.range;function Wa(t){return $a((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Ka=Wa(0),Ga=Wa(1),Xa=Wa(2),Ja=Wa(3),Za=Wa(4),Qa=Wa(5),to=Wa(6),eo=(Ka.range,Ga.range,Xa.range,Ja.range,Za.range,Qa.range,to.range,$a((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),no=eo,ro=(eo.range,$a((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),io=(ro.range,$a((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),ao=(io.range,$a((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),oo=(ao.range,$a((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));oo.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?$a((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):oo:null};oo.range;function so(t){return $a((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var co=so(0),uo=so(1),fo=so(2),lo=so(3),ho=so(4),po=so(5),go=so(6),mo=(co.range,uo.range,fo.range,lo.range,ho.range,po.range,go.range,$a((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),vo=mo,bo=(mo.range,$a((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));bo.every=function(t){return isFinite(t=Math.floor(t))&&t>0?$a((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var yo=bo;bo.range;function wo(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function _o(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function xo(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Co,Ao={"-":"",_:" ",0:"0"},So=/^\s*\d+/,To=/^%/,Mo=/[\\^$*+?|[\]().{}]/g;function Eo(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function ko(t){return t.replace(Mo,"\\$&")}function Uo(t){return new RegExp("^(?:"+t.map(ko).join("|")+")","i")}function Do(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Po(t,e,n){var r=So.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Io(t,e,n){var r=So.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ro(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function No(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Bo(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Fo(t,e,n){var r=So.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Oo(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Lo(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Vo(t,e,n){var r=So.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Ho(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function zo(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function $o(t,e,n){var r=So.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Yo(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function qo(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function jo(t,e,n){var r=So.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Wo(t,e,n){var r=So.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Ko(t,e,n){var r=So.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Go(t,e,n){var r=To.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Xo(t,e,n){var r=So.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Jo(t,e,n){var r=So.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Zo(t,e){return Eo(t.getDate(),e,2)}function Qo(t,e){return Eo(t.getHours(),e,2)}function ts(t,e){return Eo(t.getHours()%12||12,e,2)}function es(t,e){return Eo(1+no.count(qa(t),t),e,3)}function ns(t,e){return Eo(t.getMilliseconds(),e,3)}function rs(t,e){return ns(t,e)+"000"}function is(t,e){return Eo(t.getMonth()+1,e,2)}function as(t,e){return Eo(t.getMinutes(),e,2)}function os(t,e){return Eo(t.getSeconds(),e,2)}function ss(t){var e=t.getDay();return 0===e?7:e}function cs(t,e){return Eo(Ka.count(qa(t)-1,t),e,2)}function us(t,e){var n=t.getDay();return t=n>=4||0===n?Za(t):Za.ceil(t),Eo(Za.count(qa(t),t)+(4===qa(t).getDay()),e,2)}function fs(t){return t.getDay()}function ls(t,e){return Eo(Ga.count(qa(t)-1,t),e,2)}function hs(t,e){return Eo(t.getFullYear()%100,e,2)}function ds(t,e){return Eo(t.getFullYear()%1e4,e,4)}function ps(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Eo(e/60|0,"0",2)+Eo(e%60,"0",2)}function gs(t,e){return Eo(t.getUTCDate(),e,2)}function ms(t,e){return Eo(t.getUTCHours(),e,2)}function vs(t,e){return Eo(t.getUTCHours()%12||12,e,2)}function bs(t,e){return Eo(1+vo.count(yo(t),t),e,3)}function ys(t,e){return Eo(t.getUTCMilliseconds(),e,3)}function ws(t,e){return ys(t,e)+"000"}function _s(t,e){return Eo(t.getUTCMonth()+1,e,2)}function xs(t,e){return Eo(t.getUTCMinutes(),e,2)}function Cs(t,e){return Eo(t.getUTCSeconds(),e,2)}function As(t){var e=t.getUTCDay();return 0===e?7:e}function Ss(t,e){return Eo(co.count(yo(t)-1,t),e,2)}function Ts(t,e){var n=t.getUTCDay();return t=n>=4||0===n?ho(t):ho.ceil(t),Eo(ho.count(yo(t),t)+(4===yo(t).getUTCDay()),e,2)}function Ms(t){return t.getUTCDay()}function Es(t,e){return Eo(uo.count(yo(t)-1,t),e,2)}function ks(t,e){return Eo(t.getUTCFullYear()%100,e,2)}function Us(t,e){return Eo(t.getUTCFullYear()%1e4,e,4)}function Ds(){return"+0000"}function Ps(){return"%"}function Is(t){return+t}function Rs(t){return Math.floor(+t/1e3)}!function(t){Co=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=Uo(i),f=Do(i),l=Uo(a),h=Do(a),d=Uo(o),p=Do(o),g=Uo(s),m=Do(s),v=Uo(c),b=Do(c),y={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Zo,e:Zo,f:rs,H:Qo,I:ts,j:es,L:ns,m:is,M:as,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Is,s:Rs,S:os,u:ss,U:cs,V:us,w:fs,W:ls,x:null,X:null,y:hs,Y:ds,Z:ps,"%":Ps},w={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:gs,e:gs,f:ws,H:ms,I:vs,j:bs,L:ys,m:_s,M:xs,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Is,s:Rs,S:Cs,u:As,U:Ss,V:Ts,w:Ms,W:Es,x:null,X:null,y:ks,Y:Us,Z:Ds,"%":Ps},_={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=b[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:zo,e:zo,f:Ko,H:Yo,I:Yo,j:$o,L:Wo,m:Ho,M:qo,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=f[r[0].toLowerCase()],n+r[0].length):-1},q:Vo,Q:Xo,s:Jo,S:jo,u:Io,U:Ro,V:No,w:Po,W:Bo,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:Oo,Y:Fo,Z:Lo,"%":Go};function x(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=Ao[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function C(t,e){return function(n){var r,i,a=xo(1900,void 0,1);if(A(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=_o(xo(a.y,0,1))).getUTCDay(),r=i>4||0===i?uo.ceil(r):uo(r),r=vo.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=wo(xo(a.y,0,1))).getDay(),r=i>4||0===i?Ga.ceil(r):Ga(r),r=no.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?_o(xo(a.y,0,1)).getUTCDay():wo(xo(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,_o(a)):wo(a)}}function A(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=_[i in Ao?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return y.x=x(n,y),y.X=x(r,y),y.c=x(e,y),w.x=x(n,w),w.X=x(r,w),w.c=x(e,w),{format:function(t){var e=x(t+="",y);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t+="",!0);return e.toString=function(){return t},e}}}(t),Co.format,Co.parse,Co.utcFormat,Co.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ns=$a((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),Bs=(Ns.range,$a((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),Fs=(Bs.range,$a((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})));Fs.range;function Os(){this._=null}function Ls(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Vs(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Hs(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function zs(t){for(;t.L;)t=t.L;return t}Os.prototype={constructor:Os,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=zs(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Vs(this,n),n=(t=n).U),n.C=!1,r.C=!0,Hs(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Hs(this,n),n=(t=n).U),n.C=!1,r.C=!0,Vs(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,a=t.L,o=t.R;if(n=a?o?zs(o):a:o,i?i.L===t?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=o,o.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Vs(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Hs(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Vs(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Hs(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Vs(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Hs(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var $s=Os;function Ys(t,e,n,r){var i=[null,null],a=pc.push(i)-1;return i.left=t,i.right=e,n&&js(i,t,e,n),r&&js(i,e,t,r),hc[t.index].halfedges.push(a),hc[e.index].halfedges.push(a),i}function qs(t,e,n){var r=[e,n];return r.left=t,r}function js(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Ws(t,e,n,r,i){var a,o=t[0],s=t[1],c=o[0],u=o[1],f=0,l=1,h=s[0]-c,d=s[1]-u;if(a=e-c,h||!(a>0)){if(a/=h,h<0){if(a<f)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>f&&(f=a)}if(a=r-c,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>f&&(f=a)}else if(h>0){if(a<f)return;a<l&&(l=a)}if(a=n-u,d||!(a>0)){if(a/=d,d<0){if(a<f)return;a<l&&(l=a)}else if(d>0){if(a>l)return;a>f&&(f=a)}if(a=i-u,d||!(a<0)){if(a/=d,d<0){if(a>l)return;a>f&&(f=a)}else if(d>0){if(a<f)return;a<l&&(l=a)}return!(f>0||l<1)||(f>0&&(t[0]=[c+f*h,u+f*d]),l<1&&(t[1]=[c+l*h,u+l*d]),!0)}}}}}function Ks(t,e,n,r,i){var a=t[1];if(a)return!0;var o,s,c=t[0],u=t.left,f=t.right,l=u[0],h=u[1],d=f[0],p=f[1],g=(l+d)/2,m=(h+p)/2;if(p===h){if(g<e||g>=r)return;if(l>d){if(c){if(c[1]>=i)return}else c=[g,n];a=[g,i]}else{if(c){if(c[1]<n)return}else c=[g,i];a=[g,n]}}else if(s=m-(o=(l-d)/(p-h))*g,o<-1||o>1)if(l>d){if(c){if(c[1]>=i)return}else c=[(n-s)/o,n];a=[(i-s)/o,i]}else{if(c){if(c[1]<n)return}else c=[(i-s)/o,i];a=[(n-s)/o,n]}else if(h<p){if(c){if(c[0]>=r)return}else c=[e,o*e+s];a=[r,o*r+s]}else{if(c){if(c[0]<e)return}else c=[r,o*r+s];a=[e,o*e+s]}return t[0]=c,t[1]=a,!0}function Gs(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Xs(t,e){return e[+(e.left!==t.site)]}function Js(t,e){return e[+(e.left===t.site)]}var Zs,Qs=[];function tc(){Ls(this),this.x=this.y=this.arc=this.site=this.cy=null}function ec(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,a=n.site;if(r!==a){var o=i[0],s=i[1],c=r[0]-o,u=r[1]-s,f=a[0]-o,l=a[1]-s,h=2*(c*l-u*f);if(!(h>=-mc)){var d=c*c+u*u,p=f*f+l*l,g=(l*d-u*p)/h,m=(c*p-f*d)/h,v=Qs.pop()||new tc;v.arc=t,v.site=i,v.x=g+o,v.y=(v.cy=m+s)+Math.sqrt(g*g+m*m),t.circle=v;for(var b=null,y=dc._;y;)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){b=y.P;break}y=y.L}else{if(!y.R){b=y;break}y=y.R}dc.insert(b,v),b||(Zs=v)}}}}function nc(t){var e=t.circle;e&&(e.P||(Zs=e.N),dc.remove(e),Qs.push(e),Ls(e),t.circle=null)}var rc=[];function ic(){Ls(this),this.edge=this.site=this.circle=null}function ac(t){var e=rc.pop()||new ic;return e.site=t,e}function oc(t){nc(t),lc.remove(t),rc.push(t),Ls(t)}function sc(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],a=t.P,o=t.N,s=[t];oc(t);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<gc&&Math.abs(r-c.circle.cy)<gc;)a=c.P,s.unshift(c),oc(c),c=a;s.unshift(c),nc(c);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<gc&&Math.abs(r-u.circle.cy)<gc;)o=u.N,s.push(u),oc(u),u=o;s.push(u),nc(u);var f,l=s.length;for(f=1;f<l;++f)u=s[f],c=s[f-1],js(u.edge,c.site,u.site,i);c=s[0],(u=s[l-1]).edge=Ys(c.site,u.site,null,i),ec(c),ec(u)}function cc(t){for(var e,n,r,i,a=t[0],o=t[1],s=lc._;s;)if((r=uc(s,o)-a)>gc)s=s.L;else{if(!((i=a-fc(s,o))>gc)){r>-gc?(e=s.P,n=s):i>-gc?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){hc[t.index]={site:t,halfedges:[]}}(t);var c=ac(t);if(lc.insert(e,c),e||n){if(e===n)return nc(e),n=ac(e.site),lc.insert(c,n),c.edge=n.edge=Ys(e.site,c.site),ec(e),void ec(n);if(n){nc(e),nc(n);var u=e.site,f=u[0],l=u[1],h=t[0]-f,d=t[1]-l,p=n.site,g=p[0]-f,m=p[1]-l,v=2*(h*m-d*g),b=h*h+d*d,y=g*g+m*m,w=[(m*b-d*y)/v+f,(h*y-g*b)/v+l];js(n.edge,u,p,w),c.edge=Ys(u,t,null,w),n.edge=Ys(t,p,null,w),ec(e),ec(n)}else c.edge=Ys(e.site,c.site)}}function uc(t,e){var n=t.site,r=n[0],i=n[1],a=i-e;if(!a)return r;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],c=n[1],u=c-e;if(!u)return s;var f=s-r,l=1/a-1/u,h=f/u;return l?(-h+Math.sqrt(h*h-2*l*(f*f/(-2*u)-c+u/2+i-a/2)))/l+r:(r+s)/2}function fc(t,e){var n=t.N;if(n)return uc(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var lc,hc,dc,pc,gc=1e-6,mc=1e-12;function vc(t,e){return e[1]-t[1]||e[0]-t[0]}function bc(t,e){var n,r,i,a=t.sort(vc).pop();for(pc=[],hc=new Array(t.length),lc=new $s,dc=new $s;;)if(i=Zs,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===n&&a[1]===r||(cc(a),n=a[0],r=a[1]),a=t.pop();else{if(!i)break;sc(i.arc)}if(function(){for(var t,e,n,r,i=0,a=hc.length;i<a;++i)if((t=hc[i])&&(r=(e=t.halfedges).length)){var o=new Array(r),s=new Array(r);for(n=0;n<r;++n)o[n]=n,s[n]=Gs(t,pc[e[n]]);for(o.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[o[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var o=+e[0][0],s=+e[0][1],c=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,a=pc.length;a--;)Ks(i=pc[a],t,e,n,r)&&Ws(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>gc||Math.abs(i[0][1]-i[1][1])>gc)||delete pc[a]}(o,s,c,u),function(t,e,n,r){var i,a,o,s,c,u,f,l,h,d,p,g,m=hc.length,v=!0;for(i=0;i<m;++i)if(a=hc[i]){for(o=a.site,s=(c=a.halfedges).length;s--;)pc[c[s]]||c.splice(s,1);for(s=0,u=c.length;s<u;)p=(d=Js(a,pc[c[s]]))[0],g=d[1],l=(f=Xs(a,pc[c[++s%u]]))[0],h=f[1],(Math.abs(p-l)>gc||Math.abs(g-h)>gc)&&(c.splice(s,0,pc.push(qs(o,d,Math.abs(p-t)<gc&&r-g>gc?[t,Math.abs(l-t)<gc?h:r]:Math.abs(g-r)<gc&&n-p>gc?[Math.abs(h-r)<gc?l:n,r]:Math.abs(p-n)<gc&&g-e>gc?[n,Math.abs(l-n)<gc?h:e]:Math.abs(g-e)<gc&&p-t>gc?[Math.abs(h-e)<gc?l:t,e]:null))-1),++u);u&&(v=!1)}if(v){var b,y,w,_=1/0;for(i=0,v=null;i<m;++i)(a=hc[i])&&(w=(b=(o=a.site)[0]-t)*b+(y=o[1]-e)*y)<_&&(_=w,v=a);if(v){var x=[t,e],C=[t,r],A=[n,r],S=[n,e];v.halfedges.push(pc.push(qs(o=v.site,x,C))-1,pc.push(qs(o,C,A))-1,pc.push(qs(o,A,S))-1,pc.push(qs(o,S,x))-1)}}for(i=0;i<m;++i)(a=hc[i])&&(a.halfedges.length||delete hc[i])}(o,s,c,u)}this.edges=pc,this.cells=hc,lc=dc=pc=hc=null}bc.prototype={constructor:bc,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Xs(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(a=(i=n.halfedges).length)for(var i,a,o,s,c,u,f=n.site,l=-1,h=e[i[a-1]],d=h.left===f?h.right:h.left;++l<a;)o=d,d=(h=e[i[l]]).left===f?h.right:h.left,o&&d&&r<o.index&&r<d.index&&(c=o,u=d,((s=f)[0]-u[0])*(c[1]-s[1])-(s[0]-c[0])*(u[1]-s[1])<0)&&t.push([f.data,o.data,d.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,a=this,o=a._found||0,s=a.cells.length;!(i=a.cells[o]);)if(++o>=s)return null;var c=t-i.site[0],u=e-i.site[1],f=c*c+u*u;do{i=a.cells[r=o],o=null,i.halfedges.forEach((function(n){var r=a.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var c=t-s[0],u=e-s[1],l=c*c+u*u;l<f&&(f=l,o=s.index)}}))}while(null!==o);return a._found=r,null==n||f<=n*n?i.site:null}};var yc=Math.SQRT2;function wc(t){return((t=Math.exp(t))+1/t)/2}var _c=function(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],c=e[1],u=e[2],f=s-i,l=c-a,h=f*f+l*l;if(h<1e-12)r=Math.log(u/o)/yc,n=function(t){return[i+t*f,a+t*l,o*Math.exp(yc*t*r)]};else{var d=Math.sqrt(h),p=(u*u-o*o+4*h)/(2*o*2*d),g=(u*u-o*o-4*h)/(2*u*2*d),m=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(g*g+1)-g);r=(v-m)/yc,n=function(t){var e,n=t*r,s=wc(m),c=o/(2*d)*(s*(e=yc*n+m,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[i+c*f,a+c*l,o*s/wc(yc*n+m)]}}return n.duration=1e3*r,n},xc=function(t){return function(){return t}};function Cc(t,e,n){this.target=t,this.type=e,this.transform=n}function Ac(t,e,n){this.k=t,this.x=e,this.y=n}Ac.prototype={constructor:Ac,scale:function(t){return 1===t?this:new Ac(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Ac(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Sc=new Ac(1,0,0);function Tc(){qt.stopImmediatePropagation()}Ac.prototype;var Mc=function(){qt.preventDefault(),qt.stopImmediatePropagation()};function Ec(){return!qt.ctrlKey&&!qt.button}function kc(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Uc(){return this.__zoom||Sc}function Dc(){return-qt.deltaY*(1===qt.deltaMode?.05:qt.deltaMode?1:.002)}function Pc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ic(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}var Rc=Array.prototype,Nc=Rc.map,Bc=Rc.slice;var Fc=function(t){return function(){return t}},Oc=function(t){return+t},Lc=[0,1];function Vc(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Fc(e)}function Hc(t,e,n,r){var i=t[0],a=t[1],o=e[0],s=e[1];return a<i?(i=n(a,i),o=r(s,o)):(i=n(i,a),o=r(o,s)),function(t){return o(i(t))}}function zc(t,e,n,r){var i=Math.min(t.length,e.length)-1,a=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)a[s]=n(t[s],t[s+1]),o[s]=r(e[s],e[s+1]);return function(e){var n=rt(t,e,1,i)-1;return o[n](a[n](e))}}function $c(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function Yc(t,e){var n,r,i,a=Lc,o=Lc,s=Wn,c=!1;function u(){return n=Math.min(a.length,o.length)>2?zc:Hc,r=i=null,f}function f(e){return(r||(r=n(a,o,c?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,s)))(+e)}return f.invert=function(t){return(i||(i=n(o,a,Vc,c?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},f.domain=function(t){return arguments.length?(a=Nc.call(t,Oc),u()):a.slice()},f.range=function(t){return arguments.length?(o=Bc.call(t),u()):o.slice()},f.rangeRound=function(t){return o=Bc.call(t),s=Ma,u()},f.clamp=function(t){return arguments.length?(c=!!t,u()):c},f.interpolate=function(t){return arguments.length?(s=t,u()):s},u()}function qc(t){var e=t.domain;return t.ticks=function(t){var n=e();return ft(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return function(t,e,n){var r,i=t[0],a=t[t.length-1],o=lt(i,a,null==e?10:e);switch((n=Wi(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(a));return null!=n.precision||isNaN(r=na(o,s))||(n.precision=r),Qi(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=ra(o,Math.max(Math.abs(i),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=ea(o))||(n.precision=r-2*("%"===n.type))}return Zi(n)}(e(),t,n)},t.nice=function(n){var r=e(),i=r.length-1,a=null==n?10:n,o=r[0],s=r[i],c=lt(o,s,a);return c&&(c=lt(Math.floor(o/c)*c,Math.ceil(s/c)*c,a),r[0]=Math.floor(o/c)*c,r[i]=Math.ceil(s/c)*c,e(r)),t},t}function jc(){var t=Yc(Vc,Vn);return t.copy=function(){return $c(t,jc())},qc(t)}var Wc=function(t){return t.match(/.{6}/g).map((function(t){return"#"+t}))},Kc=(Wc("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Wc("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Wc("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Wc("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Math.PI/180),Gc=180/Math.PI,Xc=-.29227,Jc=-.90649,Zc=1.97294*Jc,Qc=3.5172982438,tu=-.6557636667999999;function eu(t){if(t instanceof ru)return new ru(t.h,t.s,t.l,t.opacity);t instanceof _n||(t=yn(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(tu*r+Zc*e-Qc*n)/(tu+Zc-Qc),a=r-i,o=(1.97294*(n-i)-Xc*a)/Jc,s=Math.sqrt(o*o+a*a)/(1.97294*i*(1-i)),c=s?Math.atan2(o,a)*Gc-120:NaN;return new ru(c<0?c+360:c,s,i,t.opacity)}function nu(t,e,n,r){return 1===arguments.length?eu(t):new ru(t,e,n,null==r?1:r)}function ru(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function iu(t){return function e(n){function r(e,r){var i=t((e=nu(e)).h,(r=nu(r)).h),a=In(e.s,r.s),o=In(e.l,r.l),s=In(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Qe(ru,nu,tn(en,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ru(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ru(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Kc,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new _n(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(Xc*r+Jc*i)),255*(e+n*(1.97294*r)),this.opacity)}}));iu((function(t,e){var n=e-t;return n?Dn(t,n>180||n<-180?n-360*Math.round(n/360):n):Un(isNaN(t)?e:t)}));var au=iu(In);au(nu(300,.5,0),nu(-240,.5,1)),au(nu(-100,.75,.35),nu(80,1.5,.8)),au(nu(260,.75,.35),nu(80,1.5,.8)),nu();function ou(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}ou(Wc("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ou(Wc("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ou(Wc("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ou(Wc("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));var su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu=function(t){return t},uu=function(t){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[r-n-1];return e},fu=function(t,e){t.each((function(){for(var t,n=Ke(this),r=n.text().split(/\s+/).reverse(),i=[],a=(n.attr("y"),parseFloat(n.attr("dy"))||0),o=n.text(null).append("tspan").attr("x",0).attr("dy",a+"em");t=r.pop();)i.push(t),o.text(i.join(" ")),o.node().getComputedTextLength()>e&&i.length>1&&(i.pop(),o.text(i.join(" ")),i=[t],o=n.append("tspan").attr("x",0).attr("dy",1.2+a+"em").text(t))}))},lu={d3_drawShapes:function(t,e,n,r,i,a){"rect"===t?e.attr("height",n).attr("width",r):"circle"===t?e.attr("r",i):"line"===t?e.attr("x1",0).attr("x2",r).attr("y1",0).attr("y2",0):"path"===t&&e.attr("d",a)},d3_addText:function(t,e,n,r,i){e.append("text").attr("class",r+"label");var a=t.selectAll("g."+r+"cell text."+r+"label").data(n).text(cu);return i&&t.selectAll("g."+r+"cell text."+r+"label").call(fu,i),a},d3_calcType:function(t,e,n,r,i,a){var o=t.invertExtent?function(t,e,n){var r=t.range().map((function(r){var i=t.invertExtent(r);return e(i[0])+" "+n+" "+e(i[1])}));return{data:t.range(),labels:r,feature:cu}}(t,i,a):t.ticks?function(t,e,n){var r=[];if(e.length>1)r=e;else for(var i=t.domain(),a=(i[i.length-1]-i[0])/(e-1),o=0;o<e;o++)r.push(i[0]+o*a);var s=r.map(n);return{data:r,labels:s,feature:function(e){return t(e)}}}(t,n,i):function(t){return{data:t.domain(),labels:t.domain(),feature:function(e){return t(e)}}}(t),s=t.range&&t.range()||t.domain();return o.labels=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[4];if("object"===(void 0===e?"undefined":su(e))){if(0===e.length)return t;for(var a=e.length;a<t.length;a++)e.push(t[a]);return e}if("function"==typeof e){for(var o=[],s=t.length,c=0;c<s;c++)o.push(e({i:c,genLength:s,generatedLabels:t,domain:n,range:r,labelDelimiter:i}));return o}return t}(o.labels,r,t.domain(),s,a),e&&(o.labels=uu(o.labels),o.data=uu(o.data)),o},d3_filterCells:function(t,e){var n=t.data.map((function(e,n){return{data:e,label:t.labels[n]}})).filter(e),r=n.map((function(t){return t.data})),i=n.map((function(t){return t.label}));return t.data=t.data.filter((function(t){return-1!==r.indexOf(t)})),t.labels=t.labels.filter((function(t){return-1!==i.indexOf(t)})),t},d3_placement:function(t,e,n,r,i,a){e.attr("transform",n),r.attr("transform",i),"horizontal"===t&&r.style("text-anchor",a)},d3_addEvents:function(t,e){t.on("mouseover.legend",(function(t){!function(t,e,n){t.call("cellover",n,e)}(e,t,this)})).on("mouseout.legend",(function(t){!function(t,e,n){t.call("cellout",n,e)}(e,t,this)})).on("click.legend",(function(t){!function(t,e,n){t.call("cellclick",n,e)}(e,t,this)}))},d3_title:function(t,e,n,r){if(""!==e){t.selectAll("text."+n+"legendTitle").data([e]).enter().append("text").attr("class",n+"legendTitle"),t.selectAll("text."+n+"legendTitle").text(e),r&&t.selectAll("text."+n+"legendTitle").call(fu,r);var i=t.select("."+n+"legendCells"),a=t.select("."+n+"legendTitle").nodes().map((function(t){return t.getBBox().height}))[0],o=-i.nodes().map((function(t){return t.getBBox().x}))[0];i.attr("transform","translate("+o+","+a+")")}},d3_defaultLocale:{format:Zi,formatPrefix:Qi},d3_defaultFormatSpecifier:".01f",d3_defaultDelimiter:"to"};function hu(){var t=jc(),e="rect",n=15,r=15,i=10,a=2,o=[5],s=void 0,c=[],u="",f=!1,l="",h=lu.d3_defaultLocale,d=lu.d3_defaultFormatSpecifier,p=10,g="middle",m=lu.d3_defaultDelimiter,v=void 0,b="vertical",y=!1,w=void 0,_=void 0,x=Dt("cellover","cellout","cellclick");function C(C){var A=lu.d3_calcType(t,y,o,c,h.format(d),m);C.selectAll("g").data([t]).enter().append("g").attr("class",u+"legendCells"),s&&lu.d3_filterCells(A,s);var S=C.select("."+u+"legendCells").selectAll("."+u+"cell").data(A.data),T=S.enter().append("g").attr("class",u+"cell");T.append(e).attr("class",u+"swatch");var M=C.selectAll("g."+u+"cell "+e+"."+u+"swatch").data(A.data);lu.d3_addEvents(T,x),S.exit().transition().style("opacity",0).remove(),M.exit().transition().style("opacity",0).remove(),M=M.merge(M),lu.d3_drawShapes(e,M,r,n,i,w);var E=lu.d3_addText(C,T,A.labels,u,v);S=T.merge(S);var k=E.nodes().map((function(t){return t.getBBox()})),U=M.nodes().map((function(t){return t.getBBox()}));f?M.attr("class",(function(t){return u+"swatch "+A.feature(t)})):"line"==e?M.style("stroke",A.feature):M.style("fill",A.feature);var D,P=void 0,I=void 0,R="start"==g?0:"middle"==g?.5:1;"vertical"===b?(D=k.map((function(t,e){return Math.max(t.height,U[e].height)})),P=function(t,e){return"translate(0, "+(pt(D.slice(0,e))+e*a)+")"},I=function(t,e){return"translate( "+(U[e].width+U[e].x+p)+", "+(U[e].y+U[e].height/2+5)+")"}):"horizontal"===b&&(P=function(t,e){return"translate("+e*(U[e].width+a)+",0)"},I=function(t,e){return"translate("+(U[e].width*R+U[e].x)+",\n          "+(U[e].height+U[e].y+p+8)+")"}),lu.d3_placement(b,S,P,E,I,g),lu.d3_title(C,l,u,_),S.transition().style("opacity",1)}return C.scale=function(e){return arguments.length?(t=e,C):t},C.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(o=t),C):o},C.cellFilter=function(t){return arguments.length?(s=t,C):s},C.shape=function(t,n){return arguments.length?(("rect"==t||"circle"==t||"line"==t||"path"==t&&"string"==typeof n)&&(e=t,w=n),C):e},C.shapeWidth=function(t){return arguments.length?(n=+t,C):n},C.shapeHeight=function(t){return arguments.length?(r=+t,C):r},C.shapeRadius=function(t){return arguments.length?(i=+t,C):i},C.shapePadding=function(t){return arguments.length?(a=+t,C):a},C.labels=function(t){return arguments.length?(c=t,C):c},C.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(g=t),C):g},C.locale=function(t){return arguments.length?(h=ta(t),C):h},C.labelFormat=function(t){return arguments.length?(d=Wi(t),C):C.locale().format(d)},C.labelOffset=function(t){return arguments.length?(p=+t,C):p},C.labelDelimiter=function(t){return arguments.length?(m=t,C):m},C.labelWrap=function(t){return arguments.length?(v=t,C):v},C.useClass=function(t){return arguments.length?(!0!==t&&!1!==t||(f=t),C):f},C.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(b=t),C):b},C.ascending=function(t){return arguments.length?(y=!!t,C):y},C.classPrefix=function(t){return arguments.length?(u=t,C):u},C.title=function(t){return arguments.length?(l=t,C):l},C.titleWidth=function(t){return arguments.length?(_=t,C):_},C.textWrap=function(t){return arguments.length?(textWrap=t,C):textWrap},C.on=function(){var t=x.on.apply(x,arguments);return t===x?C:t},C}var du=n(12),pu=n.n(du),gu={renderMatrix:function(t,e,n,r,i){var a=6;if(null!=n.colorTicks&&null!=n.colorTicks&&(a=n.colorTicks),"string"==typeof n||n instanceof String){console.log("shift datastructure due to old yaml matrix description.");var o=n;(n={}).data=o}return a=Math.max(3,Math.min(9,a)),Di(n.data).then((function(i){if(Ke("#matrix").empty()){var o={},s=Ke("#"+e).append("div").attr("id","tooltip_matrix").attr("class","tooltip").style("opacity",0),c=ui(i,(function(t){return t.ClustName})).keys();i.forEach((function(t){delete t[i.columns[0]]})),i.columns.shift(),o.max=Number.MIN_VALUE,o.min=Number.MAX_VALUE,i.forEach((function(t){var e=Object.values(t).map((function(t){return parseFloat(t)}));o.min=Math.min(o.min,dt(e)),o.max=Math.max(o.max,ht(e))})),o.margin={top:40,right:70,bottom:0,left:80},o.size=t.clientWidth,o.width=o.size-o.margin.left-o.margin.right,o.cellPadding=4,o.cellWidth=o.width/Object.keys(i[0]).length-o.cellPadding,o.cellHeight=o.cellWidth,o.height=i.length*(o.cellWidth+o.cellPadding)+o.margin.top+o.margin.bottom;var u=null;console.log(n.colormapInvert),u=null!=n.colormapInvert&&null!=n.colormapInvert&&n.colormapInvert?Va().domain([o.min,o.max]).range(pu.a.YlGnBu[a].reverse()):Va().domain([o.min,o.max]).range(pu.a.YlGnBu[a]),o.svg=Ke("#"+e).append("svg").attr("id","matrix").attr("width",o.width+o.margin.left+o.margin.right).attr("height",o.height+o.margin.top+o.margin.bottom).append("g").attr("transform","translate("+o.margin.left+","+o.margin.top+")");var f=o.svg.selectAll(".matrix-row").data(i,(function(t){return t})).enter().append("g").attr("class","matrix-row").attr("id",(function(t,e){return"matrixrow_"+e})).attr("transform",(function(t,e){return"translate(0,"+(o.cellHeight+o.cellPadding)*e+")"}));f.append("text").attr("class","matrix-label matrix-row-label").attr("x",-10).attr("y",o.cellHeight/2).attr("dy",".35em").attr("text-anchor","end").text((function(t,e){return c[e]})).style("opacity",1).on("click",(function(t,e){r.clickHandler(c[e],"")}));f.selectAll(".matrix-cell-business").data((function(t){return Object.values(t)})).enter().append("rect").attr("class","matrix-cell matrix-cell-business").attr("height",o.cellHeight).attr("width",o.cellWidth).attr("x",(function(t,e){return(o.cellWidth+o.cellPadding)*e})).attr("fill",(function(t){return u(t)})).on("mouseover",(function(t,e){Ke(this).style("cursor","pointer"),Ke(this).attr("stroke","white").attr("stroke-width","2"),s.transition().duration(200).style("opacity",.8),s.html(""+parseFloat(t).toFixed(2)),s.style("left",qt.pageX+"px"),s.style("top",(parseInt(Ke(this.parentNode).attr("id").split("_")[1])+1)*(o.cellHeight+o.cellPadding)+"px")})).on("mouseout",(function(t){Ke(this).style("cursor","default"),Ke(this).attr("stroke","black").attr("stroke-width","0"),s.transition().duration(500).style("opacity",0)})).on("click",(function(t,e){var n=this.parentElement.id.split("_")[1];r.clickHandler(c[n],i.columns[e])})),o.svg.selectAll(".matrix-column-label").data(Object.keys(i[0])).enter().append("text").attr("class","matrix-label matrix-column-label").attr("text-anchor","start").attr("transform",(function(t,e){return"translate("+(e*(o.cellWidth+o.cellPadding)+(o.cellWidth+o.cellPadding)/2)+",-8) rotate(270)"})).text((function(t,e){return t})).on("click",(function(t,e){r.clickHandler("",i.columns[e])}));o.svg.append("g").attr("class","colorLegend").attr("transform","translate("+(o.width+5)+",0)");var l=hu().ascending(!0).labelAlign("start").shapeWidth(5).shapeHeight((i.length*(o.cellWidth+o.cellPadding)-o.cellPadding)/a-1).cells(ot(o.min,o.max,(o.max-o.min)/a)).scale(u);o.svg.select(".colorLegend").call(l)}})).catch((function(t){console.log("error loading vis data:"+t)}))},renderBarChart:function(t,e,n,r,i){var a=Zi(".2n"),o={margin:{top:20,right:20,bottom:30,left:40}};o.width=t.clientWidth-o.margin.left-o.margin.right,o.height=o.width,o.padding=15,o.tooltip=Ke("#"+e).append("div").attr("class","tooltip").attr("id","tooltip_barChart").style("opacity",0),o.svg=Ke("#"+e).append("svg").attr("width",o.width+o.margin.left+o.margin.right).attr("height",o.height+o.margin.top+o.margin.bottom),o.x=Ta().rangeRound([0,o.width]).padding(.1),o.y=La().rangeRound([o.height,0]);var s=o.svg.append("g").attr("transform","translate("+o.margin.left+","+o.margin.top+")");return Di(n).then(t=>t.map(t=>(t.frequency=+t.frequency,t))).then(t=>{o.x.domain(t.map((function(t){return t.type}))),o.y.domain([0,ht(t,(function(t){return t.frequency}))]),s.append("g").attr("class","axis axis--x").attr("transform","translate("+o.padding+","+o.height+")").call(Ct(o.x)),s.append("g").attr("class","axis axis--y").call(At(o.y).ticks(10).tickFormat(a)).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("Number of Cells").attr("fill","white"),s.selectAll(".bar").data(t).enter().append("rect").attr("class","bar").attr("x",(function(t){return o.padding+o.x(t.type)})).attr("y",(function(t){return o.y(0)})).attr("width",o.x.bandwidth()).attr("height",(function(t){return o.height-o.y(0)})),o.svg.selectAll("rect").attr("y",(function(t){return o.y(t.frequency)})).attr("height",(function(t){return o.height-o.y(t.frequency)})),o.svg.selectAll("rect").on("mouseover",(function(t){Ke(this).style("cursor","pointer"),Ke(this).attr("stroke","white").attr("stroke-width","2"),o.tooltip.transition().duration(200).style("opacity",.8),o.tooltip.html(""+a(parseFloat(t.frequency))).style("left",qt.pageX+"px").style("top",Ke(this).attr("y")-o.margin.top+"px")})).on("mouseout",(function(t){Ke(this).style("cursor","default"),Ke(this).attr("stroke","black").attr("stroke-width","0"),o.tooltip.transition().duration(500).style("opacity",0)})).on("click",(function(t,e){r.clickHandler(t.type)}))}).catch(t=>{throw t})},renderBoxPlot:function(t,e,n,r){}};gu.renderScatterplot=function(t,e,n,r,i){var a=20,o=20,s=30,c=40,u=t.clientWidth-c-o,f=u,l=Zi(".2n"),h=(n=n).clusters.labels.split(","),d=n.clusters.colors.split(","),p=n.clusters.reorder.split(","),g=function(t){return t[n.axes.x]},m=La().range([0,u]),v=function(t){return m(g(t))},b=Ct(m);b.ticks(5).tickFormat(Zi(".1f"));var y=function(t){return t[n.axes.y]},w=La().range([f,0]),_=function(t){return w(y(t))},x=At(w);x.ticks(5).tickFormat(Zi(".1f"));var C=function(t){return h[parseInt(t.clust_ID)-1]},A=Sa().domain(h).range(d),S=d.slice().sort((function(t,e){return p.indexOf(h[d.indexOf(t)])-p.indexOf(h[d.indexOf(e)])})),T=Sa().domain(p).range(S),M=Ke("#"+e).append("svg").attr("width",u+c+o).attr("height",f+a+s).append("g").attr("transform","translate("+c+","+a+")"),E=Ke("body").append("div").attr("class","tooltip").style("opacity",0).style("width","100px");return Di(n.data).then((function(t){t.forEach((function(t){t[n.axes.x]=+t[n.axes.x],t[n.axes.y]=+t[n.axes.y]}));var e=(Math.abs(ht(t,g))+Math.abs(dt(t,g)))/10;m.domain([dt(t,g)-e,ht(t,g)+e]),w.domain([dt(t,y)-e,ht(t,y)+e]),M.append("g").attr("class","x axis").attr("transform","translate(0,"+f+")").call(b).append("text").attr("class","label").attr("x",u).attr("y",-6).style("text-anchor","end").text(n.axes.x).attr("fill","white"),M.append("g").attr("class","y axis").call(x).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text(n.axes.y).attr("fill","white");var i=1.5,a=.5;t.length<=100?(i=3.5,a=1):t.length<=1e3&&(i=2,a=.95),M.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("r",i).attr("cx",v).attr("cy",_).style("fill",(function(t){return"#"+A(C(t))})).attr("fill-opacity",a).on("click",(function(t){r.clickHandler(function(t){return[parseInt(t.X_position),parseInt(t.Y_position)]}(t))})).on("mouseover",(function(t){Ke(this).style("cursor","pointer"),E.transition().duration(200).style("opacity",.9),E.html(C(t)+"<br/> (x: "+l(parseFloat(g(t)))+", y: "+l(parseFloat(y(t)))+")").style("left",qt.pageX+5+"px").style("top",qt.pageY-28+"px")})).on("mouseout",(function(t){Ke(this).style("cursor","default"),E.transition().duration(500).style("opacity",0)}));var o=M.selectAll(".legend").data(T.domain()).enter().append("g").attr("class","legend").attr("transform",(function(t,e){return"translate(0,"+20*e+")"}));o.append("rect").attr("x",u-18).attr("width",18).attr("height",18).style("fill",(function(t){return console.log(T(t)),"#"+T(t)})),o.append("text").attr("x",u-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text((function(t){return t})).attr("font-size","0.8em").attr("fill","white")})).catch(t=>{throw t})},gu.renderCanvasScatterplot=function(t,e,n,r,i){if(Ke("#axis-svg").empty()){i=i,n.data.length;var a,o,s=0,c=1,u=n.clusters.labels.split(","),f=n.clusters.colors.split(","),l=n.clusters.reorder.split(","),h={top:10,right:10,bottom:30,left:30},d=t.clientWidth-h.left-h.right,p=d,g=(Zi(".2n"),d-h.left-h.right),m=p-h.top-h.bottom,v=Ke("#"+e).append("div").style("width",d+"px").style("height",p+"px");return v.append("svg").attr("id","axis-svg").attr("class","plot"),Ke("#"+e).append("div").style("width",d+"px").style("height","100px").append("svg").attr("id","axis-svg-legend"),v.append("canvas").attr("id","plot-canvas").attr("class","plot"),Di(n.data).then((function(t){s=Math.min(t.length,1e4),console.log("shifting data");var e=t.map((function(t,e){return[parseFloat(t[n.axes.x]),parseFloat(t[n.axes.y]),t,e,!1]})),v=t.map((function(t,e){return[parseFloat(t.X_position),parseFloat(t.Y_position),t,e,!1]})),b=Fi(e),y=(Fi(v),_.sampleSize(e,s)),w=1.5,x=.5;e.length<=100?(w=5.5,x=1):e.length<=1e3?(w=4,x=.9):e.length<=1e4?(w=3,x=.75):e.length<=1e5?(w=2,x=.6):e.length<=1e6&&(w=1,x=.5);var C=Ke("#plot-canvas").attr("width",g-1).attr("height",m-1).style("transform","translate("+(h.left+1)+"px,"+(h.top+1)+"px)"),A=Ke("#axis-svg").attr("width",d).attr("height",p).append("g").attr("transform","translate("+h.left+","+h.top+")"),S=Ke("#axis-svg-legend").attr("width",d).attr("height",100).append("g").attr("transform","translate("+h.left+","+h.top+")"),T=it(e,(function(t){return t[0]})),M=it(e,(function(t){return t[1]})),E=La().domain([T[0],T[1]]).range([0,g]),k=E.copy(),U=La().domain([M[0],M[1]]).range([m,0]),D=U.copy(),P=Ct().scale(E).tickSizeInner(-m).tickSizeOuter(0).tickPadding(10),I=At().scale(U).tickSizeInner(-g).tickSizeOuter(0),R=function(){var t,e,n=Ec,r=kc,i=Ic,a=Dc,o=Pc,s=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,f=_c,l=Dt("start","zoom","end"),h=0;function d(t){t.property("__zoom",Uc).on("wheel.zoom",w).on("mousedown.zoom",_).on("dblclick.zoom",x).filter(o).on("touchstart.zoom",C).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new Ac(e,t.x,t.y)}function g(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new Ac(t.k,r,i)}function m(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n){t.on("start.zoom",(function(){b(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){b(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,a=b(t,i),o=r.apply(t,i),s=null==n?m(o):"function"==typeof n?n.apply(t,i):n,c=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),u=t.__zoom,l="function"==typeof e?e.apply(t,i):e,h=f(u.invert(s).concat(c/u.k),l.invert(s).concat(c/l.k));return function(t){if(1===t)t=l;else{var e=h(t),n=c/e[2];t=new Ac(n,s[0]-e[0]*n,s[1]-e[1]*n)}a.zoom(null,t)}}))}function b(t,e,n){return!n&&t.__zooming||new y(t,e)}function y(t,e){this.that=t,this.args=e,this.active=0,this.extent=r.apply(t,e),this.taps=0}function w(){if(n.apply(this,arguments)){var t=b(this,arguments),e=this.__zoom,r=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,a.apply(this,arguments)))),o=te(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=e.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(e.k===r)return;t.mouse=[o,e.invert(o)],wr(this),t.start()}Mc(),t.wheel=setTimeout(u,150),t.zoom("mouse",i(g(p(e,r),t.mouse[0],t.mouse[1]),t.extent,c))}function u(){t.wheel=null,t.end()}}function _(){if(!e&&n.apply(this,arguments)){var t=b(this,arguments,!0),r=Ke(qt.view).on("mousemove.zoom",u,!0).on("mouseup.zoom",f,!0),a=te(this),o=qt.clientX,s=qt.clientY;Je(qt.view),Tc(),t.mouse=[a,this.__zoom.invert(a)],wr(this),t.start()}function u(){if(Mc(),!t.moved){var e=qt.clientX-o,n=qt.clientY-s;t.moved=e*e+n*n>h}t.zoom("mouse",i(g(t.that.__zoom,t.mouse[0]=te(t.that),t.mouse[1]),t.extent,c))}function f(){r.on("mousemove.zoom mouseup.zoom",null),Ze(qt.view,t.moved),Mc(),t.end()}}function x(){if(n.apply(this,arguments)){var t=this.__zoom,e=te(this),a=t.invert(e),o=t.k*(qt.shiftKey?.5:2),s=i(g(p(t,o),e,a),r.apply(this,arguments),c);Mc(),u>0?Ke(this).transition().duration(u).call(v,s,e):Ke(this).call(d.transform,s)}}function C(){if(n.apply(this,arguments)){var e,r,i,a,o=qt.touches,s=o.length,c=b(this,arguments,qt.changedTouches.length===s);for(Tc(),r=0;r<s;++r)i=o[r],a=[a=Ge(this,o,i.identifier),this.__zoom.invert(a),i.identifier],c.touch0?c.touch1||c.touch0[2]===a[2]||(c.touch1=a,c.taps=0):(c.touch0=a,e=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(c.taps<2&&(t=setTimeout((function(){t=null}),500)),wr(this),c.start())}}function A(){if(this.__zooming){var e,n,r,a,o=b(this,arguments),s=qt.changedTouches,u=s.length;for(Mc(),t&&(t=clearTimeout(t)),o.taps=0,e=0;e<u;++e)n=s[e],r=Ge(this,s,n.identifier),o.touch0&&o.touch0[2]===n.identifier?o.touch0[0]=r:o.touch1&&o.touch1[2]===n.identifier&&(o.touch1[0]=r);if(n=o.that.__zoom,o.touch1){var f=o.touch0[0],l=o.touch0[1],h=o.touch1[0],d=o.touch1[1],m=(m=h[0]-f[0])*m+(m=h[1]-f[1])*m,v=(v=d[0]-l[0])*v+(v=d[1]-l[1])*v;n=p(n,Math.sqrt(m/v)),r=[(f[0]+h[0])/2,(f[1]+h[1])/2],a=[(l[0]+d[0])/2,(l[1]+d[1])/2]}else{if(!o.touch0)return;r=o.touch0[0],a=o.touch0[1]}o.zoom("touch",i(g(n,r,a),o.extent,c))}}function S(){if(this.__zooming){var t,n,r=b(this,arguments),i=qt.changedTouches,a=i.length;for(Tc(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<a;++t)n=i[t],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var o=Ke(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return d.transform=function(t,e,n){var r=t.selection?t.selection():t;r.property("__zoom",Uc),t!==r?v(t,e,n):r.interrupt().each((function(){b(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},d.scaleBy=function(t,e,n){d.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},d.scaleTo=function(t,e,n){d.transform(t,(function(){var t=r.apply(this,arguments),a=this.__zoom,o=null==n?m(t):"function"==typeof n?n.apply(this,arguments):n,s=a.invert(o),u="function"==typeof e?e.apply(this,arguments):e;return i(g(p(a,u),o,s),t,c)}),n)},d.translateBy=function(t,e,n){d.transform(t,(function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)}))},d.translateTo=function(t,e,n,a){d.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,s=null==a?m(t):"function"==typeof a?a.apply(this,arguments):a;return i(Sc.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),a)},y.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Jt(new Cc(d,t,this.that.__zoom),l.apply,l,[t,this.that,this.args])}},d.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:xc(+t),d):a},d.filter=function(t){return arguments.length?(n="function"==typeof t?t:xc(!!t),d):n},d.touchable=function(t){return arguments.length?(o="function"==typeof t?t:xc(!!t),d):o},d.extent=function(t){return arguments.length?(r="function"==typeof t?t:xc([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),d):r},d.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],d):[s[0],s[1]]},d.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],d):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},d.constrain=function(t){return arguments.length?(i=t,d):i},d.duration=function(t){return arguments.length?(u=+t,d):u},d.interpolate=function(t){return arguments.length?(f=t,d):f},d.on=function(){var t=l.on.apply(l,arguments);return t===l?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d}().scaleExtent([1,100]).on("zoom",(function(){E=qt.transform.rescaleX(k),P.scale(E),N.call(P),U=qt.transform.rescaleY(D),I.scale(U),B.call(I),c=qt.transform.k,clearTimeout(a),c<5?L(y):L()})).on("end",(function(){a=setTimeout((function(){L()}),200)})),N=A.append("g").attr("class","x axis").attr("transform","translate(0,"+m+")").call(P),B=A.append("g").attr("class","y axis").call(I);C.on("click",(function(){var t=te(this),n=E.invert(t[0]),i=U.invert(t[1]),a=b.find(n,i),s=E(a[0]),c=U(a[1]);(function(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))})(t[0],t[1],s,c)<10*w&&(o&&(e[o][4]=!1),a[4]=!0,o=a[3],L(),r.clickHandler(O(a[2])))})),C.call(R);var F=C.node().getContext("2d");L();var O=function(t){return[parseInt(t.X_position),parseInt(t.Y_position)]};function L(t){var n;F.clearRect(0,0,d,p),t?t.forEach((function(t){var r=e[t[3]];r[4]?n=r:V(!1,r,w)})):e.forEach((function(t){t[4]?n=t:V(!1,t,w)})),n&&V(!0,n,w)}function V(t,e,n){if(e[0]>=it(E.domain())[0]&&e[0]<=it(E.domain())[1]&&e[1]>=it(U.domain())[0]&&e[1]<=it(U.domain())[1]){var r=E(e[0]),i=U(e[1]);if(t){a=wn("#"+f[parseInt(e[2].clust_ID)-1]);F.strokeStyle="#FFA500",F.lineWidth=5,F.fillStyle=a+"",F.beginPath(),F.arc(r,i,n*(c/10),0,2*Math.PI),F.fill(),F.stroke()}else{var a;(a=wn("#"+f[parseInt(e[2].clust_ID)-1])).opacity=x,F.fillStyle=a+"",F.beginPath(),F.arc(r,i,n*(c/10),0,2*Math.PI),F.fill()}}}Sa().domain(u).range(f);sortedColors=f.slice().sort((function(t,e){return l.indexOf(u[f.indexOf(t)])-l.indexOf(u[f.indexOf(e)])}));var H=Sa().domain(l).range(sortedColors),z=u.length/2,$=S.selectAll(".legend").data(H.domain()).enter().append("g").attr("transform",(function(t,e){return"translate("+(e%z*80-.7*d)+","+18*Math.floor(e/z)*1.2+")"})).attr("class","legend");$.append("rect").attr("x",g-18).attr("width",18).attr("height",18).style("fill",H),$.append("text").attr("x",g-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text((function(t){return t})).attr("font-size","0.8em").attr("fill","white");i.bind(i.events.osdClickEvent,t=>{})}))}};var mu=gu;const vu=function(t){return Math.round(10*t)/10},bu=function(t){const e=Math.pow(10,4);return Math.round(t*e)/e},yu=function(t){return Object.keys(t).forEach(e=>{null==t[e]&&delete t[e]}),t},wu=function(t){return btoa(encodeURIComponent(t))},_u=function(t){try{return decodeURIComponent(atob(t))}catch(t){return""}},xu=function(t){return $(t).serializeArray().reduce((function(t,e){return t[e.name]=e.value,t}),{})},Cu=function(t,e,n){return e?$(t).addClass(n):$(t).removeClass(n)},Au=function(t,e){Cu(t,!e,"d-none")},Su=function(t,e){Cu(t,e,"active")},Tu=function(t,e){Cu(t,e,"green"),Cu(t,!e,"white")};const Mu=function(t){Z.copy(t)},Eu=function(t,e,n){const r=e.reduce((function(t,e){return e.TileSize=e.TileSize||[1024,1024],e.maxLevel=e.maxLevel||0,t[e.Name]=e,t}),{});return t[n].map((function(t){return t.map((function(t){return this.image_map[t]}),{image_map:r})}),{image_map:r})},ku=function(t){$(this).tooltip({title:"Copy to Clipboard"}),$(this).on("relabel",(function(t,e){$(this).attr("data-original-title",e).tooltip("show")})),$(this).click((function(){return $(this).trigger("relabel",["Copied"]),Mu(t.hashstate.bufferYaml),setTimeout(function(){$(this).trigger("relabel",["Copy to Clipboard"])}.bind(this),1e3),!1}))},Uu=function(){$(this).tooltip({title:"Copy to Clipboard"}),$(this).on("relabel",(function(t,e){$(this).attr("data-original-title",e).tooltip("show")})),$(this).on("click",(function(){const t=$(this).closest("form"),e=xu(t);return $(this).trigger("relabel",["Copied"]),Mu(e.copy_content),setTimeout((function(){$(this).trigger("relabel",["Copy to Clipboard"])}),1e3),!1}))},Du=function(t,e,n){this.eventHandler=n,this.trackers=t.trackers,this.pollycache=t.pollycache,this.showdown=new showdown.Converter,this.osd=e,this.hashstate=t};Du.prototype={init:function(){const t=this.hashstate;window.onpopstate=function(e){t.popState(e),this.loadPolly(t.waypoint.Description),this.newView(!0)}.bind(this),window.onpopstate(),this.edit&&t.startEditing(),t.pushState(),window.onpopstate(),$("#exhibit-name").text(t.exhibit.Name),$(".modal_copy_button").each(Uu),$("#zoom-in").tooltip({title:"Zoom in"}),$("#zoom-out").tooltip({title:"Zoom out"}),$("#arrow-switch").tooltip({title:"Share Arrow"}),$("#lasso-switch").tooltip({title:"Share Region"}),$("#draw-switch").tooltip({title:"Share Box"}),$("#duplicate-view").tooltip({title:"Clone linked view"}),$("#copy_link_modal").on("hidden.bs.modal",t.cancelDrawing.bind(t)),$("#edit_description_modal").on("hidden.bs.modal",t.cancelDrawing.bind(t)),$("#toggle-sidebar").click((function(t){t.preventDefault(),$("#sidebar-menu").toggleClass("toggled")})),$("#toggle-legend").click((function(t){t.preventDefault(),$("#legend").toggleClass("toggled")})),$("#leftArrow").click(this,(function(t){const e=t.data.hashstate;0==e.w?(e.s=e.s-1,e.w=e.waypoints.length-1):e.w=e.w-1,e.pushState(),window.onpopstate()})),$("#rightArrow").click(this,(function(t){const e=t.data.hashstate;e.w==e.waypoints.length-1?(e.s=e.s+1,e.w=0):e.w=e.w+1,e.pushState(),window.onpopstate()})),$("#edit-switch").click(this,(function(t){const e=t.data.hashstate;e.edit||(e.startEditing(),e.pushState(),window.onpopstate())})),$("#view-switch").click(this,(function(t){const e=t.data.hashstate;e.edit&&(e.finishEditing(),e.pushState(),window.onpopstate())})),$("#toc-button").click(this,(function(t){const e=t.data.hashstate;"outline"!=e.waypoint.Mode&&(e.s=0,e.pushState(),window.onpopstate())})),$(".clear-switch").click(this,(function(t){const e=t.data.hashstate;e.bufferWaypoint=void 0,e.startEditing(),e.pushState(),window.onpopstate()})),$(".arrow-switch").click(this,(function(t){const e=t.data.hashstate,n=t.data;e.drawType="arrow",e.drawing?e.cancelDrawing(e):e.startDrawing(e),e.pushState(),n.newView(!1)})),$(".lasso-switch").click(this,(function(t){const e=t.data.hashstate,n=t.data;e.drawType="lasso",e.drawing?e.cancelDrawing(e):e.startDrawing(e),e.pushState(),n.newView(!1)})),$(".draw-switch").click(this,(function(t){const e=t.data.hashstate,n=t.data;e.drawType="box",e.drawing?e.cancelDrawing(e):e.startDrawing(e),e.pushState(),n.newView(!1)}));var e=document.getElementById("depth-legend"),n=document.getElementById("z-slider");n.max=t.cgs.length-1,n.value=t.g,n.min=0,t.design.is3d&&t.design.z_scale?e.innerText=vu(t.g/t.design.z_scale)+" μm":t.design.is3d&&(e.innerText=t.group.Name);const r=this;n.addEventListener("input",(function(){t.g=n.value,t.design.z_scale?e.innerText=vu(t.g/t.design.z_scale)+" μm":e.innerText=t.group.Name,r.newView(!0)}),!1),$("#edit_description_modal form").submit(this,(function(t){const e=t.data.hashstate,n=xu(t.target);$(this).closest(".modal").modal("hide"),e.d=wu(n.d),$("#copy_link_modal").modal("show");const r=e.location("host")+e.location("pathname"),i=e.makeHash(["d","g","m","a","v","o","p"]);return document.getElementById("copy_link").value=r+i,!1}))},newView:function(t){const e=this.hashstate;if(this.osd.newView(t),t){this.addChannelLegends(),e.design.is3d?$("#channel-label").hide():this.addGroups(),this.addMasks(),this.newStories(),e.edit?this.fillWaypointEdit():this.fillWaypointView(),$(".step-back").click(this,(function(t){const e=t.data.hashstate;e.w-=1,e.pushState(),window.onpopstate()})),$(".step-next").click(this,(function(t){const e=t.data.hashstate;e.w+=1,e.pushState(),window.onpopstate()}));const t=this;$(".edit_copy_button").each((function(){ku.call(this,t)})),$("#edit_toggle_arrow").click(this,(function(t){const e=t.data.hashstate,n=t.data,r=e.waypoint.Arrows[0],i=r.HideArrow;r.HideArrow=!i,n.newView(!0)}))}if(e.edit){const t=this;$("#mask-picker").off("changed.bs.select"),$("#mask-picker").on("changed.bs.select",(function(n,r,i,a){const o=$(this).find("option").eq(r).text();e.waypoint.Masks=e.masks.map(t=>t.Name).filter((function(t){return i?a.includes(t)||t==o:a.includes(t)&&t!=o}));const s=e.active_masks.map(t=>t.Name).filter((function(t){return e.waypoint.Masks.includes(t)}));e.waypoint.ActiveMasks=s,e.m=s.map(t=>Xu(e.masks,t)),t.newView(!0)})),$("#group-picker").off("changed.bs.select"),$("#group-picker").on("changed.bs.select",(function(n,r,i,a){const o=$(this).find("option").eq(r).text();e.waypoint.Groups=e.cgs.map(t=>t.Name).filter((function(t){return i?a.includes(t)||t==o:a.includes(t)&&t!=o}));const s=e.waypoint.Groups,c=e.cgs[e.g].Name;s.length>0&&!s.includes(c)&&(e.g=Xu(e.cgs,s[0])),t.newView(!0)}))}const n=e.edit,r=e.drawing,i=e.drawType;var a;Su("#view-switch",!n),Su("#edit-switch",n),Au("#home-button",!n&&"outline"==e.waypoint.Mode),Au("#toc-button",!n&&"outline"!=e.waypoint.Mode),Au("#channel-groups-legend",!e.design.is3d),Au("#z-slider-legend",e.design.is3d),Au("#toggle-legend",!e.design.is3d),Au(".only-3d",e.design.is3d),Au(".editControls",n),Au("#waypointControls",!n),Au("#waypointName",!n),a="crosshair",r?$("#openseadragon1 *").css("cursor",a):$("#openseadragon1 *").css("cursor","default"),Tu(".draw-switch *",r&&"box"==i),Tu(".lasso-switch *",r&&"lasso"==i),Tu(".arrow-switch *",r&&"arrow"==i)},loadPolly:function(t){const e=J()(t);if(speech_bucket){const t="https://s3.amazonaws.com/"+speech_bucket+"/speech/"+e+".mp3";document.getElementById("audioSource").src=t,document.getElementById("audioPlayback").load()}},drawLowerBounds:function(t){const e=this.hashstate,n=[t.x,t.y];e.o=n.concat([0,0]),this.newView(!1)},computeBounds:function(t,e,n){return t<e+n/2?{start:t,range:e+n-t}:{start:e,range:t-e}},drawUpperBounds:function(t){const e=this.hashstate,n=e.o.slice(0,2),r=e.o.slice(2),i=this.computeBounds(t.x,n[0],r[0]),a=this.computeBounds(t.y,n[1],r[1]),o=[i.start,a.start,i.range,a.range];e.o=o.map(bu),this.newView(!1)},addMasks:function(){const t=this.hashstate;$("#mask-layers").empty(),t.edit||"explore"==t.waypoint.Mode?($("#mask-layers").addClass("flex"),$("#mask-layers").removeClass("flex-column")):($("#mask-layers").addClass("flex-column"),$("#mask-layers").removeClass("flex"));const e=t.waypoint.Masks||[],n=t.masks.filter(t=>e.includes(t.Name));n.length||t.edit?$("#mask-label").show():$("#mask-label").hide(),n.forEach((function(e){const n=Xu(t.masks,e.Name);this.addMask(e,n)}),this)},addMask:function(t,e){const n=this.hashstate;var r=document.createElement("a");r=Object.assign(r,{className:n.m.includes(e)?"nav-link active":"nav-link",href:"javascript:;",innerText:t.Name,title:t.Path,id:t.Path});var i=!!n.m.includes(e);r.setAttribute("aria-selected",i),document.getElementById("mask-layers").appendChild(r),$(r).click(this,(function(t){const n=t.data.hashstate,r=n.design.default_group,i=Xu(n.cgs,r);-1!=i&&(n.g=i),n.m.includes(e)?n.m=n.m.filter(t=>t!=e):n.m.push(e),n.pushState(),window.onpopstate()}))},addGroups:function(){const t=this.hashstate;$("#channel-groups").empty(),$("#channel-groups-legend").empty();const e=t.waypoint.Groups||[],n=t.cgs.filter(t=>e.includes(t.Name));n.length||t.edit?$("#channel-label").show():$("#channel-label").hide(),n.forEach((function(e){const n=Xu(t.cgs,e.Name);this.addGroup(e,n,"channel-groups",!1)}),this);const r=t.cgs.filter(t=>t.Channels.length>1),i=t.cgs.filter(t=>1==t.Channels.length),a=document.getElementById("channel-groups-legend");var o;r.length>0&&((o=document.createElement("h6")).innerText="Channel Groups:",o.className="m-1",a.appendChild(o));(r.forEach((function(e){const n=Xu(t.cgs,e.Name);this.addGroup(e,n,"channel-groups-legend",!0)}),this),i.length>0)&&((o=document.createElement("h6")).innerText="Channels:",o.className="m-1",a.appendChild(o));i.forEach((function(e){const n=Xu(t.cgs,e.Name);this.addGroup(e,n,"channel-groups-legend",!0)}),this)},addGroup:function(t,e,n,r){const i=this.hashstate;var a=document.createElement("a"),o=i.g===e;(a=Object.assign(a,{className:o?"nav-link active":"nav-link",style:"padding-right: 40px; position: relative;",href:"javascript:;",innerText:t.Name,id:t.Path+"_"+n})).setAttribute("data-toggle","pill");var s=void 0;for(var c in i.stories)for(var u in i.stories[c].Waypoints){var f=i.stories[c].Waypoints[u];f.Group==t.Name&&(null==s||f.DefineGroup)&&(s=[c,u])}var l=document.createElement("a");if(o&&r&&s){l=Object.assign(l,{className:"text-white",style:"position: absolute; right: 5px;",href:"javascript:;",innerText:"MORE"}),a.appendChild(l),$(l).click(this,(function(t){i.s=s[0],i.w=s[1],i.pushState(),window.onpopstate()}))}document.getElementById(n).appendChild(a),$(a).click(this,(function(t){i.g=e,i.pushState(),window.onpopstate()}))},addChannelLegends:function(){const t=this.hashstate;$("#channel-legend").empty(),t.channels.forEach(this.addChannelLegend,this)},addChannelLegend:function(t,e){const n=this.indexColor(e,"#FFF");var r=document.createElement("span");r.className="legend-label pl-3",r.innerText=t;var i=document.createElement("span");$(i).css("background-color",n),i.className="badge legend-color",i.innerText=" ";var a=document.getElementById("channel-legend"),o=document.createElement("li");o.appendChild(i),o.appendChild(r),a.appendChild(o)},channelOrders:function(t){return t.reduce((function(t,e,n){return t[e]=n,t}),{})},indexColor:function(t,e){const n=this.hashstate.colors;return void 0===t?e:"#"+n[t%n.length]},newStories:function(){const t=this.hashstate,e=document.getElementById("story-container");if(function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(e),"outline"==t.waypoint.Mode){var n=document.createElement("p");n.innerText="Table of Contents",e.appendChild(n);var r=document.createElement("div"),i=document.createElement("ol");t.stories.forEach((function(t,e){null!=t.Mode&&"outline"!=t.Mode||this.addStory(t,e,i)}),this),r.appendChild(i),e.appendChild(r)}const a=document.createElement("p"),o=t.design.footer;a.innerHTML=this.showdown.makeHtml(o),e.appendChild(a)},addStory:function(t,e,n){t.Waypoints.forEach((function(t,r){this.addWaypoint(t,r,e,n)}),this)},addWaypoint:function(t,e,n,r){var i=document.createElement("li"),a=document.createElement("a");a=Object.assign(a,{className:"",href:"javascript:;",innerText:t.Name}),$(a).click(this,(function(t){const r=t.data.hashstate;r.s=n,r.w=e,r.pushState(),window.onpopstate()})),i.appendChild(a),r.appendChild(i)},fillWaypointView:function(){const t=this.hashstate,e=t.waypoint,n=document.getElementById("viewer-waypoint"),r=document.getElementById("waypointName");document.getElementById("waypointCount").innerText=t.currentCount+"/"+t.totalCount,"outline"!==e.Mode?r.innerText=e.Name:r.innerText="";const i=$(".waypoint-content").scrollTop();$(n).css("height",$(n).height());var a=e.Description;cell_type_links_map.forEach((function(t,e){var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=RegExp(n+"s?","gi");a=a.replace(r,(function(e){return"["+e+"]("+t+")"}))})),marker_links_map.forEach((function(t,e){var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=RegExp("(^|[^0-9A-Za-z`])("+n+")([^0-9A-Za-z`]|$)","gi");a=a.replace(r,(function(t,e,n,r){return t.replace(n,"`"+n+"`","gi")}))})),marker_links_map.forEach((function(t,e){var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=RegExp("`"+n+"`","gi");a=a.replace(r,(function(e){return"["+e+"]("+t+")"}))}));const o=new Set(["VisMatrix","VisBarChart","VisScatterplot","VisCanvasScatterplot"].filter(t=>e[t])),s=new Set,c=this,u=function(t){s.add(t),[...o].every(t=>s.has(t))&&($(".waypoint-content").scrollTop(i),$(n).css("height",""),c.colorMarkerText(n))},f=function(e){var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");const r=RegExp(n,"gi"),i=Ju(t.masks,r);i>=0&&(t.m=[i]),c.newView(!0)},l=function(e,n){var r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");const i=RegExp(r,"gi"),a=Ju(t.masks,i);a>=0&&(t.m=[a]);const o=Xu(t.cgs,n);if(o>=0)t.g=o;else{var s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");const e=RegExp(s,"gi"),r=Ju(t.cgs,e);r>=0&&(t.g=r)}c.newView(!0)},h=function(e){var n=c.osd.viewer.viewport.imageToViewportCoordinates(e[0],e[1]);t.v=[10,n.x,n.y],c.osd.newView(!0),t.a=[n.x,n.y]},d=function(t,n,r){const i={VisMatrix:mu.renderMatrix,VisBarChart:mu.renderBarChart,VisScatterplot:mu.renderScatterplot,VisCanvasScatterplot:mu.renderCanvasScatterplot}[t],a={VisMatrix:l,VisBarChart:f,VisScatterplot:h,VisCanvasScatterplot:h}[t];i(n,r,e[t],{clickHandler:a},c.eventHandler).then(()=>u(t))};var p=document.createElement("div");if(Array.from(o).forEach((function(e){var r=e+"-"+t.s+"-"+t.w,i=n.getElementsByClassName(r);i[0]&&p.appendChild(i[0])})),n.innerHTML=this.showdown.makeHtml(a),e.Image){var g=document.createElement("img");g.src=e.Image,n.appendChild(g)}Array.from(o).forEach((function(e){const r=Array.from(n.getElementsByTagName("code")).filter(t=>t.innerText==e)[0],i=document.createElement("div");i.style.cssText="position:relative",i.className=e+"-"+t.s+"-"+t.w,i.id=e+"-"+t.s+"-"+t.w;const a=p.getElementsByClassName(i.className);a[0]&&r?($(r).replaceWith(a[0]),u(e)):r?($(r).replaceWith(i),d(e,n,i.id)):(n.appendChild(i),d(e,n,i.id))})),u("")},colorMarkerText:function(t){const e=this.hashstate,n=this.channelOrders(e.channels),r=t.getElementsByTagName("code");for(var i=0;i<r.length;i++){var a=r[i],o=n[a.innerText];o||Object.keys(n).forEach((function(t){const e=a.innerText,r=marker_alias_map.get(e)||e,i=marker_alias_map.get(t)||t;var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");const c=RegExp("^"+s+"$","gi");null!=i&&i.match(c)&&(o=n[t])}));var s=this.indexColor(o),c=s?"2px solid "+s:"inherit";$(a).css("border-bottom",c)}},fillWaypointEdit:function(){const t=this.hashstate,e=document.getElementById("viewer-waypoint");$(e).empty();const n=document.getElementsByClassName("save_edits_form")[0].cloneNode(!0);e.appendChild(n),1==t.waypoint.Arrows[0].HideArrow?$("#edit_toggle_arrow").css("opacity","0.5"):$("#edit_toggle_arrow").css("opacity","1");const r=$(e).find(".edit_text")[0],i=$(e).find(".edit_name")[0],a=$(e).find(".edit_arrow_text")[0],o=_u(t.d),s=_u(t.n);$(a).on("input",this,(function(t){const e=t.data.hashstate,n=t.data;e.waypoint.Arrows[0].Text=this.value,n.newView(!1)})),a.value=t.waypoint.Arrows[0].Text||"",$(i).on("input",this,(function(t){const e=t.data.hashstate;e.n=wu(this.value),e.waypoint.Name=this.value})),i.value=s,$(r).on("input",this,(function(t){const e=t.data.hashstate;e.d=wu(this.value),e.waypoint.Description=this.value})),r.value=o}};var Pu=n(13),Iu=n.n(Pu);const Ru=function(t,e){return e.then((function(e){const n=new G({UserPoolId:"us-east-1_d3Wusx6qp",ClientId:"cvuuuuogh6nmqm8491iiu1lh5"});return function(t,e){return new Promise((function(n,r){t.authenticateUser(e,{onSuccess:t=>n(t),onFailure:t=>r(t),mfaRequired:t=>r(t),newPasswordRequired:(t,e)=>r({fields:t,required:e})})}))}(new q({Username:t,Pool:n}),new o({Username:t,Password:e})).then(t=>t.getIdToken().getJwtToken())}))},Nu=function(t,e){return(t%e+e)%e},Bu=function(t){return wu(t.Description)},Fu=function(t){return wu(t.Name)},Ou=function(t,e){const n=(t.ActiveMasks||[]).map(t=>Xu(e,t));return n.length<2?[-1].concat(n):n},Lu=function(t,e){const n=(t.Arrows||[{}])[0].Point;return n||[-100,-100]},Vu=function(t,e){const n=t.Group;return Xu(e,n)},Hu=function(t){return[t.Zoom,t.Pan[0],t.Pan[1]]},zu=function(t){const e=t.Polygon;return e||Yu([])},$u=function(t){return[t.Overlays[0].x,t.Overlays[0].y,t.Overlays[0].width,t.Overlays[0].height]};var Yu=function(t){var e="";return t.forEach((function(t){e+=t.x.toFixed(5)+","+t.y.toFixed(5)+","})),e=e.slice(0,-1),Iu.a.compressToEncodedURIComponent(e)};const qu=function(t,e,n){return t.reduce((function(t,r){var i=e[r]||0;return i.constructor===Array&&(i=i.join("_")),t+n+r+"="+i}),"").slice(1)},ju=function(t){return t.reduce((function(t,e){if(e){const n=e.split("="),r=n.slice(1).join("=")||"1",i=r.split("_");t[n[0]]=i.length>1?i:r}return t}),{})},Wu=function(t,e){this.trackers=[],this.pollycache={},this.embedded=e.embedded||!1,this.exhibit=t,this.state={buffer:{waypoint:void 0},drawType:"lasso",changed:!1,design:{},m:[-1],w:[0],g:0,s:0,a:[-100,-100],v:[.5,.5,.5],o:[-100,-100,1,1],p:[],name:"",description:"",edit:!1,drawing:0},this.newExhibit()};Wu.prototype={get bufferWaypoint(){if(void 0===this.state.buffer.waypoint){const t=this.viewport;return yu({Zoom:t.scale,Pan:[t.pan.x,t.pan.y],Arrows:[{Point:this.a,Text:"",HideArrow:!1}],ActiveMasks:void 0,Masks:void 0,Polygon:this.p,Group:this.group.Name,Groups:void 0,Description:"",Name:"Untitled",Overlays:[this.overlay]})}return this.state.buffer.waypoint},set bufferWaypoint(t){this.state.buffer.waypoint=t},location:function(t){return decodeURIComponent(location[t])},get search(){const t=this.location("search").slice(1).split("&");return ju(t)},get hash(){const t=this.location("hash").slice(1).split("#");return ju(t)},get url(){return this.location("pathname")+this.location("search")+this.location("hash")},get searchKeys(){const t=Object.keys(this.search);return["edit"].filter(e=>t.includes(e))},get hashKeys(){return"tag"==this.waypoint.Mode||this.isSharedLink?["d","s","w","g","m","a","v","o","p"]:["s","w","g","m","a","v","o","p"]},set edit(t){this.state.edit=!!t},get edit(){return!!this.state.edit},get omero_cookie(){return function(t,e){return e.then((function(e){return fetch("https://omero.hms.harvard.edu/api/v0/token/",{mode:"no-cors"}).then((function(n){return fetch("https://omero.hms.harvard.edu/api/v0/login/",{method:"POST",body:JSON.stringify({csrfmiddlewaretoken:n.data,username:t,password:e,server:1})}).then((function(t){return"csrftoken="+n.data+";sessionid="+t.eventContext.sessionUuid+";"}))}))}))}("jth30",new Promise((function(t,e){$("#password_modal").modal("show"),$("#password_modal").find("form").submit((function(e){$("#password_modal").find("form").off(),$(this).closest(".modal").modal("hide");const n=parseForm(e.target).p;return t(n),!1}))})))},get token(){const t=new Promise((function(t,e){t("MEETING@lsp2")}));return Ru("john_hoffer@hms.harvard.edu",t)},get drawType(){return this.state.drawType},set drawType(t){this.state.drawType=t},get drawing(){return this.state.drawing},set drawing(t){const e=parseInt(t,10);this.state.drawing=Nu(e,3)},get v(){return this.state.v},set v(t){this.state.v=t.map(parseFloat)},get a(){return this.state.a},set a(t){this.state.a=t.map(parseFloat)},get m(){const t=this.state.m;return 0==this.masks.length?[-1]:t},set m(t){Array.isArray(t)?this.state.m=t.map(t=>parseInt(t,10)):this.state.m=[-1]},get g(){const t=this.state.g;return t<this.cgs.length?t:0},set g(t){const e=parseInt(t,10),n=this.cgs.length;this.state.g=Nu(e,n)},get w(){const t=this.state.w[this.s]||0;return t<this.waypoints.length?t:0},set w(t){const e=parseInt(t,10),n=this.waypoints.length;this.state.w[this.s]=Nu(e,n);const r=this.waypoint;this.m=Ou(r,this.masks),this.g=Vu(r,this.cgs),this.v=Hu(r),"tag"==this.waypoint.Mode?(this.o=$u(r),this.a=Lu(r)):(this.o=[-100,-100,1,1],this.a=[-100,-100]),this.p=zu(r),this.d=Bu(r),this.n=Fu(r)},get s(){const t=this.state.s;return t<this.stories.length?t:0},set s(t){const e=parseInt(t,10),n=this.stories.length;this.state.s=Nu(e,n),this.w=this.w},get o(){return this.state.o},set o(t){this.state.o=t.map(parseFloat)},get p(){return Yu(this.state.p)},set p(t){this.state.p=function(t){var e=Iu.a.decompressFromEncodedURIComponent(t);if(!e)return[];var n=[],r=[];e.split(",").forEach((function(t,e){e%2==0?n.push(parseFloat(t)):r.push(parseFloat(t))}));var i=[];return n.length==r.length&&n.forEach((function(t,e){i.push({x:t,y:r[e]})})),i}(t)},get d(){return this.state.description},set d(t){this.state.description=""+t},get n(){return this.state.name},set n(t){this.state.name=""+t},get changed(){return this.state.changed},set changed(t){this.state.changed=!!t},get design(){return this.state.design},set design(t){const e=t.stories;this.stories.length!=e.length&&(this.state.w=e.map((function(t,e){return this.state.w[e]||0}),this)),this.state.design=t},get masks(){return this.design.masks||[]},set masks(t){var e=this.design;e.masks=t,this.design=e,this.changed=!0},get cgs(){return this.design.cgs||[]},set cgs(t){var e=this.design;e.cgs=t,this.design=e,this.changed=!0},get chans(){return this.design.chans||[]},set chans(t){var e=this.design;e.chans=t,this.design=e,this.changed=!0},get stories(){return this.design.stories||[]},set stories(t){var e=this.design;e.stories=t,this.design=e,this.changed=!0},get layout(){return this.design.layout||{Grid:[]}},set layout(t){var e=this.design;e.layout=t,this.design=e,this.changed=!0},get images(){return this.design.images||[]},set images(t){var e=this.design;e.images=t,this.design=e,this.changed=!0},get grid(){return Eu(this.layout,this.images,"Grid")},get target(){return Eu(this.layout,this.images,"Target")},get currentCount(){const t=this.s,e=this.w;return this.stories.reduce((function(n,r,i){return t==i?n+e:t>i?n+r.Waypoints.length:n}),1)},get totalCount(){return this.stories.reduce((function(t,e){return t+e.Waypoints.length}),0)},get isSharedLink(){const t=this.hash.hasOwnProperty("d"),e=!this.hash.hasOwnProperty("s"),n=0==this.stories.filter(t=>"tag"==t.Mode).length;return t&&(e||n)},get isMissingHash(){const t=!this.hash.hasOwnProperty("s");return!this.isSharedLink&&t},get story(){return this.stories[this.s]},set story(t){const e=this.stories;e[this.s]=t,this.stories=e},get active_masks(){const t=this.masks;return this.m.map((function(e){return t[e]})).filter(t=>null!=t)},get group(){return this.cgs[this.g]},get colors(){return this.group.Colors.concat(this.active_masks.reduce((t,e)=>t.concat(e.Colors||[]),[]))},get channels(){return this.group.Channels.concat(this.active_masks.reduce((t,e)=>t.concat(e.Channels||[]),[]))},get waypoints(){return this.story.Waypoints},set waypoints(t){const e=this.story;e.Waypoints=t,this.story=e},get waypoint(){if(this.edit)return this.bufferWaypoint;var t=this.waypoints[this.w];return t.Overlays||(t.Overlays=[{x:-100,y:-100,width:1,height:1}]),t},set waypoint(t){if(this.edit)this.bufferWaypoint=t;else{const e=this.waypoints;e[this.w]=t,this.waypoints=e}},get viewport(){const t=this.v;return{scale:t[0],pan:new OpenSeadragon.Point(t[1],t[2])}},get overlay(){const t=this.o;return{x:t[0],y:t[1],width:t[2],height:t[3]}},newExhibit:function(){const t=this.exhibit,e=t.Groups||[],n=t.Masks||[];var r=t.Stories||[];r=r.map(t=>(t.Waypoints=t.Waypoints.map(t=>(null!=t.Overlay&&(t.Overlays=[t.Overlay]),t)),t)),this.design={chans:t.Channels||[],layout:t.Layout||{},images:t.Images||[],header:t.Header||"",footer:t.Footer||"",is3d:t["3D"]||!1,z_scale:t.ZPerMicron||0,default_group:t.DefaultGroup||"",stories:r,masks:n,cgs:e};const i=this.newTempStory("outline");this.stories=[i].concat(this.stories);const a=this.newTempStory("explore");this.stories=this.stories.concat([a])},newTempStory:function(t){this.exhibit;const e=this.group,n=this.a,r=this.o,i=this.p,a=this.v,o=this.design.header,s="outline"==t?wu(o):this.d,c={explore:"Free Explore",tag:"Shared Link",outline:"Introduction"}[t],u={}[t],f={explore:this.masks.filter(t=>t.Name).map(t=>t.Name)}[t],l={tag:this.active_masks.filter(t=>t.Name).map(t=>t.Name)}[t];return{Mode:t,Description:"",Name:c||"Story",Waypoints:[yu({Mode:t,Zoom:a[0],Arrows:[{Point:n}],Polygon:i,Pan:a.slice(1),ActiveMasks:l,Group:e.Name,Masks:f,Groups:u,Description:_u(s),Name:c||"Waypoint",Overlays:[{x:r[0],y:r[1],width:r[2],height:r[3]}]})]}},pushState:function(){const t=this.makeUrl(this.hashKeys,this.searchKeys);(this.url!=t||this.changed)&&(this.embedded?history.replaceState(this.design,document.title,t):history.pushState(this.design,document.title,t),this.changed=!1)},popState:function(t){t&&t.state&&(this.changed=!1,this.design=t.state);const e=this.hash,n=this.search;this.searchKeys;if(this.searchKeys.forEach((function(t){this[t]=n[t]}),this),this.hashKeys.forEach((function(t){e.hasOwnProperty(t)&&(this[t]=e[t])}),this),this.isSharedLink){this.d=e.d;const t=this.newTempStory("tag");this.stories=this.stories.concat([t]),this.s=this.stories.length-1,this.pushState(),window.onpopstate()}else if(this.isMissingHash){this.s=0;const t=$("#welcome_modal");t.find(".channel_count")[0].innerText=this.channels.length,t.modal("show"),this.pushState(),window.onpopstate()}},makeUrl:function(t,e){const n=this.location("pathname"),r=this.makeHash(t);return n+this.makeSearch(e)+r},makeHash:function(t){const e=qu(t,this,"#");return e?"#"+e:""},makeSearch:function(t){const e=qu(t,this,"&");return e?"?"+e:""},startEditing:function(t){const e=t||this.bufferWaypoint;this.bufferWaypoint=e,this.v=Hu(e),this.o=$u(e),this.p=zu(e),this.d=Bu(e),this.n=Fu(e),this.a=Lu(e),this.m=Ou(e,this.masks),this.g=Vu(e,this.cgs)},finishEditing:function(){const t=this.bufferWaypoint;t.Group=this.group.Name,t.Name=_u(this.n),t.Description=_u(this.d),t.Zoom=this.viewport.scale,t.Overlays=[this.overlay],t.ActiveMasks=this.active_masks.map(t=>t.Name),t.Arrows[0].Point=this.a,t.Polygon=this.p,t.Pan=[this.viewport.pan.x,this.viewport.pan.y],this.bufferWaypoint=t,this.pushState(),window.onpopstate()},startDrawing:function(){this.drawing=1;this.waypoint;"lasso"==this.drawType?this.p=Yu([]):"arrow"==this.drawType?this.a=[-100,-100]:this.o=[-100,-100,1,1]},cancelDrawing:function(){this.drawing=0},finishDrawing:function(){this.edit?(this.drawing=0,this.finishEditing(),this.startEditing(),this.pushState()):$("#edit_description_modal").modal("show")},get allArrows(){return this.stories.reduce((t,e,n)=>t.concat(e.Waypoints.reduce((t,e,r)=>{const i=(this.stories[n].Waypoints[r].Arrows||[]).map((t,e)=>["waypoint-arrow",n,r,e]).concat([["user-arrow",n,r,0]]);return t.concat(i)},[])),[])},get allOverlays(){return this.stories.reduce((t,e,n)=>t.concat(e.Waypoints.reduce((t,e,r)=>{const i=(this.stories[n].Waypoints[r].Overlays||[]).map((t,e)=>["waypoint-overlay",n,r,e]).concat([["user-overlay",n,r,0]]);return t.concat(i)},[])),[])},channelSettings:function(t){const e=this.chans;return null==t?{}:t.reduce((function(t,n){const r=Xu(e,n);return r>=0&&(t[n]=e[r]),t}),{})},get bufferYaml(){const t=this.viewport,e=this.waypoint;e.Overlays=[this.overlay],e.Name=_u(this.n),e.Description=_u(this.d);const n=this;return e.ActiveMasks=this.m.filter((function(t){return t>=0})).map((function(t){return n.masks[t].Name})),e.Group=this.cgs[this.g].Name,e.Pan=[t.pan.x,t.pan.y],e.Zoom=t.scale,jsyaml.safeDump([[[e]]],{lineWidth:40,noCompatMode:!0}).replace("- - - ","    - ")}};const Ku=function(t,e){return"minerva"==e.Provider?t.token.then((function(t){return{"Content-Type":"application/json",Authorization:t,Accept:"image/png"}})):"minerva-public"==e.Provider?Promise.resolve().then((function(){return{"Content-Type":"application/json",Authorization:"Anonymous",Accept:"image/png"}})):(e.Provider,Promise.resolve({}))},Gu=function(t,e,n){const r=e.Colors,i=e.Channels,a=function(n,r,i){const a="."+e.Format;return t.Path+"/"+e.Path+"/"+(t.MaxLevel-n)+"_"+r+"_"+i+a};if("minerva"==t.Provider||"minerva-public"==t.Provider){let a=i.reduce((function(e,i,a){const o=n[i];if(null==o)return e;if(o.Images.indexOf(t.Name)>=0){const t=[o.Index,r[a],o.Range[0],o.Range[1]];e.push(t.join(","))}return e}),[]).join("/"),o=t.Path+"/render-tile/";return t.Path.includes("/prerendered-tile/")&&(a=e.Path,o=t.Path),function(e,n,r){const i=t.MaxLevel-e+"/";return o+(n+"/"+r+"/0/0/")+i+a}}if("omero"==t.Provider){const e=i.reduce((function(e,i,a){const o=n[i];if(null==o)return e;if(o.Images.indexOf(t.Name)>=0){const t=o.Index,n=r[a],i=Math.round(65535*o.Range[0]),s=Math.round(65535*o.Range[1]);e.push(t+"|"+i+":"+s+"$"+n)}return e}),[]).join(",");return function(n,r,i){return t.Path+"?c="+e+"&m=c&z=1&t=1&format=jpeg&tile="+(t.MaxLevel-n+","+r+","+i+",")+t.TileSize.join(",")}}return a},Xu=function(t,e){if(!Array.isArray(t))return-1;const n=t.filter((function(t){return t.Name==e}))[0];return t.indexOf(n)},Ju=function(t,e){if(!Array.isArray(t))return-1;const n=t.filter((function(t){return!!t.Name.match(e)}))[0];return t.indexOf(n)};var Zu=0,Qu=function(t){if(++Zu%5!=1)return;const e=this.viewer;var n=t.position,r=e.viewport.pointFromPixel(n);this.hashstate.state.p.push({x:r.x,y:r.y}),this.newView(!1)};const tf=function(t,e,n){["centerSpringX","centerSpringY","zoomSpring"].forEach((function(r){const i=t.viewport[r];i.animationTime=e,i.springStiffness=n,i.springTo(i.target.value)}))},ef=function(t,e,n,r){this.svg_overlay=Ke(e.svgOverlay().node()),this.tileSources=n,this.hashstate=t,this.viewer=e,this.mouseEvent={},this.trackers=[],this.eventHandler=r,this.init()};ef.prototype={get mouseXY(){const t=this.mouseEvent,e=OpenSeadragon.getMousePosition(t);return this.normalize(e)},set mouseXY(t){this.mouseEvent=t},init:function(){const t=this.viewer,e=this.hashstate,n=this;new OpenSeadragon.MouseTracker({element:t.canvas,dragHandler:function(r){"lasso"==e.drawType&&e.drawing&&(t.setMouseNavEnabled(!1),Qu.bind(n)(r))}}),new OpenSeadragon.MouseTracker({element:t.canvas,dragEndHandler:function(n){"lasso"==e.drawType&&e.drawing&&e.finishDrawing(),t.setMouseNavEnabled(!0)}});this.viewer.addHandler("canvas-drag",(function(t){const e=t.userData,n=e.hashstate;if("box"!=n.drawType)return;const r=e.normalize(t.position);1==n.drawing?(n.drawing=2,t.preventDefaultAction=!0,e.drawLowerBounds(r)):2==n.drawing&&(t.preventDefaultAction=!0,e.drawUpperBounds(r))}),this),this.viewer.addHandler("canvas-drag-end",(function(t){const e=t.userData,n=e.hashstate;if("box"!=n.drawType)return;const r=e.normalize(t.position);2==n.drawing&&(t.preventDefaultAction=!0,e.drawUpperBounds(r),n.finishDrawing(),n.pushState(),e.newView(!1))}),this),this.viewer.addHandler("canvas-click",(function(t){const e=t.userData,n=e.hashstate,r=e.normalize(t.position);var i=e.viewer.viewport.viewportToImageCoordinates(r.x,r.y);e.eventHandler.trigger(e.eventHandler.events.osdClickEvent,{x:i.x,y:i.y}),"lasso"!=n.drawType&&("arrow"!=n.drawType?1==n.drawing?(n.drawing=2,t.preventDefaultAction=!0,e.drawLowerBounds(r)):2==n.drawing&&(t.preventDefaultAction=!0,e.drawUpperBounds(r),n.finishDrawing(),e.viewer.setMouseNavEnabled(!0),n.pushState(),e.newView(!1)):1==n.drawing&&(n.a=[r.x,r.y],n.finishDrawing(),e.viewer.setMouseNavEnabled(!0),n.pushState(),e.newView(!1)))}),this),$(this.viewer.element).mousemove(this,(function(t){const e=t.data,n=e.hashstate;"lasso"!=n.drawType&&(e.mouseXY=t,2==n.drawing&&e.drawUpperBounds(e.mouseXY))})),this.viewer.addHandler("animation",(function(t){const e=t.userData,n=e.hashstate,r=e.viewer.viewport.getZoom(),i=e.viewer.viewport.getCenter();n.v=[bu(r),bu(i.x),bu(i.y)]}),this),this.viewer.addHandler("animation-finish",(function(t){const e=t.userData,n=e.hashstate,r=e.viewer.viewport.getZoom(),i=e.viewer.viewport.getCenter();n.v=[bu(r),bu(i.x),bu(i.y)],n.pushState(),e.newView(!1),e.faster()}),this),this.finishAnimation(),this.viewer.setVisible(!0)},finishAnimation:function(){const t=this.viewer.viewport.getBounds();this.viewer.viewport.fitBounds(t,!0)},faster:function(){tf(this.viewer,1.2,6.4)},slower:function(){tf(this.viewer,3.2,6.4)},normalize:function(t){const e=this.viewer.viewport;return e.viewerElementToViewportCoordinates.call(e,t)},drawLowerBounds:function(t){const e=this.hashstate,n=[t.x,t.y];e.o=n.concat([0,0]),this.newView(!1)},computeBounds:function(t,e,n){return t<e+n/2?{start:t,range:e+n-t}:{start:e,range:t-e}},drawUpperBounds:function(t){const e=this.hashstate,n=e.o.slice(0,2),r=e.o.slice(2),i=this.computeBounds(t.x,n[0],r[0]),a=this.computeBounds(t.y,n[1],r[1]),o=[i.start,a.start,i.range,a.range];e.o=o.map(bu),this.newView(!1)},newView:function(t){const e=this.hashstate;this.trackers.forEach(t=>t.destroy()),this.trackers=[],this.addPolygon("selection",e.state.p),e.allOverlays.forEach((function(t){const[n,r,i,a]=t;var o=e.overlay;"waypoint-overlay"==n&&(o=e.stories[r].Waypoints[i].Overlays[a]);var s=t.join("-");this.addOverlay(o,s,r,i)}),this);const n=this;$.each($(".arrow-overlay"),(function(t,e){const r=n.viewer.getOverlayById(e.id),i=new OpenSeadragon.Point(-100,-100);r&&r.update({location:i})})),e.allArrows.forEach((function(t){this.addArrow(t)}),this),t&&(this.activateViewport(),function(t,e,n){const r=n.map(t=>t.Path);Object.keys(t).forEach(n=>{n===e.Path||r.includes(n)?t[n].forEach(t=>t.setOpacity(1)):t[n].forEach(t=>t.setOpacity(0))})}(this.tileSources,e.group,e.active_masks)),this.viewer.forceRedraw()},addPolygon:function(t,e){var n=this.svg_overlay;Ke("#"+t).remove(),n.selectAll(t).data([e]).enter().append("polygon").attr("id",t).attr("points",(function(t){return t.map((function(t){return[t.x,t.y].join(",")})).join(" ")}))},addArrow:function(t){const[e,n,r,i]=t,a=this.hashstate;var o={Point:a.a,Text:""};"waypoint-arrow"==e&&(o=Object.assign({},a.stories[n].Waypoints[r].Arrows[i])),null==o.Angle&&(o.Angle=60);const s=o.Arrowhead?"arrowhead-image":"arrow-image",c="arrow-text-"+t.join("-"),u="arrow-image-"+t.join("-");n==a.s&&r==a.w||(o.Point=[-100,-100]);const f=this.viewer.getOverlayById(u),l=new OpenSeadragon.Point(o.Point[0],o.Point[1]);if(f)f.update({location:l});else{if(u!=s){const t=document.getElementById(s).cloneNode(!0);t.id=u,document.body.appendChild(t)}this.viewer.addOverlay({x:o.Point[0],y:o.Point[1],element:u,placement:OpenSeadragon.Placement.CENTER})}const h=this.viewer.getOverlayById(c),d=new OpenSeadragon.Point(o.Point[0],o.Point[1]);if(h)h.update({location:d});else{if("arrow-text"!=c){const t=document.getElementById("arrow-text").cloneNode(!0);t.id=c,document.body.appendChild(t)}this.viewer.addOverlay({x:o.Point[0],y:o.Point[1],element:c,placement:OpenSeadragon.Placement.CENTER})}const p=$("#"+u),g=$("#"+u+" svg"),m=$("#"+c),v=$("#"+c+" .arrow-label"),b=g[0].getAttribute("width")/2,y=b*Math.sin(o.Angle*Math.PI/180),w=b*Math.cos(o.Angle*Math.PI/180);1==o.HideArrow?p.css("display","none"):(p.css("display","block"),g[0].setAttribute("transform","translate("+w+","+y+")rotate("+o.Angle+")"),v.css("top","100px"));const _=o.Text;if(_){const t=m.width(),e=m.height();var x=2*w+t*Math.sign(Math.round(w))/2,C=2*y+e*Math.sign(Math.round(y))/2;1==o.HideArrow&&(x=0,C=0),v.css("transform","translate("+x+"px, "+C+"px)"),v.addClass("p-3"),v.text(_)}else v.removeClass("p-3"),v.text("")},addOverlay:function(t,e,n,r){const i=this.viewer.getOverlayById(e),a=this.hashstate,o="outline"!=a.waypoint.Mode,s=a.s!=n||a.w!=r;if(o&&s){if(i){const t=new OpenSeadragon.Point(-100,-100);i.update({location:t,width:1,height:1})}return}var c=document.getElementById(e);c||((c=document.createElement("div")).className="white overlay",c.id=e,document.getElementById("all-overlays").appendChild(c));const u=new OpenSeadragon.Point(t.x,t.y),f=a.drawing&&"box"==a.drawType;Tu("#"+e,f),i?i.update({location:u,width:t.width,height:t.height}):this.viewer.addOverlay({x:t.x,y:t.y,width:t.width,height:t.height,element:e});if("outline"==a.waypoint.Mode){const t=new OpenSeadragon.MouseTracker({element:document.getElementById(e),moveHandler:function(t){$(c).css("cursor","pointer")},clickHandler:function(t){const[n,r]=e.split("-").slice(2);t.preventDefaultAction=!1,a.s=n,a.w=r,a.pushState(),window.onpopstate()}.bind(this)});this.trackers.push(t)}},activateViewport:function(){const t=this.hashstate,e=this.viewer.viewport;e.panTo(t.viewport.pan),e.zoomTo(t.viewport.scale)}};const nf=function(t){return t.reduce((function(t,e){return t.concat(e)}))},rf=function(t,e,n,r){const i=n.cgs,a=n.masks;i.forEach(t=>{t.Format=t.Format||"jpg"}),a.forEach(t=>{t.Format=t.Format||"png"});const o=i.concat(a),s=n.grid,c=n.images;document.getElementById("imageName").innerText=1==c.length?c[0].Description:exhibit.Name;const u=s.length,f=s[0].length,l=u*f*o.length;var h=0;const d=nf(s).reduce((function(t,e){return Math.max(t,e.Width)}),0),p=nf(s).reduce((function(t,e){return Math.max(t,e.Height)}),0),g=1.05/u-.05,m=g*d/p;for(var v=0;v<u;v++){const i=v*(g+.05);for(var b=0;b<f;b++){const a=s[v][b],c=(1-.05*(u-1))/u*a.Height/p*a.Width/a.Height,f=b*(m+.05)+(m-c)/2;for(var y=0;y<o.length;y++){const s=o[y],u=n.channelSettings(s.Channels);Ku(n,a).then((function(o){const d="minerva"==a.Provider||"minerva-public"==a.Provider;t.addTiledImage({loadTilesWithAjax:d,crossOriginPolicy:d?"Anonymous":void 0,ajaxHeaders:o,tileSource:{height:a.Height,width:a.Width,maxLevel:a.MaxLevel,tileWidth:a.TileSize.slice(0,1).pop(),tileHeight:a.TileSize.slice(0,2).pop(),getTileUrl:Gu(a,s,u)},x:f,y:i,opacity:0,width:c,success:function(i){const a=i.item;if(e.hasOwnProperty(s.Path)||(e[s.Path]=[]),e[s.Path].push(a),n.design.is3d){const e=t.world.getIndexOfItem(a);a.addHandler("fully-loaded-change",(function(n){const r=t.world.getItemAt(e+1),i=t.world.getItemAt(e-1);r&&r.setPreload(n.fullyLoaded),i&&i.setPreload(n.fullyLoaded)}))}(h+=1)==l&&r()}})}))}const d=$("<p>"),g=a.Description;d.addClass("overlay-title").text(g),t.addOverlay({element:d[0],x:f+c/2,y:i,placement:"BOTTOM",checkResize:!1}),t.addOverlay({x:f,y:i,width:c,height:a.Height/a.Width*c,className:"slide-border"})}}};var af={build_page:function(t,e){const n=OpenSeadragon({id:"openseadragon1",prefixUrl:"https://cdnjs.cloudflare.com/ajax/libs/openseadragon/2.3.1/images/",navigatorPosition:"BOTTOM_RIGHT",zoomOutButton:"zoom-out",zoomInButton:"zoom-in",immediateRender:!0,maxZoomPixelRatio:10,visibilityRatio:.9,degrees:t.Rotation||0});function r(){n.currentOverlays.forEach(t=>{"arrow"==t.element.id.slice(0,5)&&(t.element.style.transform="")})}n.addHandler("update-viewport",(function(){setTimeout(r,1)})),n.addHandler("animation",r),n.world.addHandler("add-item",(function(t){const e=t.item;e.addHandler("fully-loaded-change",(function(t){t.fullyLoaded&&(e.immediateRender=!1)})),e.addHandler("opacity-change",(function(t){0==t.opacity&&(e.immediateRender=!0)}))})),n.scalebar({location:3,minWidth:"100px",type:"Microscopy",stayInsideImage:!1,pixelsPerMeter:1e6*t.PixelsPerMicron||0,backgroundColor:"rgba(0, 0, 0, 0.8)",fontColor:"rgb(255, 255, 255)",color:"rgb(255, 255, 255)"});const a=new i(Ke("body").node()),o=new Wu(t,e),s={},c=new ef(o,n,s,a),u=new Du(o,c,a),f=u.init.bind(u);rf(n,s,o,f)},get_links_alias:function(t){t=t.map((function(t){return t["\ufeffString"]&&(t.String=t["\ufeffString"]),t}));const e=new Map;t.filter(t=>t.Alias).forEach((function(t){t.Alias.split(",").forEach((function(n){e.set(r(n),r(t.String))}))}));const n=new Map;return t.filter(t=>t.Link).forEach((function(t){if(t.Alias){const e=t.Alias.split(",").map(r),i=e.reduce((n,i)=>{const a=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=RegExp("^"+a+"$","gi");if(r(t.String).match(o))return n.concat([i]);for(var s in e){var c=e[s];if(c.match(o)&&c!=i&&!n.includes(c))return n.concat([i])}return n},[]);e.filter(t=>!i.includes(t)).forEach((function(e){n.set(e,r(t.Link))}))}n.set(r(t.String),r(t.Link))})),[n,e]}};e.default={build_page:af.build_page,get_links_alias:af.get_links_alias}}]);
    </script>
    <script>
        const speech_bucket = "";
        const exhibit = {"Groups":[{"Channels":["CD20","CD31","SMA","E-Cadherin","Pan-CK (DIG)"],"Colors":["00ff7f","007fff","ff7f7f","ff007f","00ff7f"],"Name":"Tissue Architecture","Path":"Tissue-Architecture_1__CD20--4__CD31--3__SMA--14__E-Cadherin--19__Pan-CK (DIG)"},{"Channels":["SYTOX BLUE","PD-L1","PD-1","CD20","CD3d","CD68"],"Colors":["ffff00","ff007f","7f7fff","00ff7f","ff0000","0000ff"],"Name":"Immune Checkpoint Biomarkers","Path":"Immune-Checkpoint-Biomarkers_2__SYTOX BLUE--11__PD-L1--15__PD-1--1__CD20--17__CD3d--5__CD68"},{"Channels":["SYTOX BLUE","CD4","CD8a","FOXP3","CD45RO (Biotin)"],"Colors":["ffff00","ff00ff","7fff7f","7fff00","0000ff"],"Name":"T Cell Subsets","Path":"T-Cell-Subsets_2__SYTOX BLUE--7__CD4--9__CD8a--8__FOXP3--18__CD45RO (Biotin)"},{"Channels":["CD20","Ki67","PCNA","CD45"],"Colors":["00ff7f","ff00ff","7f7f7f","7fff00"],"Name":"Cellular Proliferation","Path":"Cellular-Proliferation_1__CD20--16__Ki67--0__PCNA--6__CD45"},{"Channels":["CD163","CD11b","CD11c","CD68"],"Colors":["7fff7f","007fff","7f00ff","0000ff"],"Name":"Myeloid and Stromal Cells","Path":"Myeloid-and-Stromal-Cells_13__CD163--10__CD11b--12__CD11c--5__CD68"}],"Header":"This is a 21-marker whole-slide scan of a single tonsil section stained with TissuePlexTM Reagents and imaged using the Orion Instrument. All markers were stained in a single staining procedure and imaged in a single scan. Use the arrow keys above for a tour of this tonsil section.","Images":[{"Description":"Orion(TM) - Deep Multiplexing of a Single Tonsil Section","Height":39122,"MaxLevel":0,"Name":"i0","Path":"/images/Orion_Tonsil_R14_C11","Width":37850}],"Layout":{"Grid":[["i0"]]},"Rotation":0,"Stories":[{"Description":"","Name":"","Waypoints":[{"Arrows":[],"Description":"Cancer tissue micro-environments contain numerous cell types, including epithelial, immune, vascular endothelial and smooth muscle cells in a spatial context for immune response. In tonsil, B cell follicles with germinal centers and T cell interfollicular zones define the lymphoid compartments. Blood vessels are revealed by CD31 and smooth muscle actin (SMA). Note that venules are SMA negative. Cytokeratin and E-cadherin co-stain mucosal and crypt lining.\n\nDisplayed markers: CD20 (B cells, gray); CD31 (vascular endothelium and crypt sub-mucosa, green); SMA (arterioles, red); E-cadherin (mucosal and crypt epithelium, magenta); and pan-cytokeratin (mucosal and crypt epithelium, cyan).","Group":"Myeloid and Stromal Cells","Name":"Characterize Tissue Architecture","Overlays":[],"Pan":[0.3269735662154845,0.6474798029660785],"Zoom":1.067173637515843},{"Arrows":[],"Description":"PD-L1 and PD-1 are immune checkpoint markers involved in tumor evasion of the immune system, and their expression on tumor cells and within the tumor microenvironment impacts response to checkpoint inhibitor therapy. In tonsil, PD-L1 is expressed by crypt-lining cells, and PD-1 is found scattered in the follicles. CD68 positive macrophages are present adjacent to the crypt lining.\n\nDisplayed markers: SYTOX blue (nucleus, gray); PD-1 (germinal centers, yellow); PD-L1 (crypt sub-mucosa, green); CD20 (B cells, blue); CD3e (T cells, magenta), and CD68 (macrophages, red).","Group":"Myeloid and Stromal Cells","Name":"Immune Checkpoint Markers","Overlays":[],"Pan":[0.3269735662154845,0.6474798029660785],"Zoom":1.067173637515843},{"Arrows":[],"Description":"Helper, cytotoxic, memory, regulatory and activated/exhausted T cells can be simultaneously revealed by deep multiplexing. CD4 helper and CD8 cytotoxic T cells are present in the interfollicular zone.\n\nDisplayed markers: SYTOX blue (nucleus, gray); CD4 (helper T cells, green); CD8a (cytotoxic T cells, red); FoxP3 (T reg cells, magenta); CD45RO (memory T cells, blue); and LAG-3 (activated/exhausted T cells, white).","Group":"Myeloid and Stromal Cells","Name":"Investigate T Cell Subsets","Overlays":[],"Pan":[0.3269735662154845,0.6474798029660785],"Zoom":1.067173637515843},{"Arrows":[],"Description":"Tonsil follicles contain germinal centers where expansion of B cells occurs in response to foreign antigens. Germinal centers are easily visualized by Ki67 and PCNA which are nuclear markers of cellular proliferation.\n\nDisplayed markers: CD20 (B cells, blue); Ki67 (cell proliferation, green); PCNA (cell proliferation, red); and CD45 (leukocytes, gray).","Group":"Myeloid and Stromal Cells","Name":"Cellular Proliferation in Follicles","Overlays":[],"Pan":[0.3269735662154845,0.6474798029660785],"Zoom":1.067173637515843},{"Arrows":[],"Description":"The follicular dendritic network within the germinal center is shown here in cyan. Intrafollicular macrophages are co-stained with both yellow and red. Macrophages associated with the reticular network are present in the T cell zone.\n\nDisplayed markers: CD163 (macrophages, green); CD11b (dendritic cells/macrophages, cyan); CD11c (dendritic cells/macrophages, yellow); and CD68 (macrophages, red).","Group":"Myeloid and Stromal Cells","Name":"Myeloid and Stromal Cells","Overlays":[],"Pan":[0.3269735662154845,0.6474798029660785],"Zoom":1.067173637515843}]}]};
        const marker_data = [{"﻿String":"ARL13B","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ARL13B&keywords=ARL13B"},{"﻿String":"ASMA","Alias":"A-SMA, a-SMA, alpha-SMA, α-SMA","Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ACTA2&keywords=alpha,smooth,muscle,actin"},{"﻿String":"BANF1","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=BANF1&keywords=BANF1"},{"﻿String":"CD11B","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ITGAM&keywords=CD11B"},{"﻿String":"CD14","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD14&keywords=CD14"},{"﻿String":"CD163","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD163&keywords=CD163"},{"﻿String":"CD19","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD19&keywords=CD19"},{"﻿String":"CD20","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=MS4A1&keywords=CD20"},{"﻿String":"CD21","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CR2&keywords=CD21"},{"﻿String":"CD3D","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD3D&keywords=CD3D"},{"﻿String":"CD4","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD4&keywords=CD4"},{"﻿String":"CD45","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=PTPRC&keywords=CD45"},{"﻿String":"CD45RB","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=PTPRC&keywords=CD45RB"},{"﻿String":"CD68","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD68&keywords=CD68"},{"﻿String":"CD8A","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD8A&keywords=CD8A"},{"﻿String":"FOXP3","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=FOXP3&keywords=FOXP3"},{"﻿String":"GFAP","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=GFAP&keywords=GFAP"},{"﻿String":"GTUBULIN","Alias":"gamma-tubulin","Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=TUBG1&keywords=gamma,tubulin"},{"﻿String":"IBA1","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=AIF1&keywords=IBA1"},{"﻿String":"KERATIN","Alias":"pan-cytokeratin, pan-keratin","Link":"https://www.genecards.org/Search/Keyword?queryString=KERATIN"},{"﻿String":"KI67","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=MKI67&keywords=KI67"},{"﻿String":"LAG3","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=LAG3&keywords=LAG3"},{"﻿String":"LAMINAC","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=LMNA&keywords=LAMIN,AC"},{"﻿String":"LAMINB","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=LMNB1&keywords=LAMINB"},{"﻿String":"PD-1","Alias":"PD1","Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=PDCD1&keywords=PD-1"},{"﻿String":"PD-L1","Alias":"PDL1","Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD274&keywords=PD-L1"},{"﻿String":"CD19","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD19&keywords=CD19"},{"﻿String":"CD14","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD14&keywords=CD11c"},{"﻿String":"CD56","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=NCAM1&keywords=CD56"},{"﻿String":"CD34","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD34&keywords=CD34"},{"﻿String":"CD44","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD44&keywords=CD34"},{"﻿String":"CD14","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD14&keywords=CD14"},{"﻿String":"CD33","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD33&keywords=CD33"},{"﻿String":"CD41","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ITGA2B&keywords=CD41"},{"﻿String":"CD61","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ITGB3&keywords=CD61"},{"﻿String":"CD62","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=SELP&keywords=CD62"},{"﻿String":"CD146","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=MCAM&keywords=CD146"},{"﻿String":"CD1d","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD1D&keywords=CD1d"},{"﻿String":"CD2","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD2&keywords=CD2"},{"﻿String":"CD5","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD5&keywords=cd5"},{"﻿String":"CD7","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD7&keywords=CD7"},{"﻿String":"CD9","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD9&keywords=CD9"},{"﻿String":"CD10","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=MME&keywords=CD10"},{"﻿String":"CD11A","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ITGAL&keywords=CD11A"},{"﻿String":"CD70","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD70&keywords=CD70"},{"﻿String":"CD74","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=CD74&keywords=CD74"},{"﻿String":"CD103","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=ITGAE&keywords=CD103"},{"﻿String":"CD133","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=PROM1&keywords=CD133"},{"﻿String":"CD168","Alias":null,"Link":"https://www.genecards.org/cgi-bin/carddisp.pl?gene=HMMR&keywords=CD168"}];
        const cell_type_data = [{"﻿String":"Natural Killer Cells","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/c%C3%A9lulas/natural-killer-cells"},{"﻿String":"B Cells","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/cells/b-cells"},{"﻿String":"Basophil","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/c%C3%A9lulas/basophils"},{"﻿String":"Helper T cell","Alias":"CD4+ T Cell","Link":"https://www.immunology.org/public-information/bitesized-immunology/células/cd4-t-cells"},{"﻿String":"Cytotoxic T Cell","Alias":"CD8+ T Cell","Link":"https://www.immunology.org/public-information/bitesized-immunology/c%C3%A9lulas/cd8-t-cells"},{"﻿String":"Dendritic Cell","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/cells/dendritic-cells"},{"﻿String":"Eosinophils","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/c%C3%A9lulas/eosinophils"},{"﻿String":"Macrophage","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/c%C3%A9lulas/macrophages"},{"﻿String":"Mast Cell","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/c%C3%A9lulas/mast-cells"},{"﻿String":"Neutrophil","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/cells/neutrophils"},{"﻿String":"Regulatory T Cell","Alias":"Treg","Link":"https://www.immunology.org/public-information/bitesized-immunology/células/regulatory-t-cells-tregs"},{"﻿String":"T follicular helper cell","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/cells/t-follicular-helper-cells"},{"﻿String":"bone marrow","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/%C3%B3rganos-y-tejidos/bone-marrow"},{"﻿String":"lymph node","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/organs-and-tissues/lymph-node"},{"﻿String":"complement system","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/sistemas-y-procesos/complement-system"},{"﻿String":"phagocytosis","Alias":null,"Link":"https://www.immunology.org/public-information/bitesized-immunology/systems-and-processes/phagocytosis"}];
        const get_links_alias = MinervaStory.default.get_links_alias;

        [marker_links_map, marker_alias_map] = get_links_alias(marker_data);
        [cell_type_links_map, cell_type_alias_map] = get_links_alias(cell_type_data);

        window.viewer = MinervaStory.default.build_page(exhibit, {
          embedded: true
        });
    </script>
    <script>
        const makeTwinViewer = function(e) {
            var youngerWindow = window.open(window.location.href);
            var viewer1 = window.viewer;
            var viewer2;
            youngerWindow.addEventListener('DOMContentLoaded', (e) => {
                viewer2 = youngerWindow.viewer;
                console.log(youngerWindow.viewer);
                var viewer1Leading = false;
                var viewer2Leading = false;

                var viewer1Handler = function() {
                if (viewer2Leading) {
                    return;
                }

                viewer1Leading = true;
                viewer2.viewport.zoomTo(viewer1.viewport.getZoom());
                viewer2.viewport.panTo(viewer1.viewport.getCenter());
                viewer1Leading = false;
                };

                var viewer2Handler = function() {
                if (viewer1Leading) {
                    return;
                }

                viewer2Leading = true;
                viewer1.viewport.zoomTo(viewer2.viewport.getZoom());
                viewer1.viewport.panTo(viewer2.viewport.getCenter());
                viewer2Leading = false;
                };

                viewer1.addHandler('zoom', viewer1Handler);
                viewer2.addHandler('zoom', viewer2Handler);
                viewer1.addHandler('pan', viewer1Handler);
                viewer2.addHandler('pan', viewer2Handler);
            });
        };
        const duplicateViewButton = document.querySelector('#duplicate-view');
        duplicateViewButton.onclick = makeTwinViewer;
    </script>

<script>
        $('#story-board').on('hidden.bs.collapse', function() { 
            $('#js-story-collapse-indicator')[0].innerHTML = '<span class="px-2">SHOW MORE</span> <i class="fas fa-chevron-down"></i>'
        });
        $('#story-board').on('shown.bs.collapse', function() { 
            $('#js-story-collapse-indicator')[0].innerHTML = '<span class="px-2">SHOW LESS</span> <i class="fas fa-chevron-up"></i>'
        });
        
        
            // $('#scroll-bottom')
            //     .click(function(event) {
            //         event.preventDefault();
            //         $('aside').animate({
            //             scrollTop: $(window).height() * 0.65
            //         }, 500, "swing", function() {
            //             $('#scroll-bottom').addClass('d-none')
            //             Callback after animation
            //             Must change focus!
            //             var $target = $(target);
            //             $target.focus();
            //             if ($target.is(":focus")) { // Checking if the target was focused
            //                 return false;
            //             } else {
            //                 $target.attr('tabindex','-1'); // Adding tabindex for elements not focusable
            //                 $target.focus(); // Set focus again
            //             };
            //         });
            //     });

        // $(document).ready(function() {
        //     $('#osd-side-nav').scrollTop(0);
        //     topAnchor = $('#story-title').position().top;

        //     var storyTitleAdded = false;
        //     $('#osd-side-nav').scroll(function() {
        //         if ($('#story-title').position().top == topAnchor && $('#story-title-sticky')[0]) {
        //             $('#story-title-sticky')[0].parentNode.removeChild($('#story-title-sticky')[0]);
        //             storyTitleAdded = false;
        //         }
        //         if ($('#story-title').position().top < topAnchor && !storyTitleAdded) {
        //             var clNode = $('#story-title')[0].cloneNode(true);
        //             clNode.setAttribute('id', 'story-title-sticky');
        //             $('#story-title')[0].parentNode.insertBefore(clNode, $('#story-title')[0].nextSibling);
        //             $('#story-title-sticky')
        //                 .css('top', topAnchor)
        //                 .css('width', $('#story-title').width())
        //                 .addClass('border-bottom border-secondary')
        //             storyTitleAdded = true;
        //         }
        //     });
        // })

        $('.js-toggle-osd-side-nav').click(function() {
            $('#osd-side-nav').position().top == 0 
                ? $('#osd-side-nav').css('top', '75vh')
                : $('#osd-side-nav').css('top', 0);
            $('#osd-side-nav').scrollTop(0);
        })
    </script>
</body>

</html>
